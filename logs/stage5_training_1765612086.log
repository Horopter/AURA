2025-12-13 02:48:06 [INFO] [__main__:310] ================================================================================
2025-12-13 02:48:06 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 02:48:06 [INFO] [__main__:312] ================================================================================
2025-12-13 02:48:06 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 02:48:06 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:48:06 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:48:06 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:48:06 [INFO] [__main__:317] Model types: ['xgboost_i3d']
2025-12-13 02:48:06 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 02:48:06 [INFO] [__main__:319] Number of frames: 1000
2025-12-13 02:48:06 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:48:06 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 02:48:06 [INFO] [__main__:324] Delete existing: True
2025-12-13 02:48:06 [INFO] [__main__:325] Resume mode: True
2025-12-13 02:48:06 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765612086.log
2025-12-13 02:48:06 [INFO] [__main__:333] ================================================================================
2025-12-13 02:48:06 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 02:48:06 [INFO] [__main__:335] ================================================================================
2025-12-13 02:48:06 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:48:06 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 02:48:06 [INFO] [__main__:358] ================================================================================
2025-12-13 02:48:06 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 02:48:06 [INFO] [__main__:360] ================================================================================
2025-12-13 02:48:07 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.484375, 'cpu_memory_gb': 0.7182464599609375, 'cpu_vms_mb': 10217.5859375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 02:48:07 [INFO] [__main__:364] ================================================================================
2025-12-13 02:48:07 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 02:48:07 [INFO] [__main__:366] ================================================================================
2025-12-13 02:48:07 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 02:48:07 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 02:48:07 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 02:48:07 [INFO] [__main__:370] ================================================================================
2025-12-13 02:48:07 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 02:48:07 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:497] ================================================================================
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:498] Stage 5: Model Training Pipeline Started
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:499] ================================================================================
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:500] Model types: ['xgboost_i3d']
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:501] K-fold splits: 5
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:502] Frames per video: 1000
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:503] Output directory: data/stage5
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:504] Initializing pipeline...
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:266] ================================================================================
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:267] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:268] ================================================================================
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:271] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:280] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:281]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:48:07 [INFO] [lib.training.pipeline:284] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:292] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:293]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:296] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:304] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:305]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:308] 
================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:309] MODEL REQUIREMENTS CHECK
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:310] ================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:334] ✓ xgboost_i3d: CAN RUN
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:337] 
================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:338] VALIDATION SUMMARY
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:339] ================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:340] Stage 3 (scaled videos): ✓ Available
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:341]   Count: 3278 videos
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:342] Stage 2 (features): ✓ Available
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:343]   Count: 3278 feature rows
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:344] Stage 4 (scaled features): ✓ Available
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:345]   Count: 3277 feature rows
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:346] 
Runnable models: 1/1
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:347]   ['xgboost_i3d']
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:354] ================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:590] 
Stage 5: Loading metadata...
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:616] Loaded metadata: 3278 rows
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:626] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 02:48:08 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=828530.71GB, used=1671309.29GB (66.9%)
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:648] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:658] Stage 5: Found 3278 scaled videos
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:721] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:817] Stage 5: Deleting existing model results (clean mode)...
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:826] Deleted existing results for xgboost_i3d
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:829] Stage 5: Deleted 1 existing model directories
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:834] 
================================================================================
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:835] Stage 5: Training model: xgboost_i3d
2025-12-13 02:48:08 [INFO] [lib.training.pipeline:836] ================================================================================
2025-12-13 02:48:08 [ERROR] [__main__:439] ================================================================================
2025-12-13 02:48:08 [ERROR] [__main__:440] STAGE 5 FAILED
2025-12-13 02:48:08 [ERROR] [__main__:441] ================================================================================
2025-12-13 02:48:08 [ERROR] [__main__:442] Error: cannot import name 'generate_parameter_combinations' from 'lib.training.grid_search' (/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/grid_search.py)
2025-12-13 02:48:08 [ERROR] [__main__:443] Exception type: ImportError
2025-12-13 02:48:08 [ERROR] [__main__:444] Full traceback:
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage5_training.py", line 382, in main
    results = stage5_train_models(
              ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 863, in stage5_train_models
    from .grid_search import get_hyperparameter_grid, generate_parameter_combinations, select_best_hyperparameters
ImportError: cannot import name 'generate_parameter_combinations' from 'lib.training.grid_search' (/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/grid_search.py)
2025-12-13 02:48:08 [ERROR] [__main__:445] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:48:08 [ERROR] [__main__:446] Partial results may be available
2025-12-13 02:48:08 [ERROR] [__main__:447] ================================================================================
