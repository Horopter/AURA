2025-12-12 16:03:25 [INFO] [__main__:310] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 16:03:25 [INFO] [__main__:312] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 16:03:25 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 16:03:25 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 16:03:25 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 16:03:25 [INFO] [__main__:317] Model types: ['x3d']
2025-12-12 16:03:25 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 16:03:25 [INFO] [__main__:319] Number of frames: 500
2025-12-12 16:03:25 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 16:03:25 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 16:03:25 [INFO] [__main__:324] Delete existing: True
2025-12-12 16:03:25 [INFO] [__main__:325] Resume mode: True
2025-12-12 16:03:25 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765573405.log
2025-12-12 16:03:25 [INFO] [__main__:333] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 16:03:25 [INFO] [__main__:335] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 16:03:25 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 16:03:25 [INFO] [__main__:358] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 16:03:25 [INFO] [__main__:360] ================================================================================
2025-12-12 16:03:25 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.64453125, 'cpu_memory_gb': 0.7184028625488281, 'cpu_vms_mb': 10217.58984375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 16:03:25 [INFO] [__main__:364] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 16:03:25 [INFO] [__main__:366] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 16:03:25 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 16:03:25 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 16:03:25 [INFO] [__main__:370] ================================================================================
2025-12-12 16:03:25 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 16:03:25 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:490] ================================================================================
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:491] Stage 5: Model Training Pipeline Started
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:492] ================================================================================
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:493] Model types: ['x3d']
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:494] K-fold splits: 5
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:495] Frames per video: 500
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:496] Output directory: data/stage5
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:497] Initializing pipeline...
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 16:03:25 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:333] ✓ x3d: CAN RUN
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:346]   ['x3d']
2025-12-12 16:03:27 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:583] 
Stage 5: Loading metadata...
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:609] Loaded metadata: 3278 rows
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:619] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 16:03:28 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=826061.51GB, used=1673778.49GB (67.0%)
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:651] Stage 5: Found 3278 scaled videos
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:675] Enabling adaptive chunked frame loading for x3d: initial_chunk_size=200, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:730] Stage 5: Deleting existing model results (clean mode)...
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:739] Deleted existing results for x3d
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:742] Stage 5: Deleted 1 existing model directories
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:747] 
================================================================================
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:748] Stage 5: Training model: x3d
2025-12-12 16:03:28 [INFO] [lib.training.pipeline:749] ================================================================================
2025-12-12 16:03:29 [INFO] [lib.training.pipeline:773] Grid search: 32 hyperparameter combinations to try
2025-12-12 16:03:29 [INFO] [lib.training.pipeline:781] ================================================================================
2025-12-12 16:03:29 [INFO] [lib.training.pipeline:782] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 16:03:29 [INFO] [lib.training.pipeline:783] ================================================================================
2025-12-12 16:03:30 [INFO] [lib.training.pipeline:792] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:805] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 1/32
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:03:31 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:03:31 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6bbd9d6ba4064632ab37a1d7a9404b8a (experiment: x3d)
2025-12-12 16:03:40 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:03:43 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:43 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:43 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:03:43 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:03:43 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:44 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:44 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:03:45 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:45 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:45 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:03:45 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:03:45 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:03:45 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:46 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:46 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:03:47 [INFO] [lib.models.video:417] Chunk size increased from 200 to 210 (after 3 successes, increment: 10)
2025-12-12 16:03:48 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:48 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:48 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:03:48 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:03:48 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:03:48 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:48 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:48 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:03:50 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:50 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:50 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:03:50 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:03:50 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:51 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:51 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:03:52 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:52 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 2/32
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:03:52 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:03:52 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:53 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:53 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:03:54 [INFO] [lib.models.video:417] Chunk size increased from 210 to 220 (after 3 successes, increment: 10)
2025-12-12 16:03:55 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:55 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:55 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:03:55 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:03:55 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:03:55 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:55 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:55 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:03:56 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:56 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:57 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:03:57 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:03:57 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:03:57 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:57 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:57 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:03:59 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:59 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:03:59 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:03:59 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:03:59 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:03:59 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:03:59 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:03:59 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:01 [INFO] [lib.models.video:417] Chunk size increased from 220 to 230 (after 3 successes, increment: 10)
2025-12-12 16:04:01 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:01 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:02 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:02 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:02 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:02 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:02 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:02 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:04 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:04 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 3/32
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:04 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:04 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:04 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:04:06 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:06 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:06 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:04:06 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:04:06 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:06 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:07 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:07 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:04:08 [INFO] [lib.models.video:417] Chunk size increased from 200 to 210 (after 3 successes, increment: 10)
2025-12-12 16:04:08 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:08 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:08 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:04:08 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:04:08 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:08 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:08 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:08 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:04:10 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:10 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:10 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:04:10 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:04:10 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:10 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:11 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:11 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:12 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:12 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:13 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:13 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:13 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:13 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:13 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:13 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:15 [INFO] [lib.models.video:417] Chunk size increased from 230 to 240 (after 3 successes, increment: 10)
2025-12-12 16:04:15 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:15 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 4/32
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:15 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:15 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:15 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:04:17 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:17 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:17 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:04:17 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:04:17 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:17 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:18 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:18 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:04:19 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:19 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:19 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:04:19 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:04:19 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:19 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:20 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:20 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:04:21 [INFO] [lib.models.video:417] Chunk size increased from 240 to 250 (after 3 successes, increment: 10)
2025-12-12 16:04:21 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:21 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:21 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:04:21 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:04:21 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:21 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:22 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:22 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:24 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:24 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:24 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:24 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:24 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:24 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:24 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:24 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:26 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:26 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 5/32
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:26 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:26 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:27 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:27 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:04:28 [INFO] [lib.models.video:417] Chunk size increased from 250 to 260 (after 3 successes, increment: 10)
2025-12-12 16:04:28 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:28 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:29 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:04:29 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:04:29 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:29 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:29 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:29 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:04:30 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:30 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:30 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:04:30 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:04:30 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:30 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:31 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:31 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:04:32 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:32 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:33 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:04:33 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:04:33 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:33 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:33 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:33 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:34 [INFO] [lib.models.video:417] Chunk size increased from 260 to 270 (after 3 successes, increment: 10)
2025-12-12 16:04:35 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:35 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:35 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:35 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:35 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:35 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:35 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:35 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:37 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:37 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 6/32
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:37 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:37 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:38 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:38 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:04:39 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:39 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:40 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:04:40 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:04:40 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:40 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:40 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:40 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:04:41 [INFO] [lib.models.video:417] Chunk size increased from 210 to 220 (after 3 successes, increment: 10)
2025-12-12 16:04:41 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:41 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:41 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:04:41 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:04:41 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:41 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:42 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:42 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:04:43 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:43 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:44 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:04:44 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:04:44 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:44 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:44 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:44 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:46 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:46 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:46 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:46 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:46 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:46 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:47 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:47 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:48 [INFO] [lib.models.video:417] Chunk size increased from 270 to 280 (after 3 successes, increment: 10)
2025-12-12 16:04:48 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:48 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 7/32
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:48 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:48 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:49 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:49 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:04:51 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:51 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:51 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:04:51 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:04:51 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:51 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:51 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:51 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:04:52 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:52 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:52 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:04:52 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:04:52 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:52 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:53 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:53 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:04:54 [INFO] [lib.models.video:417] Chunk size increased from 280 to 290 (after 3 successes, increment: 10)
2025-12-12 16:04:55 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:55 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:55 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:04:55 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:04:55 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:55 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:55 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:55 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:04:57 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:57 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:57 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:04:57 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:04:57 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:04:57 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:04:58 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:04:58 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:04:59 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:59 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 8/32
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:04:59 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:04:59 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:00 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:00 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:01 [INFO] [lib.models.video:417] Chunk size increased from 290 to 300 (after 3 successes, increment: 10)
2025-12-12 16:05:02 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:02 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:02 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:02 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:02 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:02 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:02 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:02 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:03 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:03 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:03 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:03 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:03 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:03 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:04 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:04 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:05:06 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:06 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:06 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:05:06 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:05:06 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:06 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:06 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:06 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:05:08 [INFO] [lib.models.video:417] Chunk size increased from 300 to 310 (after 3 successes, increment: 10)
2025-12-12 16:05:08 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:08 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:08 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:05:08 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:05:08 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:08 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:09 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:09 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:05:10 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:10 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 9/32
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:11 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:11 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:11 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:13 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:13 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:13 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:13 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:13 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:13 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:13 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:13 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:14 [INFO] [lib.models.video:417] Chunk size increased from 220 to 230 (after 3 successes, increment: 10)
2025-12-12 16:05:14 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:14 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:15 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:15 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:15 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:15 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:15 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:15 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:05:17 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:17 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:17 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:05:17 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:05:17 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:17 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:17 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:17 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:05:19 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:19 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:19 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:05:19 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:05:19 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:19 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:20 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:20 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:05:21 [INFO] [lib.models.video:417] Chunk size increased from 310 to 320 (after 3 successes, increment: 10)
2025-12-12 16:05:21 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:21 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 10/32
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:22 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:22 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:22 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:24 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:24 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:24 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:24 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:24 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:24 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:24 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:24 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:25 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:25 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:26 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:26 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:26 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:26 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:26 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:26 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:05:28 [INFO] [lib.models.video:417] Chunk size increased from 320 to 330 (after 3 successes, increment: 10)
2025-12-12 16:05:28 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:28 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:28 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:05:28 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:05:28 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:28 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:28 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:28 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:05:30 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:30 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:30 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:05:30 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:05:30 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:30 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:31 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:31 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:05:33 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:33 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 11/32
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:33 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:33 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:33 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:35 [INFO] [lib.models.video:417] Chunk size increased from 330 to 340 (after 3 successes, increment: 10)
2025-12-12 16:05:35 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:35 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:35 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:35 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:35 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:35 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:36 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:36 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:37 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:37 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:37 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:37 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:37 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:37 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:37 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:37 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:05:39 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:39 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:39 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:05:39 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:05:39 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:39 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:40 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:40 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:05:41 [INFO] [lib.models.video:417] Chunk size increased from 340 to 350 (after 3 successes, increment: 10)
2025-12-12 16:05:41 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:41 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:41 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:05:41 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:05:41 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:41 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:42 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:42 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:05:44 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:44 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 12/32
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:44 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:44 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:44 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:46 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:46 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:46 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:46 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:46 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:46 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:47 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:47 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:47 [INFO] [lib.models.video:417] Chunk size increased from 230 to 240 (after 3 successes, increment: 10)
2025-12-12 16:05:48 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:48 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:48 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:48 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:48 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:48 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:48 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:48 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:05:50 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:50 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:50 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:05:50 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:05:50 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:50 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:51 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:51 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:05:52 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:52 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:53 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:05:53 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:05:53 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:05:53 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:53 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:53 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:05:55 [INFO] [lib.models.video:417] Chunk size increased from 350 to 360 (after 3 successes, increment: 10)
2025-12-12 16:05:55 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:55 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 13/32
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:55 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:55 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:55 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:05:57 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:57 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:57 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:05:57 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:05:57 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:57 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:58 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:58 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:05:59 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:59 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:05:59 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:05:59 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:05:59 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:05:59 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:05:59 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:05:59 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:01 [INFO] [lib.models.video:417] Chunk size increased from 360 to 370 (after 3 successes, increment: 10)
2025-12-12 16:06:01 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:01 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:01 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:01 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:01 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:01 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:02 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:02 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:03 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:03 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:03 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:03 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:03 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:03 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:04 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:04 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:06:06 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:06 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 14/32
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:06 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:06 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:06 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:06:08 [INFO] [lib.models.video:417] Chunk size increased from 370 to 380 (after 3 successes, increment: 10)
2025-12-12 16:06:08 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:08 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:08 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:06:08 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:06:08 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:08 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:09 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:09 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:06:10 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:10 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:10 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:06:10 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:06:10 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:10 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:10 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:10 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:12 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:12 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:12 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:12 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:12 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:12 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:13 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:13 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:14 [INFO] [lib.models.video:417] Chunk size increased from 380 to 390 (after 3 successes, increment: 10)
2025-12-12 16:06:14 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:14 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:15 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:15 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:15 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:15 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:15 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:15 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:06:17 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:17 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 15/32
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:17 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:17 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:17 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:06:19 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:19 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:19 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:06:19 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:06:19 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:19 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:20 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:20 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:06:20 [INFO] [lib.models.video:417] Chunk size increased from 240 to 250 (after 3 successes, increment: 10)
2025-12-12 16:06:21 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:21 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:21 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:06:21 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:06:21 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:21 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:21 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:21 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:23 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:23 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:23 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:23 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:23 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:23 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:24 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:24 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:25 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:25 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:25 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:25 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:25 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:25 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:26 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:26 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:06:27 [INFO] [lib.models.video:417] Chunk size increased from 390 to 400 (after 3 successes, increment: 10)
2025-12-12 16:06:28 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:28 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 16/32
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:28 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:28 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:28 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:06:30 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:30 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:30 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:06:30 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:06:30 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:30 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:30 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:30 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:06:31 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:31 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:32 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:06:32 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:06:32 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:32 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:32 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:32 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:34 [INFO] [lib.models.video:417] Chunk size increased from 400 to 410 (after 3 successes, increment: 10)
2025-12-12 16:06:34 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:34 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:34 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:34 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:34 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:34 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:34 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:34 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:36 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:36 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:36 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:36 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:36 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:36 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:37 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:37 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:06:39 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:39 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 17/32
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:39 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:39 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:39 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:06:41 [INFO] [lib.models.video:417] Chunk size increased from 410 to 420 (after 3 successes, increment: 10)
2025-12-12 16:06:41 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:41 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:41 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:06:41 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:06:41 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:41 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:42 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:42 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:06:43 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:43 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:43 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:06:43 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:06:43 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:43 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:43 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:43 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:45 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:45 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:45 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:45 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:45 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:45 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:45 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:45 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:47 [INFO] [lib.models.video:417] Chunk size increased from 420 to 430 (after 3 successes, increment: 10)
2025-12-12 16:06:47 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:47 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:47 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:47 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:47 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:06:47 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:48 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:48 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:06:49 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:49 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 18/32
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:50 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:50 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:50 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:06:52 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:52 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:52 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:06:52 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:06:52 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:52 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:52 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:52 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:06:53 [INFO] [lib.models.video:417] Chunk size increased from 250 to 260 (after 3 successes, increment: 10)
2025-12-12 16:06:53 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:53 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:54 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:06:54 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:06:54 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:54 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:54 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:54 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:06:56 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:56 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:56 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:06:56 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:06:56 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:56 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:56 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:56 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:06:58 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:58 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:06:58 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:06:58 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:06:58 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:06:58 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:06:59 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:06:59 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:00 [INFO] [lib.models.video:417] Chunk size increased from 430 to 440 (after 3 successes, increment: 10)
2025-12-12 16:07:00 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:00 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 19/32
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:01 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:01 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:01 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:03 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:03 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:03 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:03 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:03 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:03 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:03 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:03 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:04 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:04 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:05 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:05 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:05 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:05 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:05 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:05 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:07:06 [INFO] [lib.models.video:417] Chunk size increased from 440 to 450 (after 3 successes, increment: 10)
2025-12-12 16:07:07 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:07 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:07 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:07:07 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:07:07 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:07 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:07 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:07 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:07:09 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:09 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:09 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:07:09 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:07:09 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:09 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:10 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:10 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:11 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:11 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 20/32
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:11 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:11 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:12 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:12 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:13 [INFO] [lib.models.video:417] Chunk size increased from 450 to 460 (after 3 successes, increment: 10)
2025-12-12 16:07:14 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:14 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:14 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:14 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:14 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:14 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:14 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:14 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:15 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:15 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:15 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:15 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:15 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:15 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:16 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:16 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:07:18 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:18 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:18 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:07:18 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:07:18 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:18 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:18 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:18 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:07:20 [INFO] [lib.models.video:417] Chunk size increased from 460 to 470 (after 3 successes, increment: 10)
2025-12-12 16:07:20 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:20 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:20 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:07:20 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:07:20 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:20 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:21 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:21 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:22 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:22 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 21/32
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:22 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:22 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:23 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:23 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:25 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:25 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:25 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:25 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:25 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:25 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:25 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:25 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:26 [INFO] [lib.models.video:417] Chunk size increased from 260 to 270 (after 3 successes, increment: 10)
2025-12-12 16:07:26 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:26 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:26 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:26 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:26 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:26 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:27 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:27 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:07:29 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:29 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:29 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:07:29 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:07:29 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:29 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:29 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:29 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:07:31 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:31 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:31 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:07:31 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:07:31 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:31 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:31 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:31 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:33 [INFO] [lib.models.video:417] Chunk size increased from 470 to 480 (after 3 successes, increment: 10)
2025-12-12 16:07:33 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:33 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 22/32
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:33 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:33 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:34 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:34 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:35 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:35 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:36 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:36 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:36 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:36 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:36 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:36 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:37 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:37 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:37 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:37 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:37 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:37 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:38 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:38 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:07:39 [INFO] [lib.models.video:417] Chunk size increased from 480 to 490 (after 3 successes, increment: 10)
2025-12-12 16:07:39 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:39 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:40 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:07:40 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:07:40 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:40 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:40 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:40 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:07:42 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:42 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:42 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:07:42 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:07:42 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:42 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:42 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:42 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:44 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:44 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 23/32
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:44 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:44 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:45 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:45 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:46 [INFO] [lib.models.video:417] Chunk size increased from 490 to 500 (after 3 successes, increment: 10)
2025-12-12 16:07:46 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:46 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:47 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:47 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:47 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:47 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:47 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:47 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:48 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:48 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:48 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:48 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:48 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:48 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:49 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:49 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:07:50 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:50 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:51 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:07:51 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:07:51 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:51 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:51 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:51 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:07:53 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:53 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:53 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:07:53 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:07:53 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:07:53 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:53 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:53 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:07:55 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:55 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 24/32
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:07:55 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:55 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:56 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:56 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:07:57 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:57 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:57 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:07:57 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:07:57 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:57 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:07:58 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:07:58 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:07:59 [INFO] [lib.models.video:417] Chunk size increased from 270 to 280 (after 6 successes, increment: 10)
2025-12-12 16:07:59 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:59 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:07:59 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:07:59 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:07:59 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:07:59 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:00 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:00 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:01 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:01 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:01 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:01 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:01 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:01 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:02 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:02 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:04 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:04 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:04 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:04 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:04 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:04 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:04 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:04 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:08:06 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:06 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 25/32
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:08:06 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:06 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:07 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:07 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:08:08 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:08 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:08 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:08:08 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:08:08 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:08 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:09 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:09 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:08:10 [INFO] [lib.models.video:417] Chunk size increased from 280 to 290 (after 5 successes, increment: 10)
2025-12-12 16:08:10 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:10 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:10 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:08:10 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:08:10 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:10 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:11 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:11 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:12 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:12 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:12 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:12 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:12 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:12 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:13 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:13 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:14 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:14 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:15 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:15 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:15 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:15 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:15 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:15 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:08:17 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:17 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 26/32
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:17 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:17 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:17 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:08:19 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:19 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:19 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:08:19 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:08:19 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:19 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:20 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:20 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:08:21 [INFO] [lib.models.video:417] Chunk size increased from 290 to 300 (after 5 successes, increment: 10)
2025-12-12 16:08:21 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:21 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:21 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:08:21 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:08:21 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:21 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:21 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:21 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:23 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:23 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:23 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:23 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:23 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:23 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:24 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:24 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:25 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:25 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:26 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:26 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:26 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:26 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:26 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:26 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:08:28 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:28 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 27/32
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:28 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:28 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:28 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:08:30 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:30 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:30 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:08:30 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:08:30 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:30 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:31 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:31 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:08:32 [INFO] [lib.models.video:417] Chunk size increased from 300 to 310 (after 5 successes, increment: 10)
2025-12-12 16:08:32 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:32 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:32 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:08:32 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:08:32 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:32 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:32 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:32 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:34 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:34 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:34 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:34 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:34 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:34 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:35 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:35 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:36 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:36 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:36 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:36 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:36 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:36 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:37 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:37 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:08:39 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:39 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 28/32
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:39 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:39 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:39 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:08:41 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:41 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:41 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:08:41 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:08:41 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:41 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:42 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:42 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:08:42 [INFO] [lib.models.video:417] Chunk size increased from 310 to 320 (after 5 successes, increment: 10)
2025-12-12 16:08:43 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:43 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:43 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:08:43 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:08:43 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:43 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:43 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:43 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:45 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:45 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:45 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:45 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:45 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:45 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:46 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:46 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:47 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:47 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:48 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:48 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:48 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:08:48 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:48 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:48 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:08:50 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:50 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 29/32
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:50 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:50 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:50 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:08:52 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:52 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:52 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:08:52 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:08:52 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:52 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:53 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:53 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:08:53 [INFO] [lib.models.video:417] Chunk size increased from 320 to 330 (after 5 successes, increment: 10)
2025-12-12 16:08:54 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:54 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:54 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:08:54 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:08:54 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:54 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:54 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:54 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:08:56 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:56 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:56 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:08:56 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:08:56 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:56 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:57 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:57 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:08:58 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:58 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:08:58 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:08:58 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:08:58 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:08:58 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:08:59 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:08:59 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:09:00 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:00 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 30/32
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:01 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:01 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:01 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:09:03 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:03 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:03 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:09:03 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:09:03 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:03 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:03 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:03 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:09:04 [INFO] [lib.models.video:417] Chunk size increased from 330 to 340 (after 5 successes, increment: 10)
2025-12-12 16:09:04 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:04 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:05 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:09:05 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:09:05 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:05 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:05 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:05 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:09:07 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:07 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:07 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:09:07 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:09:07 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:07 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:07 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:07 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:09:09 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:09 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:09 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:09:09 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:09:09 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:09 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:10 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:10 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:09:11 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:11 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 31/32
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:09:12 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:12 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:12 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:09:14 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:14 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:14 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:09:14 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:09:14 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:09:14 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:14 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:14 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:09:15 [INFO] [lib.models.video:417] Chunk size increased from 340 to 350 (after 5 successes, increment: 10)
2025-12-12 16:09:15 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:15 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:16 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:09:16 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:09:16 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:09:16 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:16 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:16 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:09:18 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:18 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:18 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:09:18 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:09:18 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:09:18 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:18 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:18 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:09:20 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:20 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:20 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:09:20 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:09:20 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 16:09:20 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:21 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:21 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:09:22 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:22 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 32/32
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 16:09:22 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:22 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:23 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:23 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 1...
2025-12-12 16:09:24 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:24 [ERROR] [lib.training.pipeline:1516] Error training fold 1: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:25 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 16:09:25 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 16:09:25 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:25 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:25 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:25 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 2...
2025-12-12 16:09:26 [INFO] [lib.models.video:417] Chunk size increased from 350 to 360 (after 5 successes, increment: 10)
2025-12-12 16:09:26 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:26 [ERROR] [lib.training.pipeline:1516] Error training fold 2: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:26 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 16:09:26 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 16:09:26 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:26 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:27 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:27 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 3...
2025-12-12 16:09:28 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:28 [ERROR] [lib.training.pipeline:1516] Error training fold 3: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:29 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 16:09:29 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-12 16:09:29 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:29 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:29 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:29 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 4...
2025-12-12 16:09:31 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:31 [ERROR] [lib.training.pipeline:1516] Error training fold 4: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:31 [INFO] [lib.training.pipeline:833] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 16:09:31 [INFO] [lib.training.pipeline:842] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-12 16:09:31 [INFO] [lib.training.pipeline:912] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 16:09:31 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:32 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:32 [INFO] [lib.training.pipeline:1022] Training PyTorch model x3d on fold 5...
2025-12-12 16:09:33 [ERROR] [lib.training.pipeline:1109] Model forward pass test failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:33 [ERROR] [lib.training.pipeline:1516] Error training fold 5: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1055, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1110, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1575] ================================================================================
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1576] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1577] ================================================================================
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1590] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1600] Final training using default hyperparameters (no grid search)
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1604] 
Final Training - x3d - Fold 1/5 (full dataset)
2025-12-12 16:09:33 [INFO] [lib.training.pipeline:1613] Deleted existing final training fold 1 directory (clean mode)
2025-12-12 16:09:33 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:34 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:34 [INFO] [lib.training.pipeline:1728] Training PyTorch model x3d on fold 1 (full dataset)...
2025-12-12 16:09:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 16:09:35 [INFO] [lib.models.video:417] Chunk size increased from 200 to 210 (after 4 successes, increment: 10)
2025-12-12 16:09:35 [ERROR] [lib.training.pipeline:1915] Error training final fold 1: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1730, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 609, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 307, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:35 [INFO] [lib.training.pipeline:1604] 
Final Training - x3d - Fold 2/5 (full dataset)
2025-12-12 16:09:35 [INFO] [lib.training.pipeline:1613] Deleted existing final training fold 2 directory (clean mode)
2025-12-12 16:09:35 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:36 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:36 [INFO] [lib.training.pipeline:1728] Training PyTorch model x3d on fold 2 (full dataset)...
2025-12-12 16:09:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 16:09:49 [ERROR] [lib.training.pipeline:1915] Error training final fold 2: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1730, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 609, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 307, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:49 [INFO] [lib.training.pipeline:1604] 
Final Training - x3d - Fold 3/5 (full dataset)
2025-12-12 16:09:49 [INFO] [lib.training.pipeline:1613] Deleted existing final training fold 3 directory (clean mode)
2025-12-12 16:09:49 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:50 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:50 [INFO] [lib.training.pipeline:1728] Training PyTorch model x3d on fold 3 (full dataset)...
2025-12-12 16:09:50 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 16:09:51 [ERROR] [lib.training.pipeline:1915] Error training final fold 3: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1730, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 609, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 307, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:51 [INFO] [lib.training.pipeline:1604] 
Final Training - x3d - Fold 4/5 (full dataset)
2025-12-12 16:09:51 [INFO] [lib.training.pipeline:1613] Deleted existing final training fold 4 directory (clean mode)
2025-12-12 16:09:51 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:51 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:51 [INFO] [lib.training.pipeline:1728] Training PyTorch model x3d on fold 4 (full dataset)...
2025-12-12 16:09:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 16:09:53 [INFO] [lib.models.video:417] Chunk size increased from 200 to 210 (after 3 successes, increment: 10)
2025-12-12 16:09:54 [ERROR] [lib.training.pipeline:1915] Error training final fold 4: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1730, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 609, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 307, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:54 [INFO] [lib.training.pipeline:1604] 
Final Training - x3d - Fold 5/5 (full dataset)
2025-12-12 16:09:54 [INFO] [lib.training.pipeline:1613] Deleted existing final training fold 5 directory (clean mode)
2025-12-12 16:09:54 [WARNING] [lib.training.x3d:57] torchvision X3D not available. Using r3d_18 as approximation.
2025-12-12 16:09:54 [WARNING] [lib.mlops.mlflow_tracker:176] Failed to create MLflow tracker: Run with UUID 6bbd9d6ba4064632ab37a1d7a9404b8a is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-12-12 16:09:54 [INFO] [lib.training.pipeline:1728] Training PyTorch model x3d on fold 5 (full dataset)...
2025-12-12 16:09:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 16:09:56 [ERROR] [lib.training.pipeline:1915] Error training final fold 5: cannot access local variable 'use_scaled_videos' where it is not associated with a value
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1730, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 609, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 307, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 836, in __getitem__
    if not use_scaled_videos and self.train:
           ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'use_scaled_videos' where it is not associated with a value
2025-12-12 16:09:56 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/fold_1 to copy
2025-12-12 16:09:56 [INFO] [lib.training.pipeline:1988] 
x3d - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 16:09:57 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots/cv_fold_comparison.png
2025-12-12 16:09:57 [INFO] [lib.training.pipeline:2016] Generated plots for x3d in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots
2025-12-12 16:09:58 [INFO] [lib.training.pipeline:2053] ================================================================================
2025-12-12 16:09:58 [INFO] [lib.training.pipeline:2054] Stage 5: Model Training Pipeline Completed
2025-12-12 16:09:58 [INFO] [lib.training.pipeline:2055] ================================================================================
2025-12-12 16:09:58 [INFO] [__main__:401] ================================================================================
2025-12-12 16:09:58 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 16:09:58 [INFO] [__main__:403] ================================================================================
2025-12-12 16:09:58 [INFO] [__main__:404] Execution time: 392.48 seconds (6.54 minutes)
2025-12-12 16:09:58 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 16:09:58 [INFO] [__main__:407] Models trained: ['x3d']
2025-12-12 16:09:58 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 16:09:58 [INFO] [__main__:414] ================================================================================
2025-12-12 16:09:58 [INFO] [__main__:415] Final memory statistics:
2025-12-12 16:09:58 [INFO] [__main__:416] ================================================================================
2025-12-12 16:09:58 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: after training): {'cpu_memory_mb': 5027.3671875, 'cpu_memory_gb': 4.909538269042969, 'cpu_vms_mb': 51345.375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.322961408, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.605380608}
2025-12-12 16:09:58 [INFO] [__main__:419] ================================================================================
2025-12-12 16:09:58 [INFO] [__main__:420] Training complete!
2025-12-12 16:09:58 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 16:09:58 [INFO] [__main__:422] ================================================================================
