2025-12-11 17:41:38 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 748.7578125, 'cpu_memory_gb': 0.7312088012695312, 'cpu_vms_mb': 10234.32421875, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-11 17:41:38 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 17:41:38 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-11 17:41:38 [INFO] [lib.training.stage5_feature_pipeline:63] Loading scaled metadata...
2025-12-11 17:41:39 [INFO] [lib.training.stage5_feature_pipeline:72] Loaded 3244 videos
2025-12-11 17:41:39 [INFO] [lib.training.stage5_feature_pipeline:86] Labels: [0, 1] -> {0: 0, 1: 1}
2025-12-11 17:41:39 [INFO] [lib.training.stage5_feature_pipeline:89] Loading features from Stage 2/4 (collinearity removal will be done once before splits)...
2025-12-11 17:41:39 [INFO] [lib.training.feature_preprocessing:316] Loading Stage 2 features...
2025-12-11 17:41:51 [INFO] [lib.training.feature_preprocessing:363] Loaded 15 Stage 2 features (3244/3244 videos matched)
2025-12-11 17:41:51 [INFO] [lib.training.feature_preprocessing:371] Loading Stage 4 features...
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:411] Sample unmatched Stage 4 videos (showing first 1): ['data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4']
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:412] Sample Stage 4 feature paths (showing first 3): ['data/scaled_videos/51EwLmqOYNg_aug4_scaled_aug4.mp4', 'data/scaled_videos/735177418030252033_aug0_scaled_aug0.mp4', 'data/scaled_videos/-y0Vr7JmCek_aug5_scaled_aug5.mp4']
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:416] Loaded 23 Stage 4 features (3243/3244 videos matched)
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:427] Combined 38 features from 2 stages
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:436] Stage 2: 3244 videos, Stage 4: 3243 videos
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:437] Intersection (videos with BOTH Stage 2 AND Stage 4): 3243 videos
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:458] ✓ Found 3243 videos with valid features (>= 3000 required)
2025-12-11 17:42:08 [INFO] [lib.training.feature_training_pipeline:152] Removing collinear features BEFORE data splits (to avoid data leakage)...
2025-12-11 17:42:08 [INFO] [lib.training.feature_training_pipeline:153]   Original feature count: 38
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:76] Removed 2 features with zero variance
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_noise_mean (correlation=0.992)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_mean (correlation=0.999)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.992)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.968)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.988)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.959)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_gradient_std (correlation=0.964)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_boundary_inconsistency (correlation=0.994)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_noise_energy (correlation=0.958)
2025-12-11 17:42:08 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_is_downscaled (correlation=-0.998)
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:138] Removed 10 collinear features (correlation >= 0.95)
2025-12-11 17:42:08 [INFO] [lib.training.feature_preprocessing:159] Final feature count: 26/38 (68.4% retained)
2025-12-11 17:42:08 [INFO] [lib.training.feature_training_pipeline:162]   Final feature count after collinearity removal: 26/38 (68.4% retained)
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:104] ✓ Loaded 26 features for 3244 videos
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:105]   Features already cleaned (collinearity removed before splits)
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:120] After filtering to videos with valid features: 3243/3244 videos
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:136] ✓ Sufficient videos with valid features: 3243 >= 3000
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:146] Feature-based models: []
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:147] Video-based models: ['slowfast']
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:187] ================================================================================
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:188] TRAINING VIDEO-BASED MODELS
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:189] ================================================================================
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:192] Validating videos and checking for corrupted files...
2025-12-11 17:42:08 [INFO] [lib.training.stage5_feature_pipeline:193] This may take a few minutes...
2025-12-11 17:42:08 [INFO] [lib.utils.video_validation:143] Sampling 324 videos to check validity...
2025-12-11 17:42:08 [INFO] [lib.utils.video_validation:91] Validating 324 videos...
2025-12-11 17:42:24 [INFO] [lib.utils.video_validation:95] Validated 100/324 videos...
2025-12-11 17:42:40 [INFO] [lib.utils.video_validation:95] Validated 200/324 videos...
2025-12-11 17:43:01 [INFO] [lib.utils.video_validation:95] Validated 300/324 videos...
2025-12-11 17:43:06 [INFO] [lib.utils.video_validation:153] Sample validity rate: 100.00% (324/324)
2025-12-11 17:43:06 [INFO] [lib.utils.video_validation:154] Estimated valid videos: 3244/3244
2025-12-11 17:43:06 [INFO] [lib.utils.video_validation:166] Sample suggests sufficient valid videos. Checking all videos to confirm...
2025-12-11 17:43:06 [INFO] [lib.utils.video_validation:91] Validating 3244 videos...
2025-12-11 17:43:19 [INFO] [lib.utils.video_validation:95] Validated 100/3244 videos...
2025-12-11 17:43:29 [INFO] [lib.utils.video_validation:95] Validated 200/3244 videos...
2025-12-11 17:43:39 [INFO] [lib.utils.video_validation:95] Validated 300/3244 videos...
2025-12-11 17:43:50 [INFO] [lib.utils.video_validation:95] Validated 400/3244 videos...
2025-12-11 17:44:03 [INFO] [lib.utils.video_validation:95] Validated 500/3244 videos...
2025-12-11 17:44:15 [INFO] [lib.utils.video_validation:95] Validated 600/3244 videos...
2025-12-11 17:44:27 [INFO] [lib.utils.video_validation:95] Validated 700/3244 videos...
2025-12-11 17:44:39 [INFO] [lib.utils.video_validation:95] Validated 800/3244 videos...
2025-12-11 17:44:50 [INFO] [lib.utils.video_validation:95] Validated 900/3244 videos...
2025-12-11 17:45:01 [INFO] [lib.utils.video_validation:95] Validated 1000/3244 videos...
2025-12-11 17:45:12 [INFO] [lib.utils.video_validation:95] Validated 1100/3244 videos...
2025-12-11 17:45:24 [INFO] [lib.utils.video_validation:95] Validated 1200/3244 videos...
2025-12-11 17:45:36 [INFO] [lib.utils.video_validation:95] Validated 1300/3244 videos...
2025-12-11 17:45:48 [INFO] [lib.utils.video_validation:95] Validated 1400/3244 videos...
2025-12-11 17:45:59 [INFO] [lib.utils.video_validation:95] Validated 1500/3244 videos...
2025-12-11 17:46:11 [INFO] [lib.utils.video_validation:95] Validated 1600/3244 videos...
2025-12-11 17:46:23 [INFO] [lib.utils.video_validation:95] Validated 1700/3244 videos...
2025-12-11 17:46:35 [INFO] [lib.utils.video_validation:95] Validated 1800/3244 videos...
2025-12-11 17:46:48 [INFO] [lib.utils.video_validation:95] Validated 1900/3244 videos...
2025-12-11 17:47:01 [INFO] [lib.utils.video_validation:95] Validated 2000/3244 videos...
2025-12-11 17:47:10 [ERROR] [libav.mov,mp4,m4a,3gp,3g2,mj2:337] moov atom not found
2025-12-11 17:47:14 [INFO] [lib.utils.video_validation:95] Validated 2100/3244 videos...
2025-12-11 17:47:28 [INFO] [lib.utils.video_validation:95] Validated 2200/3244 videos...
2025-12-11 17:47:43 [INFO] [lib.utils.video_validation:95] Validated 2300/3244 videos...
2025-12-11 17:48:03 [INFO] [lib.utils.video_validation:95] Validated 2400/3244 videos...
2025-12-11 17:48:21 [INFO] [lib.utils.video_validation:95] Validated 2500/3244 videos...
2025-12-11 17:48:35 [INFO] [lib.utils.video_validation:95] Validated 2600/3244 videos...
2025-12-11 17:48:49 [INFO] [lib.utils.video_validation:95] Validated 2700/3244 videos...
2025-12-11 17:49:04 [INFO] [lib.utils.video_validation:95] Validated 2800/3244 videos...
2025-12-11 17:49:18 [INFO] [lib.utils.video_validation:95] Validated 2900/3244 videos...
2025-12-11 17:49:30 [INFO] [lib.utils.video_validation:95] Validated 3000/3244 videos...
2025-12-11 17:49:45 [INFO] [lib.utils.video_validation:95] Validated 3100/3244 videos...
2025-12-11 17:49:56 [INFO] [lib.utils.video_validation:95] Validated 3200/3244 videos...
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:181] Video validation complete:
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:182]   Total videos: 3244
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:183]   Valid videos: 3243
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:184]   Invalid videos: 1
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:185]   Corrupted videos: 1
2025-12-11 17:50:08 [INFO] [lib.utils.video_validation:202] ✓ Sufficient valid videos: 3243 >= 3000
2025-12-11 17:50:08 [INFO] [lib.training.stage5_feature_pipeline:206] ✓ Video validation complete: 3243 valid videos
2025-12-11 17:50:08 [INFO] [lib.training.stage5_feature_pipeline:216] Invalid videos report saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/invalid_videos_report.txt
2025-12-11 17:50:08 [INFO] [lib.training.stage5_feature_pipeline:227] After video validation: 3243 valid videos
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:250] Train: 1945, Val: 649, Test: 649
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:253] ================================================================================
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:254] Training slowfast (video-based)
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:255] ================================================================================
2025-12-11 17:50:09 [INFO] [lib.training.video_training_pipeline:117] Using GPU for slowfast
2025-12-11 17:50:09 [INFO] [lib.training.video_training_pipeline:122] Training slowfast with scaled videos: sampling 1000 frames per video (uniformly across video duration)
2025-12-11 17:50:09 [ERROR] [lib.training.stage5_feature_pipeline:279] ✗ Failed to train slowfast: VideoConfig.__init__() got an unexpected keyword argument 'use_scaled_videos'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/stage5_feature_pipeline.py", line 261, in stage5_train_all_models
    results = train_video_model(
              ^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/video_training_pipeline.py", line 135, in train_video_model
    video_config = VideoConfig(
                   ^^^^^^^^^^^^
TypeError: VideoConfig.__init__() got an unexpected keyword argument 'use_scaled_videos'
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:282] ================================================================================
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:283] STAGE 5 TRAINING COMPLETE
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:284] ================================================================================
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:290] Successful: 0/1
2025-12-11 17:50:09 [INFO] [lib.training.stage5_feature_pipeline:291] Failed: 1/1
2025-12-11 17:50:09 [WARNING] [lib.training.stage5_feature_pipeline:303] Failed models:
2025-12-11 17:50:09 [WARNING] [lib.training.stage5_feature_pipeline:305]   slowfast: VideoConfig.__init__() got an unexpected keyword argument 'use_scaled_videos'
2025-12-11 17:50:09 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: after training): {'cpu_memory_mb': 771.90234375, 'cpu_memory_gb': 0.7538108825683594, 'cpu_vms_mb': 10357.62109375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-11 17:50:09 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 17:50:09 [DEBUG] [lib.utils.memory:96] Num threads: 6
