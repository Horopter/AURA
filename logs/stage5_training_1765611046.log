2025-12-13 02:30:46 [INFO] [__main__:310] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 02:30:46 [INFO] [__main__:312] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 02:30:46 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:30:46 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:30:46 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:30:46 [INFO] [__main__:317] Model types: ['xgboost_i3d']
2025-12-13 02:30:46 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 02:30:46 [INFO] [__main__:319] Number of frames: 1000
2025-12-13 02:30:46 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:30:46 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 02:30:46 [INFO] [__main__:324] Delete existing: True
2025-12-13 02:30:46 [INFO] [__main__:325] Resume mode: True
2025-12-13 02:30:46 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765611046.log
2025-12-13 02:30:46 [INFO] [__main__:333] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 02:30:46 [INFO] [__main__:335] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:30:46 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 02:30:46 [INFO] [__main__:358] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 02:30:46 [INFO] [__main__:360] ================================================================================
2025-12-13 02:30:46 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.91015625, 'cpu_memory_gb': 0.7186622619628906, 'cpu_vms_mb': 10217.6015625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 02:30:46 [INFO] [__main__:364] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 02:30:46 [INFO] [__main__:366] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 02:30:46 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 02:30:46 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 02:30:46 [INFO] [__main__:370] ================================================================================
2025-12-13 02:30:46 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 02:30:46 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:499] Model types: ['xgboost_i3d']
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:501] Frames per video: 1000
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-13 02:30:46 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:333] ✓ xgboost_i3d: CAN RUN
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:346]   ['xgboost_i3d']
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 02:30:48 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=828856.79GB, used=1670983.21GB (66.8%)
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:647] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:720] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:816] Stage 5: Deleting existing model results (clean mode)...
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:828] Stage 5: Deleted 0 existing model directories
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:833] 
================================================================================
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:834] Stage 5: Training model: xgboost_i3d
2025-12-13 02:30:48 [INFO] [lib.training.pipeline:835] ================================================================================
2025-12-13 02:30:49 [INFO] [lib.training.pipeline:868] Grid search: 48 hyperparameter combinations to try
2025-12-13 02:30:49 [INFO] [lib.training.pipeline:876] ================================================================================
2025-12-13 02:30:49 [INFO] [lib.training.pipeline:877] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-13 02:30:49 [INFO] [lib.training.pipeline:878] ================================================================================
2025-12-13 02:30:50 [INFO] [lib.training.pipeline:887] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:900] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 1/48
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:30:52 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:30:52 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:30:52 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:30:52 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:30:52 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:30:52 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:30:52 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:06 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.80 GiB is free. Including non-PyTorch memory, this process has 12.96 GiB memory in use. Of the allocated memory 12.57 GiB is allocated by PyTorch, and 27.43 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.80 GiB is free. Including non-PyTorch memory, this process has 12.96 GiB memory in use. Of the allocated memory 12.57 GiB is allocated by PyTorch, and 27.43 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:06 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:31:06 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:31:06 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:06 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:06 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:06 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:07 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:07 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:11 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.68 GiB is free. Including non-PyTorch memory, this process has 13.08 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 24.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.68 GiB is free. Including non-PyTorch memory, this process has 13.08 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 24.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:11 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:31:11 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:31:11 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:11 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:11 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:11 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:12 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:12 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:17 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:17 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:31:17 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:31:17 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:17 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:17 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:17 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:18 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:18 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:23 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:23 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:31:23 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:31:23 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:23 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:31:23 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:23 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:24 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:24 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:29 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:1853] Parameter combination 1 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 2/48
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 1.0}
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:31:30 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:31:30 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:30 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:31:30 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:30 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:30 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:30 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:35 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:35 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:31:35 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:31:35 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:31:35 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:35 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:35 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:35 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:35 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:35 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:40 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:40 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:31:40 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:31:40 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:31:40 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:40 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:40 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:40 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:40 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:40 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:45 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:45 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:31:45 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:31:45 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:31:45 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:45 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:31:45 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:45 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:46 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:46 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:51 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:51 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:31:51 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:31:51 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:31:51 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:51 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:31:51 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:51 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:51 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:51 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:31:56 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:1853] Parameter combination 2 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 3/48
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.01, 'subsample': 1.0, 'colsample_bytree': 0.8}
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:31:56 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:31:56 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:31:56 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:31:56 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:31:56 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:31:57 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:31:57 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:01 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:02 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:32:02 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:32:02 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:32:02 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:02 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:02 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:02 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:02 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:02 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:06 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:07 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:32:07 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:32:07 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:32:07 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:07 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:07 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:07 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:07 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:07 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:12 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:12 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:32:12 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:32:12 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:32:12 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:12 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:12 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:12 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:13 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:13 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:17 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:17 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:32:17 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:32:17 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:32:17 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:17 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:32:17 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:17 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:18 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:18 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:23 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:1853] Parameter combination 3 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 4/48
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.01, 'subsample': 1.0, 'colsample_bytree': 1.0}
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:32:23 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:32:23 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:23 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:32:23 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:23 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:23 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:23 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:28 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:29 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:32:29 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:32:29 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:32:29 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:29 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:29 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:29 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:29 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:29 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:33 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:33 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:32:33 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:32:33 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:32:33 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:33 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:33 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:33 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:34 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:34 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:38 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:39 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:32:39 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:32:39 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:32:39 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:39 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:39 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:39 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:39 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:39 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:44 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:44 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:32:44 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:32:44 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:32:44 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:44 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:32:44 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:44 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:45 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:45 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:49 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:1853] Parameter combination 4 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 5/48
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:32:50 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:32:50 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:50 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:32:50 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:50 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:50 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:50 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:32:55 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:32:55 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:32:55 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:32:55 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:32:55 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:32:55 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:32:55 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:32:55 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:32:55 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:32:55 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:00 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:00 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:33:00 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:33:00 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:33:00 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:00 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:00 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:00 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:00 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:00 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:05 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:05 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:33:05 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:33:05 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:33:05 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:05 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:05 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:05 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:06 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:06 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:10 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:11 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:33:11 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:33:11 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:33:11 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:11 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:33:11 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:11 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:11 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:11 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:16 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:1853] Parameter combination 5 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 6/48
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 1.0}
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:33:16 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:33:16 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:16 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:33:16 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:16 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:16 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:16 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:21 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.60 GiB is free. Including non-PyTorch memory, this process has 13.16 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 104.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.60 GiB is free. Including non-PyTorch memory, this process has 13.16 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 104.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:21 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:33:21 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:33:21 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:33:21 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:21 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:21 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:21 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:22 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:22 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:26 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:26 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:33:26 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:33:26 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:33:26 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:26 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:26 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:26 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:27 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:27 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:31 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:32 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:33:32 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:33:32 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:33:32 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:32 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:32 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:32 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:32 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:32 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:37 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:37 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:33:37 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:33:37 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:33:37 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:37 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:33:37 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:37 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:38 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:38 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:42 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:1853] Parameter combination 6 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 7/48
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 1.0, 'colsample_bytree': 0.8}
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:33:43 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:33:43 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:43 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:33:43 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:43 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:43 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:43 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:48 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:48 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:33:48 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:33:48 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:33:48 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:48 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:48 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:48 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:48 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:48 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:52 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:53 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:33:53 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:33:53 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:33:53 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:53 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:53 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:53 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:53 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:53 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:33:58 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:33:58 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:33:58 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:33:58 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:33:58 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:33:58 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:33:58 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:33:58 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:33:59 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:33:59 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:04 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:04 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:34:04 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:34:04 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:34:04 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:04 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:34:04 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:04 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:04 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:04 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:09 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:1853] Parameter combination 7 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 8/48
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.1, 'subsample': 1.0, 'colsample_bytree': 1.0}
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:34:09 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:34:09 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:09 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:34:09 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:09 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:10 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:10 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:14 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:15 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:34:15 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:34:15 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:34:15 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:15 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:15 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:15 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:15 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:15 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:19 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:20 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:34:20 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:34:20 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:34:20 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:20 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:20 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:20 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:20 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:20 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:25 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:25 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:34:25 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:34:25 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:34:25 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:25 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:25 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:25 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:26 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:26 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:31 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:31 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:34:31 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:34:31 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:34:31 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:31 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:34:31 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:31 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:31 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:31 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:36 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:1853] Parameter combination 8 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 9/48
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:34:37 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:34:37 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:37 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:34:37 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:37 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:37 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:37 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:42 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:42 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:34:42 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:34:42 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:34:42 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:42 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:42 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:42 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:43 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:43 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:47 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:47 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:34:47 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:34:47 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:34:47 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:47 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:47 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:47 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:48 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:48 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:52 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:52 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:34:52 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:34:52 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:34:52 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:52 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:34:52 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:52 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:53 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:53 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:34:57 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:34:58 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:34:58 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:34:58 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:34:58 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:34:58 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:34:58 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:34:58 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:34:58 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:34:58 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:03 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:1853] Parameter combination 9 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 10/48
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 1.0}
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:35:03 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:35:03 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:03 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:35:03 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:03 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:04 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:04 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:08 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:08 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:35:08 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:35:08 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:35:08 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:08 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:08 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:08 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:09 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:09 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:13 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:13 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:35:13 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:35:13 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:35:13 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:13 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:13 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:13 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:14 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:14 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:18 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:19 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:35:19 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:35:19 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:35:19 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:19 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:19 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:19 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:19 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:19 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:24 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:24 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:35:24 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:35:24 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:35:24 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:24 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:35:24 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:24 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:25 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:25 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:29 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:1853] Parameter combination 10 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 11/48
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.01, 'subsample': 1.0, 'colsample_bytree': 0.8}
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:35:29 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:35:29 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:29 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:35:29 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:29 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:30 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:30 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:34 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:35 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:35:35 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:35:35 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:35:35 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:35 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:35 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:35 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:35 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:35 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:39 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:40 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:35:40 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:35:40 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:35:40 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:40 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:40 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:40 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:40 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:40 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:45 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:45 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:35:45 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:35:45 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:35:45 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:45 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:35:45 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:45 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:46 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:46 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:50 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:50 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:35:50 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:35:50 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:35:50 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:50 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:35:50 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:50 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:51 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:51 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:35:55 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:1853] Parameter combination 11 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 12/48
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.01, 'subsample': 1.0, 'colsample_bytree': 1.0}
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:35:56 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:35:56 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:35:56 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:35:56 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:35:56 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:35:56 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:35:56 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:01 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:01 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:36:01 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:36:01 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:36:01 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:01 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:01 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:01 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:01 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:01 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:05 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:06 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:36:06 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:36:06 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:36:06 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:06 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:06 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:06 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:06 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:06 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:10 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:11 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:36:11 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:36:11 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:36:11 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:11 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:11 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:11 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:11 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:11 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:15 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:16 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:36:16 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:36:16 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:36:16 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:16 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:36:16 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:16 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:16 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:16 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:21 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:1853] Parameter combination 12 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 13/48
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:36:21 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:36:21 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:21 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:36:21 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:21 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:22 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:22 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:26 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:27 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:36:27 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:36:27 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:36:27 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:27 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:27 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:27 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:27 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:27 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:31 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:31 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:36:31 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:36:31 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:36:31 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:31 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:31 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:31 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:32 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:32 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:36 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:37 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:36:37 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:36:37 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:36:37 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:37 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:37 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:37 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:37 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:37 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:42 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:42 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:36:42 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:36:42 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:36:42 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:42 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:36:42 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:42 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:42 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:42 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:47 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:1853] Parameter combination 13 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 14/48
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 1.0}
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:36:47 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:36:47 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:47 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:36:47 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:47 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:48 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:48 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:52 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:53 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:36:53 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:36:53 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:36:53 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:53 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:53 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:53 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:53 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:53 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:36:57 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:36:57 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:36:57 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:36:57 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:36:57 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:36:57 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:36:57 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:36:57 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:36:58 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:36:58 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:02 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:02 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:37:02 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:37:02 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:37:02 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:02 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:02 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:02 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:03 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:03 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:08 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.62 GiB is free. Including non-PyTorch memory, this process has 13.14 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 84.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:08 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:37:08 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:37:08 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:37:08 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:08 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:37:08 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:08 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:08 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:08 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:13 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:1853] Parameter combination 14 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 15/48
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 1.0, 'colsample_bytree': 0.8}
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:37:13 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:37:13 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:13 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:37:13 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:13 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:14 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:14 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:18 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:19 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:37:19 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:37:19 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:37:19 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:19 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:19 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:19 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:19 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:19 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:23 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:23 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:37:23 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:37:23 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:37:23 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:23 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:23 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:23 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:24 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:24 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:29 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:29 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:37:29 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:37:29 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:37:29 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:29 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:29 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:29 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:29 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:29 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:34 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:35 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:37:35 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:37:35 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:37:35 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:35 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:37:35 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:35 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:35 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:35 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:39 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:1853] Parameter combination 15 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 16/48
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 1.0, 'colsample_bytree': 1.0}
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:37:40 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:37:40 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:40 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:37:40 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:40 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:40 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:40 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:45 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:45 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:37:45 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:37:45 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:37:45 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:45 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:45 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:45 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:46 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:46 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:50 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:50 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:37:50 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:37:50 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:37:50 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:50 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:50 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:50 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:50 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:50 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:37:55 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:37:55 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:37:55 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:37:55 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:37:55 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:37:55 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:37:55 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:37:55 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:37:56 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:37:56 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:00 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:01 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:38:01 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:38:01 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:38:01 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:01 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:38:01 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:01 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:01 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:01 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:06 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:1853] Parameter combination 16 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 17/48
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 7, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:38:06 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:38:06 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:06 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:38:06 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:06 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:07 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:07 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:11 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:12 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:38:12 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:38:12 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:38:12 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:12 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:38:12 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:12 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:12 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:12 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:16 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:17 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (20% sample)
2025-12-13 02:38:17 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:38:17 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 02:38:17 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:17 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:38:17 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:17 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:17 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:17 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:21 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 3: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:22 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (20% sample)
2025-12-13 02:38:22 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:38:22 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 02:38:22 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:22 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:38:22 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:22 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:22 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:22 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:27 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 4: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:27 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (20% sample)
2025-12-13 02:38:27 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:38:27 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 02:38:27 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:27 [INFO] [lib.training._xgboost_pretrained:379] Processing 525 videos...
2025-12-13 02:38:27 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:27 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:28 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:28 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:32 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 5: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:1853] Parameter combination 17 - Mean F1: nan, Mean Acc: nan
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:913] 
================================================================================
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:914] Grid Search: Hyperparameter combination 18/48
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:915] Parameters: {'n_estimators': 100, 'max_depth': 7, 'learning_rate': 0.01, 'subsample': 0.8, 'colsample_bytree': 1.0}
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:916] ================================================================================
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (20% sample)
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:38:33 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 02:38:33 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:33 [INFO] [lib.training._xgboost_pretrained:379] Processing 523 videos...
2025-12-13 02:38:33 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:33 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:33 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:33 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:38 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 1: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.64 GiB is free. Including non-PyTorch memory, this process has 13.12 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 64.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-13 02:38:38 [INFO] [lib.training.pipeline:945] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (20% sample)
2025-12-13 02:38:38 [INFO] [lib.training.pipeline:954] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:38:38 [INFO] [lib.training.pipeline:1531] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 02:38:38 [INFO] [lib.training._xgboost_pretrained:378] Training XGBoost on features from i3d...
2025-12-13 02:38:38 [INFO] [lib.training._xgboost_pretrained:379] Processing 524 videos...
2025-12-13 02:38:38 [INFO] [lib.training._xgboost_pretrained:325] Loading pretrained model: i3d
2025-12-13 02:38:38 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 02:38:39 [ERROR] [lib.models.video:566] CRITICAL ERROR: use_scaled_videos=False in Stage 5! Stage 5 ALWAYS uses scaled videos from Stage 3. This indicates a configuration error - use_scaled_videos should be True. Falling back to scaled video mode (normalization only).
2025-12-13 02:38:39 [INFO] [lib.training._xgboost_pretrained:356] Extracting features using i3d...
2025-12-13 02:38:43 [ERROR] [lib.training.pipeline:1599] Error training XGBoost fold 2: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1546, in stage5_train_models
    # Note: Fold deletion already handled above before the resume check
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 388, in fit
    features, y = self._extract_features_batch(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 357, in _extract_features_batch
    features = extract_features_from_pretrained_model(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 129, in extract_features_from_pretrained_model
    x = model.backbone.layer1(x)
        ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torchvision/models/video/resnet.py", line 114, in forward
    out = self.conv2(out)
          ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 3.91 GiB. GPU 0 has a total capacity of 15.77 GiB of which 2.66 GiB is free. Including non-PyTorch memory, this process has 13.10 GiB memory in use. Of the allocated memory 12.70 GiB is allocated by PyTorch, and 44.85 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
