2025-12-09 04:36:54 [INFO] [__main__:167] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:168] STAGE 4: SCALED VIDEO FEATURE EXTRACTION
2025-12-09 04:36:54 [INFO] [__main__:169] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:170] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-09 04:36:54 [INFO] [__main__:171] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-09 04:36:54 [INFO] [__main__:172] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4
2025-12-09 04:36:54 [INFO] [__main__:176] Frame sampling: Adaptive (10.0% of frames, min=5, max=50)
2025-12-09 04:36:54 [INFO] [__main__:179] Video range: [0, 1082)
2025-12-09 04:36:54 [INFO] [__main__:182] Delete existing: False
2025-12-09 04:36:54 [INFO] [__main__:183] Resume mode: True
2025-12-09 04:36:54 [INFO] [__main__:184] Execution order: forward
2025-12-09 04:36:54 [INFO] [__main__:185] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage4_scaled_features_1765273014.log
2025-12-09 04:36:54 [DEBUG] [__main__:186] Python version: 3.11.7 (main, Dec 15 2023, 18:12:31) [GCC 11.2.0]
2025-12-09 04:36:54 [DEBUG] [__main__:187] Python executable: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/bin/python
2025-12-09 04:36:54 [DEBUG] [__main__:188] Working directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-09 04:36:54 [DEBUG] [__main__:189] Command line arguments: ['/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage4_scaled_features.py', '--project-root', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc', '--scaled-metadata', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow', '--output-dir', 'data/features_stage4', '--start-idx', '0', '--end-idx', '1082', '--execution-order', 'forward', '--resume']
2025-12-09 04:36:54 [INFO] [__main__:192] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:193] Checking prerequisites...
2025-12-09 04:36:54 [INFO] [__main__:194] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:200] âœ“ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-09 04:36:54 [DEBUG] [__main__:205] System information:
2025-12-09 04:36:54 [DEBUG] [__main__:206]   CPU count: 40
2025-12-09 04:36:54 [DEBUG] [__main__:207]   Total memory: 200.64 GB
2025-12-09 04:36:54 [DEBUG] [__main__:208]   Available memory: 185.75 GB
2025-12-09 04:36:54 [INFO] [__main__:213] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:214] Initial memory statistics:
2025-12-09 04:36:54 [INFO] [__main__:215] ================================================================================
2025-12-09 04:36:54 [INFO] [lib.utils.memory:89] Memory stats (Stage 4: before scaled feature extraction): {'cpu_memory_mb': 536.56640625, 'cpu_memory_gb': 0.5239906311035156, 'cpu_vms_mb': 5238.25, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-09 04:36:54 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-09 04:36:54 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-09 04:36:54 [INFO] [__main__:219] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:220] Starting Stage 4: Scaled Video Feature Extraction
2025-12-09 04:36:54 [INFO] [__main__:221] ================================================================================
2025-12-09 04:36:54 [INFO] [__main__:222] This may take a while depending on dataset size...
2025-12-09 04:36:54 [INFO] [__main__:223] Progress will be logged in real-time
2025-12-09 04:36:54 [INFO] [__main__:224] ================================================================================
2025-12-09 04:36:54 [INFO] [lib.features.scaled:210] Stage 4: Loading scaled metadata...
2025-12-09 04:36:54 [INFO] [lib.features.scaled:242] Stage 4: Processing video range [0, 1082) of 3244 total videos
2025-12-09 04:36:54 [INFO] [lib.features.scaled:251] Stage 4: Processing 1082 scaled videos in this range
2025-12-09 04:36:54 [INFO] [lib.features.scaled:265] Stage 4: Found 2435 existing feature files (resume mode)
2025-12-09 04:36:54 [INFO] [lib.features.scaled:301] Stage 4: Processing videos in FORWARD order (from start to end)
2025-12-09 04:36:56 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1473 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:03 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/2GgPk1N6-Kc_original_scaled_original.mp4 - feature file already exists
2025-12-09 04:37:05 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1246 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:12 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/130440720500480_aug3_scaled_aug3.mp4 - feature file already exists
2025-12-09 04:37:12 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1573 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:21 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/H7B0Vo7w8V0_aug7_scaled_aug7.mp4 - feature file already exists
2025-12-09 04:37:21 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1885 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:28 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/55K_LIHMqeE_aug9_scaled_aug9.mp4 - feature file already exists
2025-12-09 04:37:29 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 2770 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:36 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/TeM3rz6ll7s_aug5_scaled_aug5.mp4 - feature file already exists
2025-12-09 04:37:36 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1508 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:44 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/0jH7LL73wGA_aug5_scaled_aug5.mp4 - feature file already exists
2025-12-09 04:37:44 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1349 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:51 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/-Wgsj0ne_9M_original_scaled_original.mp4 - feature file already exists
2025-12-09 04:37:51 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 525 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:37:58 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/EdXSgYe-NaE_aug3_scaled_aug3.mp4 - feature file already exists
2025-12-09 04:37:58 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 113 total frames -> 11 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:00 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/1700718786612529_aug2_scaled_aug2.mp4 - feature file already exists
2025-12-09 04:38:00 [INFO] [lib.utils.memory:89] Memory stats (Stage 4: processing video 10/1082 (index 9)): {'cpu_memory_mb': 570.21875, 'cpu_memory_gb': 0.556854248046875, 'cpu_vms_mb': 10770.5703125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-09 04:38:00 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 200 total frames -> 20 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:03 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/VZZonaPf7Zk_aug4_scaled_aug4.mp4 - feature file already exists
2025-12-09 04:38:03 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1583 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:11 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/8LPANATSiTY_aug2_scaled_aug2.mp4 - feature file already exists
2025-12-09 04:38:11 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1508 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:18 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/0jH7LL73wGA_aug1_scaled_aug1.mp4 - feature file already exists
2025-12-09 04:38:18 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 806 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:25 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/CR2eTQlNRmw_aug7_scaled_aug7.mp4 - feature file already exists
2025-12-09 04:38:26 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 792 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:33 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/3ZL9WEPJ9lQ_aug6_scaled_aug6.mp4 - feature file already exists
2025-12-09 04:38:33 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1156 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:40 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/5aAuVnN73yE_aug2_scaled_aug2.mp4 - feature file already exists
2025-12-09 04:38:40 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 3933 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:48 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/769548237694992387_aug2_scaled_aug2.mp4 - feature file already exists
2025-12-09 04:38:48 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 5072 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:38:57 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/10151422025602266_aug9_scaled_aug9.mp4 - feature file already exists
2025-12-09 04:38:57 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 6762 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:06 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/1495065347383209_original_scaled_original.mp4 - feature file already exists
2025-12-09 04:39:06 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1524 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:13 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/-GfvGcrMeRw_aug1_scaled_aug1.mp4 - feature file already exists
2025-12-09 04:39:13 [INFO] [lib.utils.memory:89] Memory stats (Stage 4: processing video 20/1082 (index 19)): {'cpu_memory_mb': 570.44921875, 'cpu_memory_gb': 0.5570793151855469, 'cpu_vms_mb': 10770.5703125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-09 04:39:13 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 500 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:21 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/650983654122987520_aug0_scaled_aug0.mp4 - feature file already exists
2025-12-09 04:39:21 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1799 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:29 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/-vCurLgUN-o_aug7_scaled_aug7.mp4 - feature file already exists
2025-12-09 04:39:29 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 5223 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:38 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/461766770626221_aug8_scaled_aug8.mp4 - feature file already exists
2025-12-09 04:39:39 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 3547 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:39:47 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/AKTsQxbvXiU_aug4_scaled_aug4.mp4 - feature file already exists
2025-12-09 04:39:47 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 6994 total frames -> 50 frames (10.0%, bounded [5, 50])
