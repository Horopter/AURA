2025-12-11 18:09:26 [INFO] [__main__:266] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:267] STAGE 1: VIDEO AUGMENTATION
2025-12-11 18:09:26 [INFO] [__main__:268] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:269] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-11 18:09:26 [INFO] [__main__:270] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/augmented_videos
2025-12-11 18:09:26 [INFO] [__main__:271] Number of augmentations per video: 10
2025-12-11 18:09:26 [INFO] [__main__:272] Resume mode: Enabled
2025-12-11 18:09:26 [INFO] [__main__:273] Delete existing augmentations: No (preserved)
2025-12-11 18:09:26 [INFO] [__main__:278] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage1_augmentation_1765494566.log
2025-12-11 18:09:26 [DEBUG] [__main__:279] Python version: 3.11.7 (main, Dec 15 2023, 18:12:31) [GCC 11.2.0]
2025-12-11 18:09:26 [DEBUG] [__main__:280] Python executable: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/bin/python
2025-12-11 18:09:26 [DEBUG] [__main__:281] Working directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-11 18:09:26 [DEBUG] [__main__:282] Command line arguments: ['src/scripts/run_stage1_augmentation.py', '--resume']
2025-12-11 18:09:26 [INFO] [__main__:285] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:286] Checking prerequisites...
2025-12-11 18:09:26 [INFO] [__main__:287] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:295] ✓ Metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/video_index_input.csv
2025-12-11 18:09:26 [INFO] [__main__:311] ✓ Videos directory found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/videos
2025-12-11 18:09:26 [DEBUG] [__main__:316] System information:
2025-12-11 18:09:26 [DEBUG] [__main__:317]   CPU count: 72
2025-12-11 18:09:26 [DEBUG] [__main__:318]   Total memory: 200.67 GB
2025-12-11 18:09:26 [DEBUG] [__main__:319]   Available memory: 121.74 GB
2025-12-11 18:09:26 [INFO] [__main__:324] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:325] Initial memory statistics:
2025-12-11 18:09:26 [INFO] [__main__:326] ================================================================================
2025-12-11 18:09:26 [INFO] [lib.utils.memory:89] Memory stats (Stage 1: before augmentation): {'cpu_memory_mb': 611.578125, 'cpu_memory_gb': 0.5972442626953125, 'cpu_vms_mb': 7537.59765625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 0.0, 'gpu_free_gb': 0.0}
2025-12-11 18:09:26 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 18:09:26 [DEBUG] [lib.utils.memory:96] Num threads: 66
2025-12-11 18:09:26 [INFO] [__main__:330] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:331] Starting Stage 1: Video Augmentation
2025-12-11 18:09:26 [INFO] [__main__:332] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:333] This may take a while depending on dataset size...
2025-12-11 18:09:26 [INFO] [__main__:334] Progress will be logged in real-time
2025-12-11 18:09:26 [INFO] [__main__:335] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:342] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:343] RESUME MODE: Two-Pass Augmentation
2025-12-11 18:09:26 [INFO] [__main__:344] ================================================================================
2025-12-11 18:09:26 [INFO] [__main__:64] PASS 1: Checking which videos need augmentations...
2025-12-11 18:09:30 [INFO] [__main__:176] Checked 100/298 videos... (97 complete, 3 need augmentations)
2025-12-11 18:09:30 [INFO] [__main__:176] Checked 200/298 videos... (197 complete, 3 need augmentations)
2025-12-11 18:09:30 [INFO] [__main__:357] ================================================================================
2025-12-11 18:09:30 [INFO] [__main__:358] PASS 1 COMPLETE: Augmentation Status Check
2025-12-11 18:09:30 [INFO] [__main__:359] ================================================================================
2025-12-11 18:09:30 [INFO] [__main__:360] Check duration: 4.40 seconds (0.07 minutes)
2025-12-11 18:09:30 [INFO] [__main__:361] Total videos checked: 298
2025-12-11 18:09:30 [INFO] [__main__:362] Videos with complete augmentations: 295
2025-12-11 18:09:30 [INFO] [__main__:363] Videos needing augmentations: 3
2025-12-11 18:09:30 [INFO] [__main__:364] ================================================================================
2025-12-11 18:09:30 [INFO] [__main__:371] ================================================================================
2025-12-11 18:09:30 [INFO] [__main__:372] PASS 2: Generating augmentations for 3 videos...
2025-12-11 18:09:30 [INFO] [__main__:373] ================================================================================
2025-12-11 18:09:30 [ERROR] [__main__:516] ================================================================================
2025-12-11 18:09:30 [ERROR] [__main__:517] STAGE 1 FAILED
2025-12-11 18:09:30 [ERROR] [__main__:518] ================================================================================
2025-12-11 18:09:30 [ERROR] [__main__:519] Error: cannot access local variable 'pl' where it is not associated with a value
2025-12-11 18:09:30 [ERROR] [__main__:520] Exception type: UnboundLocalError
2025-12-11 18:09:30 [ERROR] [__main__:521] Full traceback:
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage1_augmentation.py", line 408, in main
    df_to_process = df.filter(pl.int_range(0, df.height).is_in(videos_needing_augmentations))
                              ^^
UnboundLocalError: cannot access local variable 'pl' where it is not associated with a value
2025-12-11 18:09:30 [ERROR] [__main__:522] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/augmented_videos
2025-12-11 18:09:30 [ERROR] [__main__:523] Partial results may be available
2025-12-11 18:09:30 [ERROR] [__main__:524] ================================================================================
