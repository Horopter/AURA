2025-12-11 13:50:24 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 772.35546875, 'cpu_memory_gb': 0.7542533874511719, 'cpu_vms_mb': 10257.30078125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-11 13:50:24 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 13:50:24 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-11 13:50:24 [INFO] [lib.training.stage5_feature_pipeline:63] Loading scaled metadata...
2025-12-11 13:50:24 [INFO] [lib.training.stage5_feature_pipeline:72] Loaded 3244 videos
2025-12-11 13:50:24 [INFO] [lib.training.stage5_feature_pipeline:86] Labels: [0, 1] -> {0: 0, 1: 1}
2025-12-11 13:50:24 [INFO] [lib.training.stage5_feature_pipeline:89] Loading features from Stage 2/4 (collinearity removal will be done once before splits)...
2025-12-11 13:50:24 [INFO] [lib.training.feature_preprocessing:265] Loading Stage 2 features...
2025-12-11 13:50:24 [INFO] [lib.training.feature_preprocessing:301] Loaded 15 Stage 2 features
2025-12-11 13:50:24 [INFO] [lib.training.feature_preprocessing:307] Loading Stage 4 features...
2025-12-11 13:50:25 [WARNING] [lib.training.feature_preprocessing:334] No Stage 4 features found for data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4
2025-12-11 13:50:25 [INFO] [lib.training.feature_preprocessing:341] Loaded 23 Stage 4 features
2025-12-11 13:50:25 [INFO] [lib.training.feature_preprocessing:351] Combined 38 features from 2 stages
2025-12-11 13:50:25 [INFO] [lib.training.feature_training_pipeline:149] Removing collinear features BEFORE data splits (to avoid data leakage)...
2025-12-11 13:50:25 [INFO] [lib.training.feature_training_pipeline:150]   Original feature count: 38
2025-12-11 13:50:26 [INFO] [lib.training.feature_preprocessing:76] Removed 2 features with zero variance
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_noise_mean (correlation=0.992)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_mean (correlation=0.999)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.992)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.968)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.988)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.959)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_gradient_std (correlation=0.964)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_boundary_inconsistency (correlation=0.994)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_noise_energy (correlation=0.958)
2025-12-11 13:50:26 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_is_downscaled (correlation=-0.998)
2025-12-11 13:50:26 [INFO] [lib.training.feature_preprocessing:138] Removed 10 collinear features (correlation >= 0.95)
2025-12-11 13:50:26 [INFO] [lib.training.feature_preprocessing:159] Final feature count: 26/38 (68.4% retained)
2025-12-11 13:50:26 [INFO] [lib.training.feature_training_pipeline:159]   Final feature count after collinearity removal: 26/38 (68.4% retained)
2025-12-11 13:50:26 [INFO] [lib.training.stage5_feature_pipeline:104] âœ“ Loaded 26 features for 3244 videos
2025-12-11 13:50:26 [INFO] [lib.training.stage5_feature_pipeline:105]   Features already cleaned (collinearity removed before splits)
2025-12-11 13:50:26 [INFO] [lib.training.stage5_feature_pipeline:120] After filtering to videos with valid features: 26/3244 videos
2025-12-11 13:50:26 [ERROR] [lib.training.stage5_feature_pipeline:130] Insufficient valid videos for training. Found 26 videos with valid features, but need more than 3000. Original dataset had 3244 videos. Some videos may be missing features or corrupted.
2025-12-11 13:50:26 [ERROR] [__main__:334] ================================================================================
2025-12-11 13:50:26 [ERROR] [__main__:335] STAGE 5 FAILED
2025-12-11 13:50:26 [ERROR] [__main__:336] ================================================================================
2025-12-11 13:50:26 [ERROR] [__main__:337] Error: Insufficient valid videos for training. Found 26 videos with valid features, but need more than 3000. Original dataset had 3244 videos. Some videos may be missing features or corrupted.
2025-12-11 13:50:26 [ERROR] [__main__:338] Exception type: ValueError
2025-12-11 13:50:26 [ERROR] [__main__:339] Full traceback:
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage5_training.py", line 280, in main
    results = stage5_train_all_models(
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/stage5_feature_pipeline.py", line 131, in stage5_train_all_models
    raise ValueError(error_msg)
ValueError: Insufficient valid videos for training. Found 26 videos with valid features, but need more than 3000. Original dataset had 3244 videos. Some videos may be missing features or corrupted.
2025-12-11 13:50:26 [ERROR] [__main__:340] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-11 13:50:26 [ERROR] [__main__:341] Partial results may be available
2025-12-11 13:50:26 [ERROR] [__main__:342] ================================================================================
