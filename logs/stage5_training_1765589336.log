2025-12-12 20:28:56 [INFO] [__main__:310] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 20:28:56 [INFO] [__main__:312] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 20:28:56 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:28:56 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 20:28:56 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 20:28:56 [INFO] [__main__:317] Model types: ['x3d']
2025-12-12 20:28:56 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 20:28:56 [INFO] [__main__:319] Number of frames: 500
2025-12-12 20:28:56 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 20:28:56 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 20:28:56 [INFO] [__main__:324] Delete existing: False
2025-12-12 20:28:56 [INFO] [__main__:325] Resume mode: True
2025-12-12 20:28:56 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765589336.log
2025-12-12 20:28:56 [INFO] [__main__:333] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 20:28:56 [INFO] [__main__:335] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:28:56 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 20:28:56 [INFO] [__main__:358] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 20:28:56 [INFO] [__main__:360] ================================================================================
2025-12-12 20:28:56 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 754.0703125, 'cpu_memory_gb': 0.7363967895507812, 'cpu_vms_mb': 10234.09375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 20:28:56 [INFO] [__main__:364] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 20:28:56 [INFO] [__main__:366] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 20:28:56 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 20:28:56 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 20:28:56 [INFO] [__main__:370] ================================================================================
2025-12-12 20:28:56 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 20:28:56 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:490] ================================================================================
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:491] Stage 5: Model Training Pipeline Started
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:492] ================================================================================
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:493] Model types: ['x3d']
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:494] K-fold splits: 5
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:495] Frames per video: 500
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:496] Output directory: data/stage5
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:497] Initializing pipeline...
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 20:28:56 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:333] ✓ x3d: CAN RUN
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:346]   ['x3d']
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:583] 
Stage 5: Loading metadata...
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:609] Loaded metadata: 3278 rows
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:619] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 20:28:58 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=833532.73GB, used=1666307.27GB (66.7%)
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:651] Stage 5: Found 3278 scaled videos
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:699] Enabling adaptive chunked frame loading for x3d: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:771] 
================================================================================
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:772] Stage 5: Training model: x3d
2025-12-12 20:28:58 [INFO] [lib.training.pipeline:773] ================================================================================
2025-12-12 20:28:59 [INFO] [lib.training.pipeline:797] Grid search: 16 hyperparameter combinations to try
2025-12-12 20:28:59 [INFO] [lib.training.pipeline:805] ================================================================================
2025-12-12 20:28:59 [INFO] [lib.training.pipeline:806] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 20:28:59 [INFO] [lib.training.pipeline:807] ================================================================================
2025-12-12 20:29:00 [INFO] [lib.training.pipeline:816] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:829] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 1/16
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:29:01 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:29:02 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:29:02 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:29:04 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:29:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2a48a13078884a98b4d8e7d80d6013d0 (experiment: x3d)
2025-12-12 20:29:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:29:25 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:29:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:29:30 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:29:30 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:29:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2a48a13078884a98b4d8e7d80d6013d0
2025-12-12 20:29:31 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:29:31 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:29:31 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:29:31 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:29:31 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:29:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 34e984e1e8004486981eae2e05891e61 (experiment: x3d)
2025-12-12 20:29:31 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:29:35 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:29:36 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:29:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:29:52 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:29:56 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:29:57 [WARNING] [lib.training.trainer:363] Skipping batch 2 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 146, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:03 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:09 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:14 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:30:15 [WARNING] [lib.training.trainer:363] Skipping batch 5 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:20 [WARNING] [lib.training.trainer:363] Skipping batch 6 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:25 [WARNING] [lib.training.trainer:363] Skipping batch 7 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 186, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:32 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:30:33 [WARNING] [lib.training.trainer:363] Skipping batch 8 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:38 [WARNING] [lib.training.trainer:363] Skipping batch 9 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:43 [WARNING] [lib.training.trainer:363] Skipping batch 10 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:48 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:30:49 [WARNING] [lib.training.trainer:363] Skipping batch 11 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:54 [WARNING] [lib.training.trainer:363] Skipping batch 12 due to input dimension mismatch: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 256, 140]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:30:59 [WARNING] [lib.training.trainer:363] Skipping batch 13 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:02 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:31:03 [WARNING] [lib.training.trainer:363] Skipping batch 14 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:09 [WARNING] [lib.training.trainer:363] Skipping batch 15 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:14 [WARNING] [lib.training.trainer:363] Skipping batch 16 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:18 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:31:18 [WARNING] [lib.training.trainer:363] Skipping batch 17 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:24 [WARNING] [lib.training.trainer:363] Skipping batch 18 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:34 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:31:35 [WARNING] [lib.training.trainer:363] Skipping batch 20 due to input dimension mismatch: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 256, 144]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:40 [WARNING] [lib.training.trainer:363] Skipping batch 21 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:45 [WARNING] [lib.training.trainer:363] Skipping batch 22 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:31:49 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:31:50 [WARNING] [lib.training.trainer:363] Skipping batch 23 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:01 [WARNING] [lib.training.trainer:363] Skipping batch 24 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:05 [WARNING] [lib.training.trainer:363] Skipping batch 25 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:09 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:32:11 [WARNING] [lib.training.trainer:363] Skipping batch 26 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 186, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:20 [WARNING] [lib.training.trainer:363] Skipping batch 27 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:25 [WARNING] [lib.training.trainer:363] Skipping batch 28 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:29 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:32:30 [WARNING] [lib.training.trainer:363] Skipping batch 29 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:38 [WARNING] [lib.training.trainer:363] Skipping batch 30 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:50 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:32:51 [WARNING] [lib.training.trainer:363] Skipping batch 32 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:32:59 [WARNING] [lib.training.trainer:363] Skipping batch 33 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:08 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:33:09 [WARNING] [lib.training.trainer:363] Skipping batch 35 due to input dimension mismatch: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 256, 138]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:15 [WARNING] [lib.training.trainer:363] Skipping batch 36 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:20 [WARNING] [lib.training.trainer:363] Skipping batch 37 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:24 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:33:25 [WARNING] [lib.training.trainer:363] Skipping batch 38 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:36 [WARNING] [lib.training.trainer:363] Skipping batch 39 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:41 [WARNING] [lib.training.trainer:363] Skipping batch 40 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 160, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:33:46 [WARNING] [lib.training.trainer:363] Skipping batch 41 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:51 [WARNING] [lib.training.trainer:363] Skipping batch 42 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:33:56 [WARNING] [lib.training.trainer:363] Skipping batch 43 due to input dimension mismatch: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 256, 144]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:34:00 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:34:02 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 44: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 48.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 149.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:34:02 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 44): {'cpu_memory_mb': 3908.05859375, 'cpu_memory_gb': 3.8164634704589844, 'cpu_vms_mb': 51015.046875, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.4626432, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.465698816}
2025-12-12 20:34:02 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 48.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 149.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:34:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:34:12 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 16.19 MiB is free. Including non-PyTorch memory, this process has 15.74 GiB memory in use. Of the allocated memory 15.28 GiB is allocated by PyTorch, and 87.36 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:34:12 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4799.96484375, 'cpu_memory_gb': 4.687465667724609, 'cpu_vms_mb': 51906.78125, 'gpu_allocated_gb': 16.376937472, 'gpu_reserved_gb': 16.496197632, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.432144384}
2025-12-12 20:34:12 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 16.19 MiB is free. Including non-PyTorch memory, this process has 15.74 GiB memory in use. Of the allocated memory 15.28 GiB is allocated by PyTorch, and 87.36 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:34:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:34:19 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:34:19 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:34:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 34e984e1e8004486981eae2e05891e61
2025-12-12 20:34:19 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:34:19 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:34:19 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:34:19 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:34:19 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:34:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 81407246a6dc46a78f0064bd8fd4d6cb (experiment: x3d)
2025-12-12 20:34:19 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:34:23 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:34:24 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:34:24 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:34:29 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:34:29 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:34:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 81407246a6dc46a78f0064bd8fd4d6cb
2025-12-12 20:34:29 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:34:29 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:34:29 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:34:29 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:34:30 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:34:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 571b4aa5d4bc4a8a9638ac23e5c0e5d8 (experiment: x3d)
2025-12-12 20:34:30 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:34:34 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:34:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:34:38 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:34:39 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:34:39 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:34:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 571b4aa5d4bc4a8a9638ac23e5c0e5d8
2025-12-12 20:34:39 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:34:39 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:34:39 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:34:39 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:34:40 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:34:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 609664a14c4e4b58b213300765f682dc (experiment: x3d)
2025-12-12 20:34:40 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:34:44 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:34:45 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:34:49 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:34:49 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:34:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 609664a14c4e4b58b213300765f682dc
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 2/16
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:34:50 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:34:50 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:34:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7883ffb196c54711919a321b3b1beb0c (experiment: x3d)
2025-12-12 20:34:50 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:34:54 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:34:55 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:34:55 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:35:00 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:35:00 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:35:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7883ffb196c54711919a321b3b1beb0c
2025-12-12 20:35:00 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:35:00 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:35:00 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:35:00 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:35:00 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:35:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ab57f48807643de93fecae450bc2beb (experiment: x3d)
2025-12-12 20:35:00 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:35:05 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:35:05 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:35:09 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:35:10 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:35:10 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:35:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ab57f48807643de93fecae450bc2beb
2025-12-12 20:35:10 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:35:10 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:35:10 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:35:10 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:35:10 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:35:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 06c47d5d027c47a88fea5f5697530c68 (experiment: x3d)
2025-12-12 20:35:11 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:35:15 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:35:15 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:35:25 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:35:40 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 3: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 48.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 149.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:35:40 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 3): {'cpu_memory_mb': 3909.27734375, 'cpu_memory_gb': 3.8176536560058594, 'cpu_vms_mb': 51015.046875, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.4626432, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.465698816}
2025-12-12 20:35:40 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 48.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 149.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 3, Current batch size: 1
2025-12-12 20:35:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:35:44 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:35:45 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:35:45 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:35:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 06c47d5d027c47a88fea5f5697530c68
2025-12-12 20:35:45 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:35:45 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:35:45 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:35:45 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:35:46 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:35:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2fb31fa4e32a4b9b8961892812d3f9eb (experiment: x3d)
2025-12-12 20:35:46 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:35:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:35:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:35:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:35:56 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:35:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2fb31fa4e32a4b9b8961892812d3f9eb
2025-12-12 20:35:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:35:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:35:56 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:35:56 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:35:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:35:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 984252d21d8f410582e42bacbbcc87df (experiment: x3d)
2025-12-12 20:35:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:36:01 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:36:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:36:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:08 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:36:09 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 3909.27734375, 'cpu_memory_gb': 3.8176536560058594, 'cpu_vms_mb': 51015.046875, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 20:36:09 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:36:09 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:36:14 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:36:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 984252d21d8f410582e42bacbbcc87df
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 3/16
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:36:14 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:36:14 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:36:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:36:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f7ea4a8c936041a88aa91ba16603625b (experiment: x3d)
2025-12-12 20:36:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:36:19 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:36:19 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:36:19 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:24 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:36:24 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:36:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f7ea4a8c936041a88aa91ba16603625b
2025-12-12 20:36:25 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:36:25 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:36:25 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:36:25 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:36:25 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:36:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 201e1c704d0d4b8dad78c1355c811b11 (experiment: x3d)
2025-12-12 20:36:25 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:36:30 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:36:30 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:33 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:36:35 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:36:35 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:36:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 201e1c704d0d4b8dad78c1355c811b11
2025-12-12 20:36:35 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:36:35 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:36:35 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:36:35 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:36:35 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:36:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 720955fe062a4432bd0bd26358e606a8 (experiment: x3d)
2025-12-12 20:36:35 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:36:40 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:36:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:45 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:36:45 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:36:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 720955fe062a4432bd0bd26358e606a8
2025-12-12 20:36:45 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:36:45 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:36:46 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:36:46 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:36:46 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:36:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 63ad44affccd49248d0ba134db9fd36d (experiment: x3d)
2025-12-12 20:36:46 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:36:50 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:36:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:36:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:36:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:36:56 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:36:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 63ad44affccd49248d0ba134db9fd36d
2025-12-12 20:36:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:36:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:36:57 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:36:57 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:36:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:36:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b2202a53253f47158f441464b63fe60f (experiment: x3d)
2025-12-12 20:36:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:37:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:37:07 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:37:08 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:37:08 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:37:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b2202a53253f47158f441464b63fe60f
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 4/16
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:37:08 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:37:08 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:37:09 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:37:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 67e18be0f5e64ea5b7d80af8889a038f (experiment: x3d)
2025-12-12 20:37:09 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:37:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:14 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:37:19 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:37:19 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:37:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 67e18be0f5e64ea5b7d80af8889a038f
2025-12-12 20:37:19 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:37:19 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:37:20 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:37:20 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:37:20 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:37:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 08b2d1d76d9f4623b8791d7456d9f4d2 (experiment: x3d)
2025-12-12 20:37:20 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:37:24 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:37:24 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:37:31 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:37:31 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:37:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 08b2d1d76d9f4623b8791d7456d9f4d2
2025-12-12 20:37:31 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:37:31 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:37:31 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:37:31 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:37:31 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:37:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e4c3d087a1f44a68b0b2043f68fc641d (experiment: x3d)
2025-12-12 20:37:32 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:37:36 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:37:42 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:37:43 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:37:43 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:37:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e4c3d087a1f44a68b0b2043f68fc641d
2025-12-12 20:37:44 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:37:44 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:37:44 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:37:44 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:37:44 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:37:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e6d7ea3078034b8493d6512f335c0660 (experiment: x3d)
2025-12-12 20:37:44 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:37:49 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:49 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:37:54 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:37:54 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:37:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e6d7ea3078034b8493d6512f335c0660
2025-12-12 20:37:54 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:37:54 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:37:54 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:37:54 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:37:55 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:37:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e9de82da4b1f43c9a1bc655bbda814f9 (experiment: x3d)
2025-12-12 20:37:55 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:37:59 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:37:59 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:37:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:38:04 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:38:04 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:38:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e9de82da4b1f43c9a1bc655bbda814f9
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 5/16
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:38:04 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:38:04 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:38:05 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:38:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c4400bb26f164b99aa4250afb8094092 (experiment: x3d)
2025-12-12 20:38:05 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:38:10 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:38:10 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:38:14 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:38:15 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:38:15 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:38:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c4400bb26f164b99aa4250afb8094092
2025-12-12 20:38:15 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:38:15 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:38:15 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:38:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:38:16 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:38:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 17f320033f764ac3a6ea57af94bebdb2 (experiment: x3d)
2025-12-12 20:38:16 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:38:20 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:38:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:38:26 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:38:26 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:38:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 17f320033f764ac3a6ea57af94bebdb2
2025-12-12 20:38:26 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:38:26 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:38:26 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:38:26 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:38:27 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:38:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 009926924168442eb7c0346483b85903 (experiment: x3d)
2025-12-12 20:38:27 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:38:31 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:38:31 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:38:31 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:38:36 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:38:36 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:38:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 009926924168442eb7c0346483b85903
2025-12-12 20:38:37 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:38:37 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:38:37 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:38:37 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:38:37 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:38:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 35f22cc7d39c414c97f9f0853b2f916d (experiment: x3d)
2025-12-12 20:38:37 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:38:42 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:38:42 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:38:47 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:38:48 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:38:48 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:38:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 35f22cc7d39c414c97f9f0853b2f916d
2025-12-12 20:38:48 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:38:48 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:38:49 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:38:49 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:38:49 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:38:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ba1026039c045a484a4809ca9cdab1a (experiment: x3d)
2025-12-12 20:38:49 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:38:54 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:38:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:39:16 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:39:17 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:39:23 [WARNING] [lib.training.trainer:363] Skipping batch 2 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:39:27 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:39:31 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:39:32 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 256, 144]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:39:38 [WARNING] [lib.training.trainer:363] Skipping batch 5 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:39:45 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 6: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:39:45 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 6): {'cpu_memory_mb': 3941.31640625, 'cpu_memory_gb': 3.8489418029785156, 'cpu_vms_mb': 51046.79296875, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.460546048, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.467795968}
2025-12-12 20:39:45 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:39:45 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:39:50 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:39:50 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:39:50 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:39:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6ba1026039c045a484a4809ca9cdab1a
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 6/16
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:39:51 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:39:51 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:39:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 14ad0a6cd45546bbbe34bc0fa2673295 (experiment: x3d)
2025-12-12 20:39:51 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:39:56 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:39:56 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:01 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:40:01 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:40:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 14ad0a6cd45546bbbe34bc0fa2673295
2025-12-12 20:40:01 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:40:01 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:40:01 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:40:01 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:40:02 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:40:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 27f8ba9fc4cb44589eff0244ced217e6 (experiment: x3d)
2025-12-12 20:40:02 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:40:05 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:40:06 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:40:06 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:11 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:40:11 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:40:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 27f8ba9fc4cb44589eff0244ced217e6
2025-12-12 20:40:11 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:40:11 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:40:11 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:40:11 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:40:11 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:40:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 422fcf9798a947fbbd36604e9a76dc71 (experiment: x3d)
2025-12-12 20:40:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:40:16 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:40:16 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:21 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:40:22 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:40:22 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:40:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 422fcf9798a947fbbd36604e9a76dc71
2025-12-12 20:40:23 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:40:23 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:40:23 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:40:23 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:40:23 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:40:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 95e62116cecc425891a18d66b9640195 (experiment: x3d)
2025-12-12 20:40:23 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:40:28 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:40:28 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:33 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:40:33 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:40:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 95e62116cecc425891a18d66b9640195
2025-12-12 20:40:33 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:40:33 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:40:33 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:40:33 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:40:34 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:40:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 716adadacc214c44877563872e5f80b7 (experiment: x3d)
2025-12-12 20:40:34 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:40:38 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:40:39 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:40:39 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:43 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:40:43 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:40:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 716adadacc214c44877563872e5f80b7
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 7/16
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:40:44 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:40:44 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:40:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8b5b59c9065c4a9585842504736b48a2 (experiment: x3d)
2025-12-12 20:40:44 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:40:49 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:40:49 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:40:57 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:40:58 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:40:58 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4543.62890625, 'cpu_memory_gb': 4.437137603759766, 'cpu_vms_mb': 51649.1015625, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 20:40:58 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 1, Current batch size: 1
2025-12-12 20:40:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:41:10 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:41:10 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:41:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8b5b59c9065c4a9585842504736b48a2
2025-12-12 20:41:10 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:41:10 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:41:11 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:41:11 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:41:11 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:41:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0a08e5c6dcf64f87b51467d1d17f2e70 (experiment: x3d)
2025-12-12 20:41:11 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:41:15 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:41:15 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:41:20 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:41:22 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:41:22 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4060.4296875, 'cpu_memory_gb': 3.9652633666992188, 'cpu_vms_mb': 51165.7734375, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 20:41:22 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:41:22 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:41:28 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:41:28 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:41:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0a08e5c6dcf64f87b51467d1d17f2e70
2025-12-12 20:41:28 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:41:28 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:41:28 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:41:28 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:41:29 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:41:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 135631ee3a084c9697b58166def08b90 (experiment: x3d)
2025-12-12 20:41:29 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:41:34 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:41:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:41:39 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:41:40 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:41:40 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:41:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 135631ee3a084c9697b58166def08b90
2025-12-12 20:41:40 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:41:40 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:41:41 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:41:41 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:41:41 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:41:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c682bc29a4f1458d8260f2264b8c705c (experiment: x3d)
2025-12-12 20:41:41 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:41:46 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:41:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:41:51 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:41:51 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:41:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c682bc29a4f1458d8260f2264b8c705c
2025-12-12 20:41:51 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:41:51 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:41:51 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:41:51 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:41:51 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:41:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1a44f6130b4f4c29ac72a5bbc460f590 (experiment: x3d)
2025-12-12 20:41:51 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:41:56 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:41:56 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:41:57 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:42:02 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:42:02 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4088.69140625, 'cpu_memory_gb': 3.9928627014160156, 'cpu_vms_mb': 51194.015625, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 20:42:02 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:42:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:42:08 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:42:08 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:42:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1a44f6130b4f4c29ac72a5bbc460f590
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 8/16
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:42:08 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:42:08 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:42:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c65cfb754fda44169e813fe7f25b3727 (experiment: x3d)
2025-12-12 20:42:08 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:42:12 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:42:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:42:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:42:18 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:42:18 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:42:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c65cfb754fda44169e813fe7f25b3727
2025-12-12 20:42:18 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:42:18 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:42:18 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:42:18 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:42:19 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:42:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 77041149948b4ae1a3d077c9771014cb (experiment: x3d)
2025-12-12 20:42:19 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:42:23 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:42:23 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:42:27 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:42:34 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:42:40 [WARNING] [lib.training.trainer:363] Skipping batch 2 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:42:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:42:46 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:42:52 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 4: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:42:52 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 4): {'cpu_memory_mb': 3910.08984375, 'cpu_memory_gb': 3.8184471130371094, 'cpu_vms_mb': 51015.046875, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.460546048, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.467795968}
2025-12-12 20:42:52 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:42:53 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:42:58 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:42:58 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:42:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 77041149948b4ae1a3d077c9771014cb
2025-12-12 20:42:58 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:42:58 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:42:58 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:42:58 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:42:58 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:42:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4bf34b4dd5fc46e7908b83fb2f433ce9 (experiment: x3d)
2025-12-12 20:42:58 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:43:02 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:43:03 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:43:03 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:08 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:43:08 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:43:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4bf34b4dd5fc46e7908b83fb2f433ce9
2025-12-12 20:43:09 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:43:09 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:43:09 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:43:09 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:43:09 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:43:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dea0d70282e7412f8e51f7bee951b10d (experiment: x3d)
2025-12-12 20:43:09 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:43:14 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:43:14 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:19 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:43:21 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:43:21 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:43:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dea0d70282e7412f8e51f7bee951b10d
2025-12-12 20:43:21 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:43:21 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:43:21 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:43:21 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:43:21 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:43:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 42f5e3d53b984cd392e7d56e4291f512 (experiment: x3d)
2025-12-12 20:43:21 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:43:26 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:43:26 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:31 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:43:31 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:43:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 42f5e3d53b984cd392e7d56e4291f512
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 9/16
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:43:32 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:43:32 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:43:33 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:43:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4f1460f1d64b482ebada0aa58f145c23 (experiment: x3d)
2025-12-12 20:43:33 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:43:37 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:43:37 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:43:38 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:42 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:43:42 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:43:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4f1460f1d64b482ebada0aa58f145c23
2025-12-12 20:43:43 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:43:43 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:43:43 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:43:43 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:43:43 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:43:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5e5cd0a156744ff7805bfae26879b398 (experiment: x3d)
2025-12-12 20:43:43 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:43:47 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:43:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:53 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:43:54 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 10.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 204.71 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:43:54 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 3910.0703125, 'cpu_memory_gb': 3.8184280395507812, 'cpu_vms_mb': 51015.046875, 'gpu_allocated_gb': 16.287824384, 'gpu_reserved_gb': 16.502489088, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.425852928}
2025-12-12 20:43:54 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 10.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 204.71 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:43:55 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:43:59 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:43:59 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5e5cd0a156744ff7805bfae26879b398
2025-12-12 20:44:00 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:44:00 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:00 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:00 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:00 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d5b5b58a695a48c491db0b7da52897f0 (experiment: x3d)
2025-12-12 20:44:00 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:44:05 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:44:05 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:44:10 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:44:12 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:44:12 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d5b5b58a695a48c491db0b7da52897f0
2025-12-12 20:44:12 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:44:12 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:12 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:12 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:12 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 066cd6c5a0b9447fad79ac259b7634ee (experiment: x3d)
2025-12-12 20:44:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:44:17 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:44:18 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:44:22 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:44:23 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 066cd6c5a0b9447fad79ac259b7634ee
2025-12-12 20:44:23 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:44:23 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:23 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:23 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:23 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2f205beef8814a099d57ccdb078de483 (experiment: x3d)
2025-12-12 20:44:23 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:44:27 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:44:28 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:44:28 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:44:34 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:44:34 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2f205beef8814a099d57ccdb078de483
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 10/16
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:35 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:35 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1f57d68bc78f4834ae58e7279a2bc2f9 (experiment: x3d)
2025-12-12 20:44:35 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:44:40 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:44:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:44:44 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:44:45 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:44:45 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1f57d68bc78f4834ae58e7279a2bc2f9
2025-12-12 20:44:46 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:44:46 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:46 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:46 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:46 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d67777c26492415581ad9758941399b6 (experiment: x3d)
2025-12-12 20:44:46 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:44:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:44:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:44:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:44:56 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:44:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d67777c26492415581ad9758941399b6
2025-12-12 20:44:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:44:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:44:57 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:44:57 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:44:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:44:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6dc74a2ecaa54f82b0aa7ace9711c8ed (experiment: x3d)
2025-12-12 20:44:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:45:01 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:45:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:45:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:45:07 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:45:07 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:45:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6dc74a2ecaa54f82b0aa7ace9711c8ed
2025-12-12 20:45:08 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:45:08 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:45:08 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:45:08 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:45:08 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:45:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 64465c91b2324cdfa47776ef744d597d (experiment: x3d)
2025-12-12 20:45:08 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:45:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:45:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:45:20 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:45:20 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:45:20 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:45:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 64465c91b2324cdfa47776ef744d597d
2025-12-12 20:45:21 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:45:21 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:45:21 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:45:21 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:45:21 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:45:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6a7d6f5966084a4091918ac645303866 (experiment: x3d)
2025-12-12 20:45:21 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:45:26 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:45:26 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:45:31 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:45:31 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:45:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6a7d6f5966084a4091918ac645303866
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 11/16
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:45:32 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:45:32 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:45:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ca2070dc64f4b279b7c2bc11bfad7df (experiment: x3d)
2025-12-12 20:45:32 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:45:36 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:45:37 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:45:37 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:45:43 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:45:43 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:45:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ca2070dc64f4b279b7c2bc11bfad7df
2025-12-12 20:45:43 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:45:43 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:45:44 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:45:44 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:45:44 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:45:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e893541041c24cb6954d660bc2fd64ec (experiment: x3d)
2025-12-12 20:45:44 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:45:48 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:45:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:45:55 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:45:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:45:56 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:45:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e893541041c24cb6954d660bc2fd64ec
2025-12-12 20:45:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:45:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:45:56 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:45:56 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:45:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:45:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 502e7be3fa104569af58ee75fcf526ff (experiment: x3d)
2025-12-12 20:45:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:46:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:07 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:46:07 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 502e7be3fa104569af58ee75fcf526ff
2025-12-12 20:46:07 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:46:07 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:07 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:07 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:08 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dda35ae8b223407d896d07c7e4df47ab (experiment: x3d)
2025-12-12 20:46:08 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:46:12 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:46:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:17 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:46:17 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dda35ae8b223407d896d07c7e4df47ab
2025-12-12 20:46:18 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:46:18 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:18 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:18 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:18 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e17727cd40b14880b99ce2fa6b1753db (experiment: x3d)
2025-12-12 20:46:18 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:46:23 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:23 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:27 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:46:28 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:46:28 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e17727cd40b14880b99ce2fa6b1753db
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 12/16
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:28 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:28 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:29 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0db99423c5154b95bc7f8a0e4477ca48 (experiment: x3d)
2025-12-12 20:46:29 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:46:34 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:39 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:46:39 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0db99423c5154b95bc7f8a0e4477ca48
2025-12-12 20:46:39 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:46:39 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:39 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:39 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:39 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c311e7d5e0b147df8b97180ac6460af2 (experiment: x3d)
2025-12-12 20:46:39 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:46:43 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:46:44 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:44 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:48 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:46:48 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c311e7d5e0b147df8b97180ac6460af2
2025-12-12 20:46:49 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:46:49 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:49 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:49 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:49 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26b3f08cb3454551935986d9c9a2b237 (experiment: x3d)
2025-12-12 20:46:49 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:46:54 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:46:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:46:58 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:46:59 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:46:59 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:46:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26b3f08cb3454551935986d9c9a2b237
2025-12-12 20:46:59 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:46:59 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:46:59 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:46:59 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:46:59 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:46:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0641f18efc23457a9662fb49624e4ced (experiment: x3d)
2025-12-12 20:46:59 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:47:04 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:47:04 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:47:11 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:47:11 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:47:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0641f18efc23457a9662fb49624e4ced
2025-12-12 20:47:11 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:47:11 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:47:11 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:47:11 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:47:12 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:47:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ba474f30e40444e8dbd5ba448a7d8cc (experiment: x3d)
2025-12-12 20:47:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:47:16 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:47:17 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:47:17 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:47:26 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:47:26 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:47:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ba474f30e40444e8dbd5ba448a7d8cc
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 13/16
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:47:26 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:47:27 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:47:27 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:47:27 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:47:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: debff122f94f43e3aa73c29c8e257927 (experiment: x3d)
2025-12-12 20:47:27 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:47:31 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:47:32 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:47:35 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:47:36 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:47:36 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:47:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: debff122f94f43e3aa73c29c8e257927
2025-12-12 20:47:37 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:47:37 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:47:37 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:47:37 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:47:37 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:47:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 44043bcfb88c4e1f8a44ea4af9526c24 (experiment: x3d)
2025-12-12 20:47:37 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:47:41 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:47:41 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:47:46 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:47:46 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:47:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 44043bcfb88c4e1f8a44ea4af9526c24
2025-12-12 20:47:47 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:47:47 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:47:47 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:47:47 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:47:47 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:47:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 98071fb2240b45f6bfca5c7f4dd2b52c (experiment: x3d)
2025-12-12 20:47:47 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:47:51 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:47:52 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:47:52 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:47:58 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:47:58 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 3909.09375, 'cpu_memory_gb': 3.817474365234375, 'cpu_vms_mb': 51014.046875, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 20:47:58 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 3, Current batch size: 1
2025-12-12 20:47:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:48:07 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:48:07 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:48:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 98071fb2240b45f6bfca5c7f4dd2b52c
2025-12-12 20:48:07 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:48:07 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:48:07 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:48:07 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:48:07 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:48:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b9deac8ff01e40e9beb960bfa2065481 (experiment: x3d)
2025-12-12 20:48:08 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:48:12 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:48:12 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:48:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:48:19 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:48:19 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:48:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b9deac8ff01e40e9beb960bfa2065481
2025-12-12 20:48:20 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:48:20 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:48:20 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:48:20 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:48:20 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:48:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fa93bbf980dc4f2dbcedfb678e46844d (experiment: x3d)
2025-12-12 20:48:20 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:48:25 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:48:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:48:29 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:48:37 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:48:43 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:48:43 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 4045.5859375, 'cpu_memory_gb': 3.9507675170898438, 'cpu_vms_mb': 51150.46484375, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.460546048, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.467795968}
2025-12-12 20:48:43 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:48:44 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:48:48 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:48:50 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:48:50 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4045.5859375, 'cpu_memory_gb': 3.9507675170898438, 'cpu_vms_mb': 51150.46484375, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 20:48:50 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:48:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:48:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:48:56 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:48:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fa93bbf980dc4f2dbcedfb678e46844d
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 14/16
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:48:57 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:48:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:48:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0cde647ef8bc4c14a09e22da91e7db3a (experiment: x3d)
2025-12-12 20:48:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:49:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:49:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:49:06 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:49:07 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:49:07 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:49:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0cde647ef8bc4c14a09e22da91e7db3a
2025-12-12 20:49:07 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:49:07 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:49:07 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:49:07 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:49:08 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:49:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 22e3e4761f5046edb073dcb11bffe6ea (experiment: x3d)
2025-12-12 20:49:08 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:49:12 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:49:12 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:49:28 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:49:29 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 20:49:38 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 30.19 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 167.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:49:39 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 4807.76953125, 'cpu_memory_gb': 4.695087432861328, 'cpu_vms_mb': 51912.0390625, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.481517568, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.446824448}
2025-12-12 20:49:39 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 30.19 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 167.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:49:39 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:49:44 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:49:44 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:49:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 22e3e4761f5046edb073dcb11bffe6ea
2025-12-12 20:49:45 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:49:45 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:49:45 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:49:45 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:49:45 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:49:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3be078bd53d144d1bcb47683c55a4dba (experiment: x3d)
2025-12-12 20:49:45 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:49:49 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:49:50 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:49:50 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:49:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:49:56 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:49:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3be078bd53d144d1bcb47683c55a4dba
2025-12-12 20:49:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:49:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:49:56 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:49:56 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:49:56 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:49:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0cfeb16eda7c43b19e88dded745efcf6 (experiment: x3d)
2025-12-12 20:49:56 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:50:01 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:50:01 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:50:10 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:50:11 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:50:11 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:50:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0cfeb16eda7c43b19e88dded745efcf6
2025-12-12 20:50:12 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:50:12 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:50:12 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:50:12 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:50:12 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:50:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3396722843d34ad8ab844fbf993813ca (experiment: x3d)
2025-12-12 20:50:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:50:17 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:50:17 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:50:25 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:50:25 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4816.54296875, 'cpu_memory_gb': 4.703655242919922, 'cpu_vms_mb': 51920.890625, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 20:50:25 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:50:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:50:29 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:50:30 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:50:30 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:50:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3396722843d34ad8ab844fbf993813ca
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 15/16
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:50:30 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:50:30 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:50:31 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:50:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f7ed21fedfc3409fa5064721ce91512b (experiment: x3d)
2025-12-12 20:50:31 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:50:35 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:50:35 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:50:41 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:50:41 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:50:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f7ed21fedfc3409fa5064721ce91512b
2025-12-12 20:50:41 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:50:41 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:50:41 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:50:41 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:50:42 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:50:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f71cae6ed6b5416aaddc165a393278d9 (experiment: x3d)
2025-12-12 20:50:42 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:50:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:50:46 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:50:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:50:52 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:50:52 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:50:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f71cae6ed6b5416aaddc165a393278d9
2025-12-12 20:50:52 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:50:52 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:50:52 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:50:52 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:50:52 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:50:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 20d004550f734fce927825f2223ba9a3 (experiment: x3d)
2025-12-12 20:50:52 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:50:57 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:50:57 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:51:01 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:51:03 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:51:03 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:51:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 20d004550f734fce927825f2223ba9a3
2025-12-12 20:51:03 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:51:03 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:51:03 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:51:03 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:51:04 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:51:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 682680178245497497976146abd25ad9 (experiment: x3d)
2025-12-12 20:51:04 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:51:09 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:51:09 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:51:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:51:14 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:51:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 682680178245497497976146abd25ad9
2025-12-12 20:51:14 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:51:14 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:51:14 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:51:14 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:51:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:51:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4d4ed63279754a87b529c02653f416ff (experiment: x3d)
2025-12-12 20:51:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:51:19 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:51:19 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:51:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:51:24 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:51:24 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:51:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4d4ed63279754a87b529c02653f416ff
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 16/16
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:51:25 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:51:25 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:51:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2c9b8429c3c24b5e8e962fac168bf1fe (experiment: x3d)
2025-12-12 20:51:25 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:51:30 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:51:30 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:51:37 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:51:38 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:51:38 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:51:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2c9b8429c3c24b5e8e962fac168bf1fe
2025-12-12 20:51:38 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:51:38 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:51:38 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:51:38 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:51:38 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:51:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a53beb8e8cae4525b27056691bb9d3bb (experiment: x3d)
2025-12-12 20:51:38 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:51:43 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:51:43 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:51:48 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:51:48 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:51:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a53beb8e8cae4525b27056691bb9d3bb
2025-12-12 20:51:48 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:51:48 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:51:48 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:51:48 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:51:48 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:51:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 22fab40daaab4fb4a4e7f00755b37984 (experiment: x3d)
2025-12-12 20:51:48 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:51:52 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:51:53 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:51:53 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:00 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:52:00 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 22fab40daaab4fb4a4e7f00755b37984
2025-12-12 20:52:00 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:52:00 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:52:01 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:01 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:01 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9cab88e399794418a472309f342e8116 (experiment: x3d)
2025-12-12 20:52:01 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:52:06 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:52:06 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:11 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:52:12 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:52:12 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9cab88e399794418a472309f342e8116
2025-12-12 20:52:13 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:52:13 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:52:13 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:13 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:13 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 75422e2a53814694a5226a937aeeb057 (experiment: x3d)
2025-12-12 20:52:13 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:52:18 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:52:18 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:26 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:52:26 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4675.6328125, 'cpu_memory_gb': 4.566047668457031, 'cpu_vms_mb': 51780.09375, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 20:52:26 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 20:52:26 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:30 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:52:31 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:52:31 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 75422e2a53814694a5226a937aeeb057
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1797] ================================================================================
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1798] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1799] ================================================================================
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1812] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1822] Final training using default hyperparameters (no grid search)
2025-12-12 20:52:31 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 1/5 (full dataset)
2025-12-12 20:52:32 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:32 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:32 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 254c79d803744415a5363ac3ea3edf7f (experiment: x3d)
2025-12-12 20:52:32 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 1 (full dataset)...
2025-12-12 20:52:32 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:36 [ERROR] [lib.training.pipeline:2200] Error training final fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:36 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 2/5 (full dataset)
2025-12-12 20:52:36 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:36 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:37 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7f469223faee4ccdbcc99139de44754b (experiment: x3d)
2025-12-12 20:52:37 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 2 (full dataset)...
2025-12-12 20:52:37 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:42 [ERROR] [lib.training.pipeline:2200] Error training final fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:42 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 3/5 (full dataset)
2025-12-12 20:52:42 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:42 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:42 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fd3ffbd168534d899b7130d22333c054 (experiment: x3d)
2025-12-12 20:52:42 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 3 (full dataset)...
2025-12-12 20:52:42 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:52 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:52:53 [ERROR] [lib.training.pipeline:2200] Error training final fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:53 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 4/5 (full dataset)
2025-12-12 20:52:53 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:53 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:53 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 950e9e4e990e4a879ea980f58310ec9a (experiment: x3d)
2025-12-12 20:52:53 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 4 (full dataset)...
2025-12-12 20:52:53 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:52:58 [ERROR] [lib.training.pipeline:2200] Error training final fold 4: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:52:58 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 5/5 (full dataset)
2025-12-12 20:52:59 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:52:59 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:52:59 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:52:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7384ccfe2ae4475784b73c13da7cdc99 (experiment: x3d)
2025-12-12 20:52:59 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 5 (full dataset)...
2025-12-12 20:52:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:53:04 [ERROR] [lib.training.pipeline:2200] Error training final fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:53:04 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/fold_1 to copy
2025-12-12 20:53:04 [INFO] [lib.training.pipeline:2273] 
x3d - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 20:53:05 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots/cv_fold_comparison.png
2025-12-12 20:53:05 [INFO] [lib.training.pipeline:2301] Generated plots for x3d in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots
2025-12-12 20:53:06 [INFO] [lib.training.pipeline:2338] ================================================================================
2025-12-12 20:53:06 [INFO] [lib.training.pipeline:2339] Stage 5: Model Training Pipeline Completed
2025-12-12 20:53:06 [INFO] [lib.training.pipeline:2340] ================================================================================
2025-12-12 20:53:06 [INFO] [__main__:401] ================================================================================
2025-12-12 20:53:06 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 20:53:06 [INFO] [__main__:403] ================================================================================
2025-12-12 20:53:06 [INFO] [__main__:404] Execution time: 1449.36 seconds (24.16 minutes)
2025-12-12 20:53:06 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 20:53:06 [INFO] [__main__:407] Models trained: ['x3d']
2025-12-12 20:53:06 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 20:53:06 [INFO] [__main__:414] ================================================================================
2025-12-12 20:53:06 [INFO] [__main__:415] Final memory statistics:
2025-12-12 20:53:06 [INFO] [__main__:416] ================================================================================
2025-12-12 20:53:06 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 5520.3203125, 'cpu_memory_gb': 5.390937805175781, 'cpu_vms_mb': 52656.88671875, 'gpu_allocated_gb': 0.01703936, 'gpu_reserved_gb': 0.375390208, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.552951808}
2025-12-12 20:53:06 [INFO] [__main__:419] ================================================================================
2025-12-12 20:53:06 [INFO] [__main__:420] Training complete!
2025-12-12 20:53:06 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 20:53:06 [INFO] [__main__:422] ================================================================================
