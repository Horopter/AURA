2025-12-10 13:41:02 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 750.28125, 'cpu_memory_gb': 0.732696533203125, 'cpu_vms_mb': 10236.9140625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-10 13:41:02 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-10 13:41:02 [DEBUG] [lib.utils.memory:96] Num threads: 5
2025-12-10 13:41:02 [INFO] [lib.training.pipeline:169] ================================================================================
2025-12-10 13:41:02 [INFO] [lib.training.pipeline:170] STAGE 5 PREREQUISITE VALIDATION
2025-12-10 13:41:02 [INFO] [lib.training.pipeline:171] ================================================================================
2025-12-10 13:41:02 [INFO] [lib.training.pipeline:174] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:183] ✓ Stage 3 metadata found: 3244 scaled videos
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:184]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:187] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-10 13:41:05 [WARNING] [lib.utils.paths:169] Metadata file is empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, trying other formats...
2025-12-10 13:41:05 [WARNING] [lib.utils.paths:178] No valid metadata file found for /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-10 13:41:05 [WARNING] [lib.training.pipeline:190] ✗ Stage 2 metadata not found or empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:199] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:207] ✓ Stage 4 metadata found: 3243 feature rows
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:208]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:211] 
================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:212] MODEL REQUIREMENTS CHECK
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:213] ================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:252] ✓ logistic_regression: CAN RUN
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:255] 
================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:256] VALIDATION SUMMARY
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:257] ================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:258] Stage 3 (scaled videos): ✓ Available
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:259]   Count: 3244 videos
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:260] Stage 2 (features): ✗ MISSING
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:261]   Count: 0 feature rows
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:262] Stage 4 (scaled features): ✓ Available
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:263]   Count: 3243 feature rows
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:264] 
Runnable models: 1/1
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:265]   ['logistic_regression']
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:272] ================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:450] 
Stage 5: Loading metadata...
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:460] Loaded metadata: 3244 rows
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:470] ✓ Data validation passed: 3244 rows (> 3000 required)
2025-12-10 13:41:05 [WARNING] [lib.utils.paths:169] Metadata file is empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, trying other formats...
2025-12-10 13:41:05 [WARNING] [lib.utils.paths:178] No valid metadata file found for /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-10 13:41:05 [DEBUG] [lib.training.pipeline:480] Stage 2 features metadata not found (optional for some models)
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:484] Stage 5: Found 3244 scaled videos
2025-12-10 13:41:05 [DEBUG] [lib.training.pipeline:514] Successfully imported VideoConfig from lib.models
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:579] 
================================================================================
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:580] Stage 5: Training model: logistic_regression
2025-12-10 13:41:05 [INFO] [lib.training.pipeline:581] ================================================================================
2025-12-10 13:41:18 [INFO] [lib.training.pipeline:618] Using 5-fold stratified cross-validation
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:627] Grid search: 40 hyperparameter combinations to try
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:639] 
================================================================================
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:640] Grid Search: Hyperparameter combination 1/40
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:641] Parameters: {'C': 0.01, 'penalty': 'l1', 'solver': 'liblinear', 'max_iter': 1000}
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:642] ================================================================================
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:653] 
Training logistic_regression - Fold 1/5
2025-12-10 13:41:34 [INFO] [lib.training.pipeline:1105] Training baseline model logistic_regression on fold 1...
2025-12-10 13:41:34 [INFO] [lib.training._linear:82] Extracting handcrafted features directly from 2594 videos...
2025-12-10 13:41:39 [DEBUG] [lib.features.handcrafted:33] ffprobe not found in PATH - codec cue extraction will be disabled
