2025-12-14 18:47:56 [INFO] [__main__:310] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-14 18:47:56 [INFO] [__main__:312] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-14 18:47:56 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-14 18:47:56 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-14 18:47:56 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-14 18:47:56 [INFO] [__main__:317] Model types: ['slowfast']
2025-12-14 18:47:56 [INFO] [__main__:318] K-fold splits: 5
2025-12-14 18:47:56 [INFO] [__main__:319] Number of frames: 500
2025-12-14 18:47:56 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 18:47:56 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-14 18:47:56 [INFO] [__main__:324] Delete existing: False
2025-12-14 18:47:56 [INFO] [__main__:325] Resume mode: True
2025-12-14 18:47:56 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765756076.log
2025-12-14 18:47:56 [INFO] [__main__:333] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:334] Checking prerequisites...
2025-12-14 18:47:56 [INFO] [__main__:335] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-14 18:47:56 [INFO] [__main__:352] ✓ All model types are valid
2025-12-14 18:47:56 [INFO] [__main__:358] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:359] Initial memory statistics:
2025-12-14 18:47:56 [INFO] [__main__:360] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.2421875, 'cpu_memory_gb': 0.7189865112304688, 'cpu_vms_mb': 10219.25390625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-14 18:47:56 [INFO] [__main__:364] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-14 18:47:56 [INFO] [__main__:366] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-14 18:47:56 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-14 18:47:56 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-14 18:47:56 [INFO] [__main__:370] ================================================================================
2025-12-14 18:47:56 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-14 18:47:56 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1398] Applied global PyTorch memory optimizations at pipeline start
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1401] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1402] Stage 5: Model Training Pipeline Started
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1403] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1404] Model types: ['slowfast']
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1405] K-fold splits: 5
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1406] Frames per video: 500
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1407] Output directory: data/stage5
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1408] Initializing pipeline...
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:261] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:262] STAGE 5 PREREQUISITE VALIDATION
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:263] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:266] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:275] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:276]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:279] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:287] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:288]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:291] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:299] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:300]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:303] 
================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:304] MODEL REQUIREMENTS CHECK
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:305] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:329] ✓ slowfast: CAN RUN
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:332] 
================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:333] VALIDATION SUMMARY
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:334] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:335] Stage 3 (scaled videos): ✓ Available
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:336]   Count: 3278 videos
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:337] Stage 2 (features): ✓ Available
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:338]   Count: 3278 feature rows
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:339] Stage 4 (scaled features): ✓ Available
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:340]   Count: 3277 feature rows
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:341] 
Runnable models: 1/1
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:342]   ['slowfast']
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:349] ================================================================================
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1492] 
Stage 5: Loading metadata...
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1518] Loaded metadata: 3278 rows
2025-12-14 18:47:56 [INFO] [lib.training.pipeline:1528] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-14 18:47:56 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=824688.54GB, used=1675151.46GB (67.0%)
2025-12-14 18:47:57 [INFO] [lib.training.pipeline:1560] Stage 5: Found 3278 scaled videos
2025-12-14 18:47:57 [INFO] [lib.training.pipeline:1565] ================================================================================
2025-12-14 18:47:57 [INFO] [lib.training.pipeline:1566] STAGE 5: VALIDATING VIDEOS (checking for corruption and empty videos)
2025-12-14 18:47:57 [INFO] [lib.training.pipeline:1567] ================================================================================
2025-12-14 18:47:57 [INFO] [lib.data.loading:156] Checking file existence for 3278 videos...
2025-12-14 18:47:59 [INFO] [lib.data.loading:166] Found 3278 existing video files (filtered out 0 missing files)
2025-12-14 18:47:59 [INFO] [lib.data.loading:170] Checking for corrupted videos (moov atom errors, etc.)...
2025-12-14 18:47:59 [INFO] [lib.data.loading:92] Loaded validation cache from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/.video_validation_cache/validation_0192be168a40eb7e_corruptTrue_framesTrue.parquet (3278 entries)
2025-12-14 18:47:59 [INFO] [lib.data.loading:194] Cache hit: 3278 videos, Cache miss: 0 videos
2025-12-14 18:47:59 [WARNING] [lib.data.loading:306] Filtered out 1 corrupted videos and 0 empty videos. Keeping 3277 valid videos.
2025-12-14 18:47:59 [WARNING] [lib.data.loading:311] Sample of invalid videos:
2025-12-14 18:47:59 [WARNING] [lib.data.loading:313]   data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: Corrupted video: moov atom not found
2025-12-14 18:47:59 [INFO] [lib.data.loading:323] Found /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/skip_frame_check.txt - skipping frame check as requested.
2025-12-14 18:47:59 [WARNING] [lib.data.loading:387] Filtered out 1 invalid videos (corrupted). Keeping 3277 valid videos.
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1579] ✓ Video validation complete: 3277 valid videos ready for training
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1580] ================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1661] Enabling adaptive chunked frame loading for slowfast: initial_chunk_size=5, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1676] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1812] 
================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1813] Stage 5: Training model: slowfast
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1814] ================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1854] Grid search: 1 hyperparameter combinations to try
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1867] ================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1868] HYPERPARAMETER SEARCH: Using 10.0% stratified sample for efficiency
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1869] ================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1879] Hyperparameter search sample: 327 rows (10.0% of 3277 total)
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1880] To change sample size, set FVC_GRID_SEARCH_SAMPLE_SIZE environment variable (current: 0.1)
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1893] Using 5-fold stratified cross-validation on 10.0% sample for hyperparameter search
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1906] 
================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1907] Grid Search: Hyperparameter combination 1/1
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1908] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1909] ================================================================================
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:1931] 
Hyperparameter Search - slowfast - Fold 1/5 (10.0% sample)
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 1...
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:47:59 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:47:59 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:47:59 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:48:02 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:48:02 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:48:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 210c9b956ddb405482d175ada7ab6359 (experiment: slowfast)
2025-12-14 18:48:08 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:48:10 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:48:12 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:48:13 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:48:13 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:48:13 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:48:27 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:48:27 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:48:27 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 1
2025-12-14 18:48:27 [ERROR] [lib.training.pipeline:2027] Error training fold 1: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1974, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:48:27 [INFO] [lib.training.pipeline:1931] 
Hyperparameter Search - slowfast - Fold 2/5 (10.0% sample)
2025-12-14 18:48:27 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 2...
2025-12-14 18:48:27 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:48:27 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:48:27 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:48:27 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:48:28 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:48:28 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:48:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 260a4e1e1a90476eae975391e9c709df (experiment: slowfast)
2025-12-14 18:48:28 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:48:30 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:48:31 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:48:31 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:48:31 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:48:32 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:48:44 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:48:44 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:48:44 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 2
2025-12-14 18:48:44 [ERROR] [lib.training.pipeline:2027] Error training fold 2: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1974, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:48:44 [INFO] [lib.training.pipeline:1931] 
Hyperparameter Search - slowfast - Fold 3/5 (10.0% sample)
2025-12-14 18:48:44 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 3...
2025-12-14 18:48:44 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:48:44 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:48:44 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:48:44 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:48:45 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:48:45 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:48:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e66c903f727746cf8ae7deb9804bc9fe (experiment: slowfast)
2025-12-14 18:48:45 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:48:47 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:48:48 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:48:48 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:48:48 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:48:48 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:48:57 [INFO] [lib.models.video:462] Chunk size increased from 10 to 20 (after 3 successes, increment: 10)
2025-12-14 18:49:00 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:01 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:01 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 3
2025-12-14 18:49:01 [ERROR] [lib.training.pipeline:2027] Error training fold 3: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1974, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:49:01 [INFO] [lib.training.pipeline:1931] 
Hyperparameter Search - slowfast - Fold 4/5 (10.0% sample)
2025-12-14 18:49:01 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 4...
2025-12-14 18:49:01 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:49:01 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:49:01 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:49:01 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:49:02 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:49:02 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:49:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: be4627341fa049fface3e987d15faf09 (experiment: slowfast)
2025-12-14 18:49:02 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:49:04 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:49:05 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:05 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:05 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:49:05 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:49:18 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:18 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:18 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 4
2025-12-14 18:49:18 [ERROR] [lib.training.pipeline:2027] Error training fold 4: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1974, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:49:18 [INFO] [lib.training.pipeline:1931] 
Hyperparameter Search - slowfast - Fold 5/5 (10.0% sample)
2025-12-14 18:49:18 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 5...
2025-12-14 18:49:18 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:49:18 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:49:18 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:49:18 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:49:19 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:49:19 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:49:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 84f228cb0d14492da37e92b90820c55e (experiment: slowfast)
2025-12-14 18:49:19 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:49:21 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:49:22 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:22 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:22 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:49:23 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:49:36 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:36 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:36 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 5
2025-12-14 18:49:36 [ERROR] [lib.training.pipeline:2027] Error training fold 5: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1974, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2083] Using single parameter combination: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2086] ================================================================================
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2087] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2088] ================================================================================
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2101] Final training: Using 5-fold stratified cross-validation on full dataset (3277 rows)
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2109] Final training using best hyperparameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:2115] 
Final Training - slowfast - Fold 1/5 (full dataset)
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 1...
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:49:36 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:49:36 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:49:36 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:49:37 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:49:37 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:49:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 815f55b00fcb464090711f24c91e5544 (experiment: slowfast)
2025-12-14 18:49:37 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:49:39 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:49:40 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:40 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:40 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:49:40 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:49:50 [INFO] [lib.models.video:462] Chunk size increased from 10 to 20 (after 3 successes, increment: 10)
2025-12-14 18:49:53 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:53 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:53 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 1
2025-12-14 18:49:53 [ERROR] [lib.training.pipeline:2208] Error training final fold 1: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2157, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:49:53 [INFO] [lib.training.pipeline:2115] 
Final Training - slowfast - Fold 2/5 (full dataset)
2025-12-14 18:49:53 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 2...
2025-12-14 18:49:53 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:49:53 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:49:53 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:49:53 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:49:54 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:49:54 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:49:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3667cbc085f848c8871dc353c28fc093 (experiment: slowfast)
2025-12-14 18:49:54 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:49:56 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:49:57 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:49:57 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:49:57 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:49:57 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:50:10 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:10 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:10 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 2
2025-12-14 18:50:10 [ERROR] [lib.training.pipeline:2208] Error training final fold 2: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2157, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:50:10 [INFO] [lib.training.pipeline:2115] 
Final Training - slowfast - Fold 3/5 (full dataset)
2025-12-14 18:50:10 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 3...
2025-12-14 18:50:10 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:50:10 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:50:10 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:50:10 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:50:11 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:50:11 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:50:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 91dba5cd54c74c74b8e874bbf8ed54ab (experiment: slowfast)
2025-12-14 18:50:11 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:50:13 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:50:14 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:14 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:14 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:50:14 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:50:27 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:27 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:27 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 3
2025-12-14 18:50:27 [ERROR] [lib.training.pipeline:2208] Error training final fold 3: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2157, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:50:27 [INFO] [lib.training.pipeline:2115] 
Final Training - slowfast - Fold 4/5 (full dataset)
2025-12-14 18:50:27 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 4...
2025-12-14 18:50:27 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:50:27 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:50:27 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:50:27 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:50:28 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:50:28 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:50:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cbd6a965d5cf412c96ba86b740a25d34 (experiment: slowfast)
2025-12-14 18:50:28 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:50:30 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:50:31 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:31 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:31 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:50:31 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:50:40 [INFO] [lib.models.video:462] Chunk size increased from 10 to 20 (after 3 successes, increment: 10)
2025-12-14 18:50:43 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:43 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:43 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 4
2025-12-14 18:50:43 [ERROR] [lib.training.pipeline:2208] Error training final fold 4: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2157, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:50:43 [INFO] [lib.training.pipeline:2115] 
Final Training - slowfast - Fold 5/5 (full dataset)
2025-12-14 18:50:43 [INFO] [lib.training.pipeline:631] Training PyTorch model slowfast on fold 5...
2025-12-14 18:50:43 [INFO] [lib.training.pipeline:666] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-14 18:50:43 [INFO] [lib.training.pipeline:714] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-14 18:50:43 [INFO] [lib.training.slowfast:394] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-14 18:50:43 [INFO] [lib.training.slowfast:192] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-14 18:50:44 [INFO] [lib.training.slowfast:203] ✓ Verified SlowFast model structure: Net
2025-12-14 18:50:44 [INFO] [lib.training.slowfast:211] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-14 18:50:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3b30fb25268049a48040ac368bd0bc5f (experiment: slowfast)
2025-12-14 18:50:44 [INFO] [lib.training.pipeline:788] Performing HYPER-AGGRESSIVE GC before training slowfast...
2025-12-14 18:50:46 [INFO] [lib.training.pipeline:800] Hyper-aggressive GC complete. GPU memory cleared.
2025-12-14 18:50:47 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:50:47 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:50:47 [WARNING] [lib.training.pipeline:876] SlowFast temporal dimension mismatch during forward pass test: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: torch.Size([1, 3, 500, 256, 256]). Training will handle this via error handling. Continuing...
2025-12-14 18:50:47 [INFO] [lib.training.trainer:380] Warmup will be handled in training loop (2 epochs)
2025-12-14 18:51:00 [WARNING] [lib.training.slowfast:572] SlowFast temporal dimension mismatch with T=500, alpha=8. Slow pathway T: 63, Fast pathway T: 500. Attempting to adjust input temporal dimension for compatibility...
2025-12-14 18:51:00 [ERROR] [lib.training.slowfast:599] SlowFast temporal dimension adjustment failed: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.. Original error: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Input shape: (N=1, C=3, T=500, H=256, W=256)
2025-12-14 18:51:01 [ERROR] [lib.training.pipeline:1018] Runtime error during training: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.. Model: slowfast, Fold: 5
2025-12-14 18:51:01 [ERROR] [lib.training.pipeline:2208] Error training final fold 5: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 596, in forward
    return self.backbone([slow_x_padded, fast_x_padded])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 64 but got size 128 for tensor number 1 in the list.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2157, in stage5_train_models
    result = _train_pytorch_model_fold(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 953, in _train_pytorch_model_fold
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 915, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 522, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 604, in forward
    raise e
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/slowfast.py", line 558, in forward
    return self.backbone([slow_x, fast_x])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 121, in forward
    x_out = self.multipathway_fusion(x_out)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/suzanef/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/slowfast.py", line 728, in forward
    x_s_fuse = torch.cat([x_s, fuse], 1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Sizes of tensors must match except in dimension 1. Expected size 63 but got size 125 for tensor number 1 in the list.
2025-12-14 18:51:01 [WARNING] [lib.training.pipeline:114] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/fold_1 to copy
2025-12-14 18:51:01 [INFO] [lib.training.pipeline:2281] 
slowfast - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-14 18:51:03 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots/cv_fold_comparison.png
2025-12-14 18:51:03 [INFO] [lib.training.pipeline:2309] Generated plots for slowfast in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots
2025-12-14 18:51:03 [INFO] [lib.training.pipeline:2346] ================================================================================
2025-12-14 18:51:03 [INFO] [lib.training.pipeline:2347] Stage 5: Model Training Pipeline Completed
2025-12-14 18:51:03 [INFO] [lib.training.pipeline:2348] ================================================================================
2025-12-14 18:51:03 [INFO] [__main__:401] ================================================================================
2025-12-14 18:51:03 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-14 18:51:03 [INFO] [__main__:403] ================================================================================
2025-12-14 18:51:03 [INFO] [__main__:404] Execution time: 187.30 seconds (3.12 minutes)
2025-12-14 18:51:03 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 18:51:03 [INFO] [__main__:407] Models trained: ['slowfast']
2025-12-14 18:51:03 [INFO] [__main__:408] K-fold splits: 5
2025-12-14 18:51:03 [INFO] [__main__:414] ================================================================================
2025-12-14 18:51:03 [INFO] [__main__:415] Final memory statistics:
2025-12-14 18:51:03 [INFO] [__main__:416] ================================================================================
2025-12-14 18:51:03 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 2403.546875, 'cpu_memory_gb': 2.3472137451171875, 'cpu_vms_mb': 49752.08203125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 1.379926016, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 15.548416}
2025-12-14 18:51:03 [INFO] [__main__:419] ================================================================================
2025-12-14 18:51:03 [INFO] [__main__:420] Training complete!
2025-12-14 18:51:03 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 18:51:03 [INFO] [__main__:422] ================================================================================
