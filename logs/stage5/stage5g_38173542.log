2025-12-13 19:02:26 [INFO] [__main__:310] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 19:02:26 [INFO] [__main__:312] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 19:02:26 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 19:02:26 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 19:02:26 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 19:02:26 [INFO] [__main__:317] Model types: ['xgboost_i3d']
2025-12-13 19:02:26 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 19:02:26 [INFO] [__main__:319] Number of frames: 1000
2025-12-13 19:02:26 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 19:02:26 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 19:02:26 [INFO] [__main__:324] Delete existing: False
2025-12-13 19:02:26 [INFO] [__main__:325] Resume mode: True
2025-12-13 19:02:26 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765670546.log
2025-12-13 19:02:26 [INFO] [__main__:333] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 19:02:26 [INFO] [__main__:335] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 19:02:26 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 19:02:26 [INFO] [__main__:358] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 19:02:26 [INFO] [__main__:360] ================================================================================
2025-12-13 19:02:26 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.46875, 'cpu_memory_gb': 0.718231201171875, 'cpu_vms_mb': 10218.62890625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 19:02:26 [INFO] [__main__:364] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 19:02:26 [INFO] [__main__:366] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 19:02:26 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 19:02:26 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 19:02:26 [INFO] [__main__:370] ================================================================================
2025-12-13 19:02:26 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 19:02:26 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:494] ================================================================================
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:495] Stage 5: Model Training Pipeline Started
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:497] Model types: ['xgboost_i3d']
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:498] K-fold splits: 5
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:499] Frames per video: 1000
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:500] Output directory: data/stage5
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:501] Initializing pipeline...
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:263] ================================================================================
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:264] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-13 19:02:26 [INFO] [lib.training.pipeline:268] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:277] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:278]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:281] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:289] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:290]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:293] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:301] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:302]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:305] 
================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:306] MODEL REQUIREMENTS CHECK
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:307] ================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:331] ✓ xgboost_i3d: CAN RUN
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:334] 
================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:335] VALIDATION SUMMARY
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:336] ================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:337] Stage 3 (scaled videos): ✓ Available
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:338]   Count: 3278 videos
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:339] Stage 2 (features): ✓ Available
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:340]   Count: 3278 feature rows
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:341] Stage 4 (scaled features): ✓ Available
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:342]   Count: 3277 feature rows
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:343] 
Runnable models: 1/1
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:344]   ['xgboost_i3d']
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:351] ================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:587] 
Stage 5: Loading metadata...
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:613] Loaded metadata: 3278 rows
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:623] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 19:02:28 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=828425.74GB, used=1671414.26GB (66.9%)
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:645] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:655] Stage 5: Found 3278 scaled videos
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:660] ================================================================================
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:661] STAGE 5: VALIDATING VIDEOS (checking for corruption and empty videos)
2025-12-13 19:02:28 [INFO] [lib.training.pipeline:662] ================================================================================
2025-12-13 19:02:28 [INFO] [lib.data.loading:151] Checking file existence for 3278 videos...
2025-12-13 19:02:32 [INFO] [lib.data.loading:161] Found 3278 existing video files (filtered out 0 missing files)
2025-12-13 19:02:32 [INFO] [lib.data.loading:165] Checking for corrupted videos (moov atom errors, etc.)...
2025-12-13 19:02:33 [INFO] [lib.data.loading:91] Loaded validation cache from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/.video_validation_cache/validation_0192be168a40eb7e_corruptTrue_framesTrue.parquet (3278 entries)
2025-12-13 19:02:33 [INFO] [lib.data.loading:189] Cache hit: 3278 videos, Cache miss: 0 videos
2025-12-13 19:02:33 [WARNING] [lib.data.loading:301] Filtered out 1 corrupted videos and 0 empty videos. Keeping 3277 valid videos.
2025-12-13 19:02:33 [WARNING] [lib.data.loading:306] Sample of invalid videos:
2025-12-13 19:02:33 [WARNING] [lib.data.loading:308]   data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: Corrupted video: moov atom not found
2025-12-13 19:02:33 [INFO] [lib.data.loading:319] Checking video frames (this may take a while and use memory)...
2025-12-13 20:13:07 [INFO] [lib.data.loading:355] ✓ All 3277 videos have frames
2025-12-13 20:13:07 [INFO] [lib.data.loading:356] Frame check complete.
2025-12-13 20:13:07 [WARNING] [lib.data.loading:367] Filtered out 1 invalid videos (corrupted or empty). Keeping 3277 valid videos.
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:674] ✓ Video validation complete: 3277 valid videos ready for training
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:675] ================================================================================
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:761] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:830] Overriding num_frames to 400 for xgboost_i3d (XGBoost pretrained model with enhanced features) to balance performance and memory. Original num_frames was 1000.
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:881] 
================================================================================
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:882] Stage 5: Training model: xgboost_i3d
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:883] ================================================================================
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:904] Overriding model_config num_frames to 400 for xgboost_i3d (XGBoost pretrained model with enhanced feature extraction) to improve feature quality.
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:923] Grid search: 1 hyperparameter combinations to try
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:937] ================================================================================
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:938] HYPERPARAMETER SEARCH: Using 10.0% stratified sample for efficiency
2025-12-13 20:13:07 [INFO] [lib.training.pipeline:939] ================================================================================
2025-12-13 20:13:08 [INFO] [lib.training.pipeline:949] Hyperparameter search sample: 327 rows (10.0% of 3277 total)
2025-12-13 20:13:08 [INFO] [lib.training.pipeline:950] To change sample size, set FVC_GRID_SEARCH_SAMPLE_SIZE environment variable (current: 0.1)
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:963] Using 5-fold stratified cross-validation on 10.0% sample for hyperparameter search
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:976] 
================================================================================
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:977] Grid Search: Hyperparameter combination 1/1
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:978] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:979] ================================================================================
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:1008] 
Hyperparameter Search - xgboost_i3d - Fold 1/5 (10.0% sample)
2025-12-13 20:13:09 [INFO] [lib.training.pipeline:1594] Training XGBoost model xgboost_i3d on fold 1...
2025-12-13 20:13:09 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 20:13:09 [INFO] [lib.training._xgboost_pretrained:618] Processing 261 videos...
2025-12-13 20:13:10 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:13:10 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:13:12 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:13:13 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:13:13 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:24:28 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-13 20:24:28 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:24:28 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 20:24:28 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 20:24:29 [INFO] [lib.training.feature_preprocessing:141] Removed 502 collinear features (correlation >= 0.95)
2025-12-13 20:24:29 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1930/2432 (79.4% retained)
2025-12-13 20:24:29 [INFO] [lib.training._xgboost_pretrained:648] Using 1930 features after collinearity removal
2025-12-13 20:24:29 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-13 20:24:29 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-13 20:24:29 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 20:24:33 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 85 (out of 200)
2025-12-13 20:24:33 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 20:24:34 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:24:34 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:24:34 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:24:34 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:24:34 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:27:29 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (66, 2432)
2025-12-13 20:27:30 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1644] Fold 1 - Val Loss: 0.5446, Val Acc: 0.7273, Val F1: 0.7353, Val Precision: 0.7353, Val Recall: 0.7353
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1648]   Class 0 - Precision: 0.7188, Recall: 0.7188, F1: 0.7188
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1652]   Class 1 - Precision: 0.7353, Recall: 0.7353, F1: 0.7353
2025-12-13 20:27:30 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_1
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1659] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_1
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1008] 
Hyperparameter Search - xgboost_i3d - Fold 2/5 (10.0% sample)
2025-12-13 20:27:30 [INFO] [lib.training.pipeline:1594] Training XGBoost model xgboost_i3d on fold 2...
2025-12-13 20:27:30 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 20:27:30 [INFO] [lib.training._xgboost_pretrained:618] Processing 261 videos...
2025-12-13 20:27:30 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:27:30 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:27:31 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:27:31 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:27:31 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:38:33 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 20:38:34 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 20:38:34 [INFO] [lib.training.feature_preprocessing:141] Removed 503 collinear features (correlation >= 0.95)
2025-12-13 20:38:34 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1929/2432 (79.3% retained)
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:648] Using 1929 features after collinearity removal
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-13 20:38:34 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 20:38:36 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 37 (out of 200)
2025-12-13 20:38:36 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 20:38:37 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:38:37 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:38:37 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:38:37 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:38:38 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:41:32 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (66, 2432)
2025-12-13 20:41:32 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:41:32 [INFO] [lib.training.pipeline:1644] Fold 2 - Val Loss: 0.5454, Val Acc: 0.7727, Val F1: 0.7692, Val Precision: 0.8065, Val Recall: 0.7353
2025-12-13 20:41:32 [INFO] [lib.training.pipeline:1648]   Class 0 - Precision: 0.7429, Recall: 0.8125, F1: 0.7761
2025-12-13 20:41:32 [INFO] [lib.training.pipeline:1652]   Class 1 - Precision: 0.8065, Recall: 0.7353, F1: 0.7692
2025-12-13 20:41:32 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_2
2025-12-13 20:41:32 [INFO] [lib.training.pipeline:1659] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_2
2025-12-13 20:41:33 [INFO] [lib.training.pipeline:1008] 
Hyperparameter Search - xgboost_i3d - Fold 3/5 (10.0% sample)
2025-12-13 20:41:33 [INFO] [lib.training.pipeline:1594] Training XGBoost model xgboost_i3d on fold 3...
2025-12-13 20:41:33 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 20:41:33 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 20:41:33 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:41:33 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:41:33 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:41:33 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:41:34 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:52:31 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 20:52:32 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 20:52:32 [INFO] [lib.training.feature_preprocessing:141] Removed 504 collinear features (correlation >= 0.95)
2025-12-13 20:52:32 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1928/2432 (79.3% retained)
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:648] Using 1928 features after collinearity removal
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 20:52:32 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 20:52:35 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 63 (out of 200)
2025-12-13 20:52:35 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 20:52:35 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:52:35 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:52:36 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:52:36 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:52:36 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 20:55:27 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-13 20:55:28 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1644] Fold 3 - Val Loss: 0.4768, Val Acc: 0.8462, Val F1: 0.8387, Val Precision: 0.8966, Val Recall: 0.7879
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1648]   Class 0 - Precision: 0.8056, Recall: 0.9062, F1: 0.8529
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1652]   Class 1 - Precision: 0.8966, Recall: 0.7879, F1: 0.8387
2025-12-13 20:55:28 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_3
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1659] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_3
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1008] 
Hyperparameter Search - xgboost_i3d - Fold 4/5 (10.0% sample)
2025-12-13 20:55:28 [INFO] [lib.training.pipeline:1594] Training XGBoost model xgboost_i3d on fold 4...
2025-12-13 20:55:28 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 20:55:28 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 20:55:28 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 20:55:28 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 20:55:29 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 20:55:29 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 20:55:29 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 21:06:35 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 21:06:35 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 21:06:36 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 21:06:36 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 21:06:36 [INFO] [lib.training.feature_preprocessing:141] Removed 504 collinear features (correlation >= 0.95)
2025-12-13 21:06:36 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1928/2432 (79.3% retained)
2025-12-13 21:06:36 [INFO] [lib.training._xgboost_pretrained:648] Using 1928 features after collinearity removal
2025-12-13 21:06:36 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 21:06:36 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 21:06:36 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 21:06:38 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 23 (out of 200)
2025-12-13 21:06:38 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 21:06:38 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 21:06:38 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 21:06:38 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 21:06:39 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 21:06:39 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 21:09:34 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-13 21:09:34 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 21:09:34 [INFO] [lib.training.pipeline:1644] Fold 4 - Val Loss: 0.6040, Val Acc: 0.6923, Val F1: 0.7059, Val Precision: 0.6857, Val Recall: 0.7273
2025-12-13 21:09:34 [INFO] [lib.training.pipeline:1648]   Class 0 - Precision: 0.7000, Recall: 0.6562, F1: 0.6774
2025-12-13 21:09:34 [INFO] [lib.training.pipeline:1652]   Class 1 - Precision: 0.6857, Recall: 0.7273, F1: 0.7059
2025-12-13 21:09:34 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_4
2025-12-13 21:09:34 [INFO] [lib.training.pipeline:1659] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_4
2025-12-13 21:09:35 [INFO] [lib.training.pipeline:1008] 
Hyperparameter Search - xgboost_i3d - Fold 5/5 (10.0% sample)
2025-12-13 21:09:35 [INFO] [lib.training.pipeline:1594] Training XGBoost model xgboost_i3d on fold 5...
2025-12-13 21:09:35 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 21:09:35 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 21:09:35 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 21:09:35 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 21:09:35 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 21:09:36 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 21:09:36 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 21:21:14 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 21:21:14 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 21:21:14 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 21:21:14 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 21:21:15 [INFO] [lib.training.feature_preprocessing:141] Removed 505 collinear features (correlation >= 0.95)
2025-12-13 21:21:15 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1927/2432 (79.2% retained)
2025-12-13 21:21:15 [INFO] [lib.training._xgboost_pretrained:648] Using 1927 features after collinearity removal
2025-12-13 21:21:15 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 21:21:15 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 21:21:15 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 21:21:17 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 49 (out of 200)
2025-12-13 21:21:17 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 21:21:18 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 21:21:18 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 21:21:18 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 21:21:18 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 21:21:18 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 21:23:50 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (65, 2432)
2025-12-13 21:23:51 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1644] Fold 5 - Val Loss: 0.5697, Val Acc: 0.7231, Val F1: 0.7000, Val Precision: 0.7778, Val Recall: 0.6364
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1648]   Class 0 - Precision: 0.6842, Recall: 0.8125, F1: 0.7429
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1652]   Class 1 - Precision: 0.7778, Recall: 0.6364, F1: 0.7000
2025-12-13 21:23:51 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_5
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1659] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_5
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1916] Parameter combination 1 - Mean F1: 0.7498, Mean Acc: 0.7523
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1928] Using single parameter combination: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1931] ================================================================================
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1932] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1933] ================================================================================
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1946] Final training: Using 5-fold stratified cross-validation on full dataset (3277 rows)
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1954] Final training using best hyperparameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 21:23:51 [INFO] [lib.training.pipeline:1960] 
Final Training - xgboost_i3d - Fold 1/5 (full dataset)
2025-12-13 21:23:51 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-13 21:23:51 [INFO] [lib.training._xgboost_pretrained:618] Processing 2621 videos...
2025-12-13 21:23:51 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 21:23:51 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 21:23:52 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 21:23:52 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 21:23:52 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 23:51:09 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2621, 2432)
2025-12-13 23:51:09 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-13 23:51:10 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 23:51:10 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-13 23:51:11 [INFO] [lib.training.feature_preprocessing:141] Removed 505 collinear features (correlation >= 0.95)
2025-12-13 23:51:11 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1927/2432 (79.2% retained)
2025-12-13 23:51:11 [INFO] [lib.training._xgboost_pretrained:648] Using 1927 features after collinearity removal
2025-12-13 23:51:11 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=1284, Class 1=1337, scale_pos_weight=0.960
2025-12-13 23:51:11 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 2096 train samples, 525 validation samples for early stopping
2025-12-13 23:51:11 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 23:51:53 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 200 (out of 200)
2025-12-13 23:51:53 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-13 23:51:54 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-13 23:51:54 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-13 23:51:54 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-13 23:51:55 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-13 23:51:55 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 00:20:29 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (656, 2432)
2025-12-14 00:20:30 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 00:20:30 [INFO] [lib.training.pipeline:2245] Fold 1 - Val Loss: 0.1550, Val Acc: 0.9665, Val F1: 0.9676, Val Precision: 0.9563, Val Recall: 0.9791
2025-12-14 00:20:30 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_1
2025-12-14 00:20:30 [INFO] [lib.training.pipeline:1960] 
Final Training - xgboost_i3d - Fold 2/5 (full dataset)
2025-12-14 00:20:30 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-14 00:20:30 [INFO] [lib.training._xgboost_pretrained:618] Processing 2621 videos...
2025-12-14 00:20:30 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 00:20:30 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 00:20:31 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 00:20:31 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 00:20:31 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 02:26:11 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2621, 2432)
2025-12-14 02:26:11 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 02:26:11 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-14 02:26:11 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-14 02:26:12 [INFO] [lib.training.feature_preprocessing:141] Removed 504 collinear features (correlation >= 0.95)
2025-12-14 02:26:12 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1928/2432 (79.3% retained)
2025-12-14 02:26:12 [INFO] [lib.training._xgboost_pretrained:648] Using 1928 features after collinearity removal
2025-12-14 02:26:12 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=1284, Class 1=1337, scale_pos_weight=0.960
2025-12-14 02:26:12 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 2096 train samples, 525 validation samples for early stopping
2025-12-14 02:26:12 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-14 02:26:55 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 200 (out of 200)
2025-12-14 02:26:55 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-14 02:26:55 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 02:26:55 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 02:26:56 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 02:26:56 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 02:26:57 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 02:57:20 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (656, 2432)
2025-12-14 02:57:20 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 02:57:20 [INFO] [lib.training.pipeline:2245] Fold 2 - Val Loss: 0.1502, Val Acc: 0.9649, Val F1: 0.9658, Val Precision: 0.9615, Val Recall: 0.9701
2025-12-14 02:57:20 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_2
2025-12-14 02:57:21 [INFO] [lib.training.pipeline:1960] 
Final Training - xgboost_i3d - Fold 3/5 (full dataset)
2025-12-14 02:57:21 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-14 02:57:21 [INFO] [lib.training._xgboost_pretrained:618] Processing 2622 videos...
2025-12-14 02:57:21 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 02:57:21 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 02:57:22 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 02:57:22 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 02:57:22 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 04:54:11 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-14 04:54:11 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 04:54:12 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-14 04:54:12 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-14 04:54:13 [INFO] [lib.training.feature_preprocessing:141] Removed 506 collinear features (correlation >= 0.95)
2025-12-14 04:54:13 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1926/2432 (79.2% retained)
2025-12-14 04:54:13 [INFO] [lib.training._xgboost_pretrained:648] Using 1926 features after collinearity removal
2025-12-14 04:54:13 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-14 04:54:13 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-14 04:54:13 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-14 04:54:55 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 200 (out of 200)
2025-12-14 04:54:55 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-14 04:54:55 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 04:54:55 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 04:54:56 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 04:54:56 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 04:54:56 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 05:24:42 [INFO] [lib.training.pipeline:2245] Fold 3 - Val Loss: 0.1669, Val Acc: 0.9573, Val F1: 0.9580, Val Precision: 0.9608, Val Recall: 0.9551
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_3
2025-12-14 05:24:42 [INFO] [lib.training.pipeline:1960] 
Final Training - xgboost_i3d - Fold 4/5 (full dataset)
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:618] Processing 2622 videos...
2025-12-14 05:24:42 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 05:24:42 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 05:24:43 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 05:24:43 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 05:24:43 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 07:20:57 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-14 07:20:58 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 07:20:58 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-14 07:20:58 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-14 07:20:59 [INFO] [lib.training.feature_preprocessing:141] Removed 504 collinear features (correlation >= 0.95)
2025-12-14 07:20:59 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1928/2432 (79.3% retained)
2025-12-14 07:20:59 [INFO] [lib.training._xgboost_pretrained:648] Using 1928 features after collinearity removal
2025-12-14 07:20:59 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-14 07:20:59 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-14 07:20:59 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-14 07:21:40 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 200 (out of 200)
2025-12-14 07:21:40 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-14 07:21:41 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 07:21:41 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 07:21:41 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 07:21:42 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 07:21:42 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 07:51:32 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-14 07:51:32 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 07:51:33 [INFO] [lib.training.pipeline:2245] Fold 4 - Val Loss: 0.1742, Val Acc: 0.9496, Val F1: 0.9504, Val Precision: 0.9547, Val Recall: 0.9461
2025-12-14 07:51:33 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_4
2025-12-14 07:51:33 [INFO] [lib.training.pipeline:1960] 
Final Training - xgboost_i3d - Fold 5/5 (full dataset)
2025-12-14 07:51:33 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from i3d...
2025-12-14 07:51:33 [INFO] [lib.training._xgboost_pretrained:618] Processing 2622 videos...
2025-12-14 07:51:33 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 07:51:33 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 07:51:34 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 07:51:34 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 07:51:34 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 09:48:55 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (2622, 2432)
2025-12-14 09:48:56 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 09:48:56 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-14 09:48:56 [INFO] [lib.training.feature_preprocessing:77] Removed 0 features with zero variance
2025-12-14 09:48:57 [INFO] [lib.training.feature_preprocessing:141] Removed 504 collinear features (correlation >= 0.95)
2025-12-14 09:48:57 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1928/2432 (79.3% retained)
2025-12-14 09:48:57 [INFO] [lib.training._xgboost_pretrained:648] Using 1928 features after collinearity removal
2025-12-14 09:48:57 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=1284, Class 1=1338, scale_pos_weight=0.960
2025-12-14 09:48:57 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 2097 train samples, 525 validation samples for early stopping
2025-12-14 09:48:57 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-14 09:49:39 [INFO] [lib.training._xgboost_pretrained:751] Early stopping: Best iteration = 200 (out of 200)
2025-12-14 09:49:39 [INFO] [lib.training._xgboost_pretrained:753] ✓ XGBoost trained on pretrained model features with enhanced feature extraction
2025-12-14 09:49:39 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: i3d (num_frames=400)
2025-12-14 09:49:39 [WARNING] [lib.training.i3d:45] torchvision I3D not available. Using fallback implementation.
2025-12-14 09:49:40 [INFO] [lib.training._xgboost_pretrained:537] Loaded i3d model to GPU, cleared cache
2025-12-14 09:49:40 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using i3d (num_frames=400)...
2025-12-14 09:49:40 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-14 10:18:24 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (655, 2432)
2025-12-14 10:18:24 [INFO] [lib.training._xgboost_pretrained:603] Cleared i3d model from GPU after feature extraction
2025-12-14 10:18:24 [INFO] [lib.training.pipeline:2245] Fold 5 - Val Loss: 0.1681, Val Acc: 0.9481, Val F1: 0.9500, Val Precision: 0.9335, Val Recall: 0.9671
2025-12-14 10:18:24 [INFO] [lib.training._xgboost_pretrained:821] Saved XGBoost model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/fold_5
2025-12-14 10:18:24 [INFO] [lib.training.pipeline:114] Saved best model from fold 1: Copied 2 model file(s) from fold_1 to best_model
2025-12-14 10:18:24 [INFO] [lib.training.pipeline:2407] 
xgboost_i3d - Avg Val Loss: 0.1629, Avg Val Acc: 0.9573, Avg Val F1: 0.9583
2025-12-14 10:18:28 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/plots/cv_fold_comparison.png
2025-12-14 10:18:28 [INFO] [lib.training.pipeline:2435] Generated plots for xgboost_i3d in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/xgboost_i3d/plots
2025-12-14 10:18:28 [INFO] [lib.training.pipeline:2472] ================================================================================
2025-12-14 10:18:28 [INFO] [lib.training.pipeline:2473] Stage 5: Model Training Pipeline Completed
2025-12-14 10:18:28 [INFO] [lib.training.pipeline:2474] ================================================================================
2025-12-14 10:18:28 [INFO] [__main__:401] ================================================================================
2025-12-14 10:18:28 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-14 10:18:28 [INFO] [__main__:403] ================================================================================
2025-12-14 10:18:28 [INFO] [__main__:404] Execution time: 54961.60 seconds (916.03 minutes)
2025-12-14 10:18:28 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 10:18:28 [INFO] [__main__:407] Models trained: ['xgboost_i3d']
2025-12-14 10:18:28 [INFO] [__main__:408] K-fold splits: 5
2025-12-14 10:18:28 [INFO] [__main__:414] ================================================================================
2025-12-14 10:18:28 [INFO] [__main__:415] Final memory statistics:
2025-12-14 10:18:28 [INFO] [__main__:416] ================================================================================
2025-12-14 10:18:28 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 12332.78515625, 'cpu_memory_gb': 12.04373550415039, 'cpu_vms_mb': 41364.29296875, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-14 10:18:28 [INFO] [__main__:419] ================================================================================
2025-12-14 10:18:28 [INFO] [__main__:420] Training complete!
2025-12-14 10:18:28 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 10:18:28 [INFO] [__main__:422] ================================================================================
