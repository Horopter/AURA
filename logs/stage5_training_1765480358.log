2025-12-11 14:12:39 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 772.6796875, 'cpu_memory_gb': 0.7545700073242188, 'cpu_vms_mb': 10258.14453125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-11 14:12:39 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 14:12:39 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-11 14:12:39 [INFO] [lib.training.stage5_feature_pipeline:63] Loading scaled metadata...
2025-12-11 14:12:39 [INFO] [lib.training.stage5_feature_pipeline:72] Loaded 3244 videos
2025-12-11 14:12:39 [INFO] [lib.training.stage5_feature_pipeline:86] Labels: [0, 1] -> {0: 0, 1: 1}
2025-12-11 14:12:39 [INFO] [lib.training.stage5_feature_pipeline:89] Loading features from Stage 2/4 (collinearity removal will be done once before splits)...
2025-12-11 14:12:39 [INFO] [lib.training.feature_preprocessing:316] Loading Stage 2 features...
2025-12-11 14:12:50 [INFO] [lib.training.feature_preprocessing:363] Loaded 15 Stage 2 features (3244/3244 videos matched)
2025-12-11 14:12:50 [INFO] [lib.training.feature_preprocessing:371] Loading Stage 4 features...
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:411] Sample unmatched Stage 4 videos (showing first 1): ['data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4']
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:412] Sample Stage 4 feature paths (showing first 3): ['data/scaled_videos/51EwLmqOYNg_aug4_scaled_aug4.mp4', 'data/scaled_videos/735177418030252033_aug0_scaled_aug0.mp4', 'data/scaled_videos/-y0Vr7JmCek_aug5_scaled_aug5.mp4']
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:416] Loaded 23 Stage 4 features (3243/3244 videos matched)
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:427] Combined 38 features from 2 stages
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:436] Stage 2: 3244 videos, Stage 4: 3243 videos
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:437] Intersection (videos with BOTH Stage 2 AND Stage 4): 3243 videos
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:458] ✓ Found 3243 videos with valid features (>= 3000 required)
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:152] Removing collinear features BEFORE data splits (to avoid data leakage)...
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:153]   Original feature count: 38
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:76] Removed 2 features with zero variance
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_noise_mean (correlation=0.992)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_mean (correlation=0.999)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.992)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.968)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.988)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_dct_dc_std (correlation=0.959)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_gradient_std (correlation=0.964)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage2_boundary_inconsistency (correlation=0.994)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_noise_energy (correlation=0.958)
2025-12-11 14:13:06 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: stage4_is_downscaled (correlation=-0.998)
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:138] Removed 10 collinear features (correlation >= 0.95)
2025-12-11 14:13:06 [INFO] [lib.training.feature_preprocessing:159] Final feature count: 26/38 (68.4% retained)
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:162]   Final feature count after collinearity removal: 26/38 (68.4% retained)
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:104] ✓ Loaded 26 features for 3244 videos
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:105]   Features already cleaned (collinearity removed before splits)
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:120] After filtering to videos with valid features: 3243/3244 videos
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:136] ✓ Sufficient videos with valid features: 3243 >= 3000
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:146] Feature-based models: ['logistic_regression']
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:147] Video-based models: []
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:153] ================================================================================
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:154] TRAINING FEATURE-BASED MODELS
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:155] ================================================================================
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:158] ================================================================================
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:159] Training logistic_regression (feature-based)
2025-12-11 14:13:06 [INFO] [lib.training.stage5_feature_pipeline:160] ================================================================================
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:214] Using GPU for logistic_regression
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:220] Training logistic_regression (architecture: mlp, input_dim: 26)
2025-12-11 14:13:06 [INFO] [lib.training.feature_training_pipeline:224] Creating 60-20-20 stratified train-val-test split...
2025-12-11 14:13:07 [INFO] [lib.training.feature_training_pipeline:232] Train: 1945, Val: 649, Test: 649
2025-12-11 14:13:07 [INFO] [lib.training.feature_training_pipeline:233] ✓ Features cleaned BEFORE splits: 26 features (collinearity already removed)
2025-12-11 14:13:07 [INFO] [lib.training.feature_training_pipeline:243] Hyperparameter search: 81 combinations
2025-12-11 14:13:07 [INFO] [lib.training.feature_training_pipeline:246] Grid search 1/81: {'dropout': 0.3, 'hidden_dims': [256, 128, 64], 'learning_rate': 0.0001, 'weight_decay': 1e-05}
2025-12-11 14:13:37 [ERROR] [lib.training.stage5_feature_pipeline:182] ✗ Failed to train logistic_regression: FeatureMLP.__init__() missing 1 required positional argument: 'input_dim'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/stage5_feature_pipeline.py", line 166, in stage5_train_all_models
    results = train_feature_model(
              ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/feature_training_pipeline.py", line 344, in train_feature_model
    best_model = type(model)(**{k: v for k, v in model_params.items()})
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: FeatureMLP.__init__() missing 1 required positional argument: 'input_dim'
2025-12-11 14:13:37 [INFO] [lib.training.stage5_feature_pipeline:282] ================================================================================
2025-12-11 14:13:37 [INFO] [lib.training.stage5_feature_pipeline:283] STAGE 5 TRAINING COMPLETE
2025-12-11 14:13:37 [INFO] [lib.training.stage5_feature_pipeline:284] ================================================================================
2025-12-11 14:13:37 [INFO] [lib.training.stage5_feature_pipeline:290] Successful: 0/1
2025-12-11 14:13:37 [INFO] [lib.training.stage5_feature_pipeline:291] Failed: 1/1
2025-12-11 14:13:37 [WARNING] [lib.training.stage5_feature_pipeline:303] Failed models:
2025-12-11 14:13:37 [WARNING] [lib.training.stage5_feature_pipeline:305]   logistic_regression: FeatureMLP.__init__() missing 1 required positional argument: 'input_dim'
2025-12-11 14:13:37 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: after training): {'cpu_memory_mb': 1224.16015625, 'cpu_memory_gb': 1.1954689025878906, 'cpu_vms_mb': 11553.68359375, 'gpu_allocated_gb': 0.018087936, 'gpu_reserved_gb': 0.025165824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.903176192}
2025-12-11 14:13:37 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 14:13:37 [DEBUG] [lib.utils.memory:96] Num threads: 7
