2025-12-12 22:45:26 [INFO] [__main__:310] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 22:45:26 [INFO] [__main__:312] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 22:45:26 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:45:26 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 22:45:26 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 22:45:26 [INFO] [__main__:317] Model types: ['slowfast']
2025-12-12 22:45:26 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 22:45:26 [INFO] [__main__:319] Number of frames: 500
2025-12-12 22:45:26 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:45:26 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 22:45:26 [INFO] [__main__:324] Delete existing: False
2025-12-12 22:45:26 [INFO] [__main__:325] Resume mode: True
2025-12-12 22:45:26 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765597526.log
2025-12-12 22:45:26 [INFO] [__main__:333] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 22:45:26 [INFO] [__main__:335] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:45:26 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 22:45:26 [INFO] [__main__:358] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 22:45:26 [INFO] [__main__:360] ================================================================================
2025-12-12 22:45:26 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.625, 'cpu_memory_gb': 0.7193603515625, 'cpu_vms_mb': 10218.25390625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 22:45:26 [INFO] [__main__:364] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 22:45:26 [INFO] [__main__:366] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 22:45:26 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 22:45:26 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 22:45:26 [INFO] [__main__:370] ================================================================================
2025-12-12 22:45:26 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 22:45:26 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:499] Model types: ['slowfast']
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:501] Frames per video: 500
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 22:45:26 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:333] ✓ slowfast: CAN RUN
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:346]   ['slowfast']
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 22:45:27 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=832002.86GB, used=1667837.14GB (66.7%)
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:705] Enabling adaptive chunked frame loading for slowfast: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:788] 
================================================================================
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:789] Stage 5: Training model: slowfast
2025-12-12 22:45:27 [INFO] [lib.training.pipeline:790] ================================================================================
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:823] Grid search: 32 hyperparameter combinations to try
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:831] ================================================================================
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:832] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:833] ================================================================================
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:842] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:855] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 1/32
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:45:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d08dea3d52984255924a820971dd9416 (experiment: slowfast)
2025-12-12 22:45:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:45:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:39 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d08dea3d52984255924a820971dd9416
2025-12-12 22:45:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:45:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6db533e53010405995e009a434f54418 (experiment: slowfast)
2025-12-12 22:45:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:45:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:41 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6db533e53010405995e009a434f54418
2025-12-12 22:45:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:45:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d61a81ba0a7c4ce8a4e74386130ada8f (experiment: slowfast)
2025-12-12 22:45:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:45:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:43 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d61a81ba0a7c4ce8a4e74386130ada8f
2025-12-12 22:45:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:45:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a10ca35aa9d04fae90200f338cee04a3 (experiment: slowfast)
2025-12-12 22:45:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:45:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:45 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a10ca35aa9d04fae90200f338cee04a3
2025-12-12 22:45:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:45:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e1fe87cfa4a7405e8de49c60fff4c8a5 (experiment: slowfast)
2025-12-12 22:45:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:45:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:47 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e1fe87cfa4a7405e8de49c60fff4c8a5
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 2/32
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:45:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 54cdf4e4db614d39937fba089ca876c7 (experiment: slowfast)
2025-12-12 22:45:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:45:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:49 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 54cdf4e4db614d39937fba089ca876c7
2025-12-12 22:45:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:45:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:45:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 99f89699ced749ec9e6453933daddf9b (experiment: slowfast)
2025-12-12 22:45:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:45:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:50 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 99f89699ced749ec9e6453933daddf9b
2025-12-12 22:45:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:45:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:45:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 46d5d273cd9945eeb244101381da77d5 (experiment: slowfast)
2025-12-12 22:45:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:45:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:52 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 46d5d273cd9945eeb244101381da77d5
2025-12-12 22:45:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:45:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:45:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cc7b6c503c01419d8e0fca4c8b6816bb (experiment: slowfast)
2025-12-12 22:45:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:45:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:55 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cc7b6c503c01419d8e0fca4c8b6816bb
2025-12-12 22:45:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:45:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:45:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fdd6a98a69484a278515786e75b4cc02 (experiment: slowfast)
2025-12-12 22:45:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:45:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:57 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fdd6a98a69484a278515786e75b4cc02
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 3/32
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:45:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:45:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b319dc2e3074692b92668cfcd0e5c70 (experiment: slowfast)
2025-12-12 22:45:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:45:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:45:59 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:45:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b319dc2e3074692b92668cfcd0e5c70
2025-12-12 22:45:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:45:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:45:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:45:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:45:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c7f9fbac24db42b7bb19c8986587114f (experiment: slowfast)
2025-12-12 22:46:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:00 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c7f9fbac24db42b7bb19c8986587114f
2025-12-12 22:46:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 690fc9c69d3549cb87010ff4bab13576 (experiment: slowfast)
2025-12-12 22:46:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:02 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 690fc9c69d3549cb87010ff4bab13576
2025-12-12 22:46:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d670ce9734c04718acb07f237c016b60 (experiment: slowfast)
2025-12-12 22:46:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:04 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d670ce9734c04718acb07f237c016b60
2025-12-12 22:46:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 689cc45759754141a62d49f93a35d891 (experiment: slowfast)
2025-12-12 22:46:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:06 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 689cc45759754141a62d49f93a35d891
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 4/32
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f7c37ad11bea4c7b89c55b80f64d6d17 (experiment: slowfast)
2025-12-12 22:46:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f7c37ad11bea4c7b89c55b80f64d6d17
2025-12-12 22:46:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 030aacbde0ef4b1ba420f7938aec97ba (experiment: slowfast)
2025-12-12 22:46:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:10 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 030aacbde0ef4b1ba420f7938aec97ba
2025-12-12 22:46:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c2914dd507644a778c7f1e183c945af0 (experiment: slowfast)
2025-12-12 22:46:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:12 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c2914dd507644a778c7f1e183c945af0
2025-12-12 22:46:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 248fd7b600e045f39fbbd932e16c75d9 (experiment: slowfast)
2025-12-12 22:46:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:14 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 248fd7b600e045f39fbbd932e16c75d9
2025-12-12 22:46:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b87a75cb87604517875e882a16b98254 (experiment: slowfast)
2025-12-12 22:46:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:16 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b87a75cb87604517875e882a16b98254
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 5/32
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9d512454f9c9499ea1d2d2a8f18c7cdb (experiment: slowfast)
2025-12-12 22:46:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:18 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9d512454f9c9499ea1d2d2a8f18c7cdb
2025-12-12 22:46:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8cc26fac483a4f2188c35f2b233ca4a8 (experiment: slowfast)
2025-12-12 22:46:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8cc26fac483a4f2188c35f2b233ca4a8
2025-12-12 22:46:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c69de22596df40f2980749f43045d8ae (experiment: slowfast)
2025-12-12 22:46:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c69de22596df40f2980749f43045d8ae
2025-12-12 22:46:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7d5668439f1c4d17b6cf3f2525701e59 (experiment: slowfast)
2025-12-12 22:46:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:23 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7d5668439f1c4d17b6cf3f2525701e59
2025-12-12 22:46:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6d0c123999d44ced8b4bf7cb3b234ca8 (experiment: slowfast)
2025-12-12 22:46:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:25 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6d0c123999d44ced8b4bf7cb3b234ca8
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 6/32
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7d002073ce8c4d0a907f1d5041b0b16b (experiment: slowfast)
2025-12-12 22:46:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:27 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7d002073ce8c4d0a907f1d5041b0b16b
2025-12-12 22:46:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 857eecf08623419cbc1489f79b075add (experiment: slowfast)
2025-12-12 22:46:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:29 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 857eecf08623419cbc1489f79b075add
2025-12-12 22:46:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bfb2095dade24fb4b15f8aa6ec27059e (experiment: slowfast)
2025-12-12 22:46:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:31 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bfb2095dade24fb4b15f8aa6ec27059e
2025-12-12 22:46:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0f02cd008a1b44aca822f02931cc3bab (experiment: slowfast)
2025-12-12 22:46:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:34 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0f02cd008a1b44aca822f02931cc3bab
2025-12-12 22:46:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 957cb6985ddc422c9f66f7ba753fa46a (experiment: slowfast)
2025-12-12 22:46:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:36 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 957cb6985ddc422c9f66f7ba753fa46a
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 7/32
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ef84a12a2b89493b927fd23b2ff097b8 (experiment: slowfast)
2025-12-12 22:46:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:38 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ef84a12a2b89493b927fd23b2ff097b8
2025-12-12 22:46:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e772cff24fee4c648764be26e469a8bf (experiment: slowfast)
2025-12-12 22:46:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:39 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e772cff24fee4c648764be26e469a8bf
2025-12-12 22:46:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 597d1061eda54d029c707bc1d8ef9567 (experiment: slowfast)
2025-12-12 22:46:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:41 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 597d1061eda54d029c707bc1d8ef9567
2025-12-12 22:46:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 32b08ddcb9424f6b909398aea96d5112 (experiment: slowfast)
2025-12-12 22:46:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:43 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 32b08ddcb9424f6b909398aea96d5112
2025-12-12 22:46:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8d23d4ef1cd247b89a384677133004c1 (experiment: slowfast)
2025-12-12 22:46:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:45 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8d23d4ef1cd247b89a384677133004c1
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 8/32
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 958bd73f93f544c3ab69bbf22438ae2f (experiment: slowfast)
2025-12-12 22:46:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:47 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 958bd73f93f544c3ab69bbf22438ae2f
2025-12-12 22:46:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6728e88772644307b9e4def5a0ed7d25 (experiment: slowfast)
2025-12-12 22:46:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:49 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6728e88772644307b9e4def5a0ed7d25
2025-12-12 22:46:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1440c80717764724bb1fec47da7a8fca (experiment: slowfast)
2025-12-12 22:46:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:46:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:51 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1440c80717764724bb1fec47da7a8fca
2025-12-12 22:46:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:46:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e32b448862ad4d8b86b6f26b99a0f6de (experiment: slowfast)
2025-12-12 22:46:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:46:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:53 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e32b448862ad4d8b86b6f26b99a0f6de
2025-12-12 22:46:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:46:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:46:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d23af8f381f24a43a6ccb425c8f698da (experiment: slowfast)
2025-12-12 22:46:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:46:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:55 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d23af8f381f24a43a6ccb425c8f698da
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 9/32
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ff779d9cdd60461b81734be0d9068cdb (experiment: slowfast)
2025-12-12 22:46:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:46:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:57 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ff779d9cdd60461b81734be0d9068cdb
2025-12-12 22:46:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:46:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 65855c36d64f4a5fb9a45d6f3c61929b (experiment: slowfast)
2025-12-12 22:46:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:46:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:46:58 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:46:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 65855c36d64f4a5fb9a45d6f3c61929b
2025-12-12 22:46:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:46:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:46:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:46:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:46:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:46:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:46:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: db026ec69e5d43bc8df1472f199de506 (experiment: slowfast)
2025-12-12 22:47:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:00 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: db026ec69e5d43bc8df1472f199de506
2025-12-12 22:47:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b1d914d8d5c472f969bda50715d3933 (experiment: slowfast)
2025-12-12 22:47:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:02 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b1d914d8d5c472f969bda50715d3933
2025-12-12 22:47:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9ec318dbf55e4a199bddd49de19603c8 (experiment: slowfast)
2025-12-12 22:47:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:04 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9ec318dbf55e4a199bddd49de19603c8
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 10/32
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c8dc5c7d558a4cf1805213f9ec7712ec (experiment: slowfast)
2025-12-12 22:47:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:06 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c8dc5c7d558a4cf1805213f9ec7712ec
2025-12-12 22:47:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 61b028daac484229ae01ccdeba87f8a4 (experiment: slowfast)
2025-12-12 22:47:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:08 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 61b028daac484229ae01ccdeba87f8a4
2025-12-12 22:47:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ba399842c17146db9ff8f8d854b62468 (experiment: slowfast)
2025-12-12 22:47:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:10 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ba399842c17146db9ff8f8d854b62468
2025-12-12 22:47:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1e7548b8aa6f41bd9f720c918ba9743b (experiment: slowfast)
2025-12-12 22:47:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:12 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1e7548b8aa6f41bd9f720c918ba9743b
2025-12-12 22:47:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 31138307da8e457ba45c46de494ad31e (experiment: slowfast)
2025-12-12 22:47:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:14 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 31138307da8e457ba45c46de494ad31e
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 11/32
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fee4d3211ba941cb8a0dbf43d655fc6d (experiment: slowfast)
2025-12-12 22:47:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:16 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fee4d3211ba941cb8a0dbf43d655fc6d
2025-12-12 22:47:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 606b369508634202b1949e8872e6f5ef (experiment: slowfast)
2025-12-12 22:47:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:17 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 606b369508634202b1949e8872e6f5ef
2025-12-12 22:47:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 617efb4e442c4baeb250403867427132 (experiment: slowfast)
2025-12-12 22:47:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:19 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 617efb4e442c4baeb250403867427132
2025-12-12 22:47:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 92cfc5a6f54b4a5997322f77ed25086b (experiment: slowfast)
2025-12-12 22:47:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:21 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 92cfc5a6f54b4a5997322f77ed25086b
2025-12-12 22:47:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ad28effa0ae4b68bbe6f8480161beda (experiment: slowfast)
2025-12-12 22:47:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:23 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6ad28effa0ae4b68bbe6f8480161beda
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 12/32
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eae6818efcbe4a41b7ddcbd721ced68d (experiment: slowfast)
2025-12-12 22:47:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:25 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eae6818efcbe4a41b7ddcbd721ced68d
2025-12-12 22:47:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 50124766fcca4778bbb0ad40aa65b5b3 (experiment: slowfast)
2025-12-12 22:47:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:27 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 50124766fcca4778bbb0ad40aa65b5b3
2025-12-12 22:47:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 44b9ff25590b4e8fa1f8b251aa8b95ad (experiment: slowfast)
2025-12-12 22:47:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:29 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 44b9ff25590b4e8fa1f8b251aa8b95ad
2025-12-12 22:47:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 96a0ecd9a6c143b486b81b10de660add (experiment: slowfast)
2025-12-12 22:47:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:31 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 96a0ecd9a6c143b486b81b10de660add
2025-12-12 22:47:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 53dad72d5f2547b49d443e970315f686 (experiment: slowfast)
2025-12-12 22:47:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:33 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 53dad72d5f2547b49d443e970315f686
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 13/32
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 17cd2bc024be43e1b281474be330db77 (experiment: slowfast)
2025-12-12 22:47:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:35 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 17cd2bc024be43e1b281474be330db77
2025-12-12 22:47:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 28e80cf75a9a4d73a2821f181281a6aa (experiment: slowfast)
2025-12-12 22:47:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 28e80cf75a9a4d73a2821f181281a6aa
2025-12-12 22:47:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 23e05ebd8ae84507bf0f56a0dbd906f5 (experiment: slowfast)
2025-12-12 22:47:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 23e05ebd8ae84507bf0f56a0dbd906f5
2025-12-12 22:47:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ade39adc601f406fba74a462313bc758 (experiment: slowfast)
2025-12-12 22:47:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ade39adc601f406fba74a462313bc758
2025-12-12 22:47:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8e33c11c3ffc4528941f0b2e6761d00b (experiment: slowfast)
2025-12-12 22:47:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8e33c11c3ffc4528941f0b2e6761d00b
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 14/32
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4f9308834f64408d96af406cc6173f73 (experiment: slowfast)
2025-12-12 22:47:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:44 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4f9308834f64408d96af406cc6173f73
2025-12-12 22:47:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 464bed8e98df45f9af14fb28e4a09b94 (experiment: slowfast)
2025-12-12 22:47:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:46 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 464bed8e98df45f9af14fb28e4a09b94
2025-12-12 22:47:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d3e667c5b4af4364801d930a49eb4a9d (experiment: slowfast)
2025-12-12 22:47:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:48 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d3e667c5b4af4364801d930a49eb4a9d
2025-12-12 22:47:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1278e144779b40238937d053f16f7f2e (experiment: slowfast)
2025-12-12 22:47:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:50 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1278e144779b40238937d053f16f7f2e
2025-12-12 22:47:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:47:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:47:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 67e0b8c4df794ce799776dcdb24de86c (experiment: slowfast)
2025-12-12 22:47:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:47:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:52 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 67e0b8c4df794ce799776dcdb24de86c
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 15/32
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:47:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 430b17fde8dd4e3c92ac0303803cfdff (experiment: slowfast)
2025-12-12 22:47:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:47:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:54 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 430b17fde8dd4e3c92ac0303803cfdff
2025-12-12 22:47:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:47:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6c17363777f04dcab7b666674c2f9841 (experiment: slowfast)
2025-12-12 22:47:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:47:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:55 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6c17363777f04dcab7b666674c2f9841
2025-12-12 22:47:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:47:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 69da83f0be114baca8f23040f1549708 (experiment: slowfast)
2025-12-12 22:47:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:47:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:57 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 69da83f0be114baca8f23040f1549708
2025-12-12 22:47:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:47:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:47:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:47:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:47:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:47:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:47:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 42b0c907ac064dc3b2afc909110d43be (experiment: slowfast)
2025-12-12 22:47:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:47:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:47:59 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:47:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 42b0c907ac064dc3b2afc909110d43be
2025-12-12 22:48:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 35ec0bc021744c3aa6d7d5242ca416ce (experiment: slowfast)
2025-12-12 22:48:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:01 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 35ec0bc021744c3aa6d7d5242ca416ce
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 16/32
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 910a29366c4f403fb0d7a813c16af402 (experiment: slowfast)
2025-12-12 22:48:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:03 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 910a29366c4f403fb0d7a813c16af402
2025-12-12 22:48:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d07b2beb014f49b3a93994f3abde5e74 (experiment: slowfast)
2025-12-12 22:48:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:05 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d07b2beb014f49b3a93994f3abde5e74
2025-12-12 22:48:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3319d917600d479cb3ba2d0b132f20a6 (experiment: slowfast)
2025-12-12 22:48:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:07 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3319d917600d479cb3ba2d0b132f20a6
2025-12-12 22:48:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0ca687d60f734d2cb1662af901e43f70 (experiment: slowfast)
2025-12-12 22:48:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:09 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0ca687d60f734d2cb1662af901e43f70
2025-12-12 22:48:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8db8b2518f1d468b8a4d6207292097e2 (experiment: slowfast)
2025-12-12 22:48:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:11 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8db8b2518f1d468b8a4d6207292097e2
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 17/32
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c215d95407a54a8e88faba4cf0d5668c (experiment: slowfast)
2025-12-12 22:48:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:13 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c215d95407a54a8e88faba4cf0d5668c
2025-12-12 22:48:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a4ca0a0a080541af8f8596bfc39c97d5 (experiment: slowfast)
2025-12-12 22:48:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:14 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a4ca0a0a080541af8f8596bfc39c97d5
2025-12-12 22:48:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 01ab328e3f8a4568a11dc303cd59138d (experiment: slowfast)
2025-12-12 22:48:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:16 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 01ab328e3f8a4568a11dc303cd59138d
2025-12-12 22:48:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d1ca1a4493e243a5b92f4ffc9fec28bf (experiment: slowfast)
2025-12-12 22:48:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:19 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d1ca1a4493e243a5b92f4ffc9fec28bf
2025-12-12 22:48:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aeecb27384e14d0180790a9ec4c0219d (experiment: slowfast)
2025-12-12 22:48:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:21 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aeecb27384e14d0180790a9ec4c0219d
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 18/32
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cce17f9f05b2458a90c1f033525e168d (experiment: slowfast)
2025-12-12 22:48:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:23 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cce17f9f05b2458a90c1f033525e168d
2025-12-12 22:48:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c151d1c00f854bfbbac9a99820be614b (experiment: slowfast)
2025-12-12 22:48:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:24 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c151d1c00f854bfbbac9a99820be614b
2025-12-12 22:48:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a48ba936747c43b686da008827483d94 (experiment: slowfast)
2025-12-12 22:48:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:26 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a48ba936747c43b686da008827483d94
2025-12-12 22:48:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5b1f86ca409b4ab28ef88e5165ca5fc6 (experiment: slowfast)
2025-12-12 22:48:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:28 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5b1f86ca409b4ab28ef88e5165ca5fc6
2025-12-12 22:48:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 776afea4ba2949458f01a4126b46cde8 (experiment: slowfast)
2025-12-12 22:48:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:30 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 776afea4ba2949458f01a4126b46cde8
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 19/32
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5172bd6a4b914a5aa303be7005bc1d96 (experiment: slowfast)
2025-12-12 22:48:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:33 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5172bd6a4b914a5aa303be7005bc1d96
2025-12-12 22:48:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ea79bfd83aa427b8b47935832f229c1 (experiment: slowfast)
2025-12-12 22:48:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:34 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6ea79bfd83aa427b8b47935832f229c1
2025-12-12 22:48:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cfd4937a92b64c63868847cdc3f5277b (experiment: slowfast)
2025-12-12 22:48:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:36 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cfd4937a92b64c63868847cdc3f5277b
2025-12-12 22:48:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c7ac002076334d8f92e0a5a0789b05f0 (experiment: slowfast)
2025-12-12 22:48:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:38 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c7ac002076334d8f92e0a5a0789b05f0
2025-12-12 22:48:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 17ed0e4b89e648aaafcb2dfa1a603e61 (experiment: slowfast)
2025-12-12 22:48:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:40 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 17ed0e4b89e648aaafcb2dfa1a603e61
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 20/32
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: df79c55c7a8f4d6c95f5214d123aa7ad (experiment: slowfast)
2025-12-12 22:48:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:42 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: df79c55c7a8f4d6c95f5214d123aa7ad
2025-12-12 22:48:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3939e9776f084837901ed1c518477da9 (experiment: slowfast)
2025-12-12 22:48:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:43 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3939e9776f084837901ed1c518477da9
2025-12-12 22:48:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: be9a94c20ad440ac8003dae9f3624b53 (experiment: slowfast)
2025-12-12 22:48:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:45 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: be9a94c20ad440ac8003dae9f3624b53
2025-12-12 22:48:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3a44f4ed87f6427b88327e9a28897c48 (experiment: slowfast)
2025-12-12 22:48:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:48 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3a44f4ed87f6427b88327e9a28897c48
2025-12-12 22:48:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:48:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bd09f3b5f7904cad887db06575b49f8d (experiment: slowfast)
2025-12-12 22:48:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:50 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bd09f3b5f7904cad887db06575b49f8d
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 21/32
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93d88417ed8047ed8e25907de086385a (experiment: slowfast)
2025-12-12 22:48:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:48:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:52 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93d88417ed8047ed8e25907de086385a
2025-12-12 22:48:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:48:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 957fd567e522409b8c43f0d8610cc0ee (experiment: slowfast)
2025-12-12 22:48:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:48:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:53 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 957fd567e522409b8c43f0d8610cc0ee
2025-12-12 22:48:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:48:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f7ea249b7eab4b41bd3b24a3e64773ea (experiment: slowfast)
2025-12-12 22:48:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:48:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:55 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f7ea249b7eab4b41bd3b24a3e64773ea
2025-12-12 22:48:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:48:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 47acb7d663c94418a2d93c363b399d84 (experiment: slowfast)
2025-12-12 22:48:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:48:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:57 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 47acb7d663c94418a2d93c363b399d84
2025-12-12 22:48:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:48:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:48:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:48:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:48:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:48:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:48:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 323ff1a8e4b446fc8bf05c5305219d67 (experiment: slowfast)
2025-12-12 22:48:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:48:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:48:59 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:48:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 323ff1a8e4b446fc8bf05c5305219d67
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 22/32
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2839971c5fcd414da5c3119255ff6376 (experiment: slowfast)
2025-12-12 22:49:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:01 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2839971c5fcd414da5c3119255ff6376
2025-12-12 22:49:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a2b83fafaeb14871957e3ecb8ea3fc70 (experiment: slowfast)
2025-12-12 22:49:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:03 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a2b83fafaeb14871957e3ecb8ea3fc70
2025-12-12 22:49:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 95a79f884a8c45849d4a2aa1a09a28b1 (experiment: slowfast)
2025-12-12 22:49:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:05 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 95a79f884a8c45849d4a2aa1a09a28b1
2025-12-12 22:49:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 24e1e6790b86424bb3da2403d46bf339 (experiment: slowfast)
2025-12-12 22:49:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:07 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 24e1e6790b86424bb3da2403d46bf339
2025-12-12 22:49:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 91a6a0116d5f4e46b8b6b89e0003c0a7 (experiment: slowfast)
2025-12-12 22:49:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:09 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 91a6a0116d5f4e46b8b6b89e0003c0a7
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 23/32
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bf2fa8c5196d4e39802999d488fb1749 (experiment: slowfast)
2025-12-12 22:49:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:11 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bf2fa8c5196d4e39802999d488fb1749
2025-12-12 22:49:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ba24108ba3084d8c924387deec7eb1bf (experiment: slowfast)
2025-12-12 22:49:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:12 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ba24108ba3084d8c924387deec7eb1bf
2025-12-12 22:49:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 87002c29dd3844bba0a398ae1d8dbd99 (experiment: slowfast)
2025-12-12 22:49:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:14 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 87002c29dd3844bba0a398ae1d8dbd99
2025-12-12 22:49:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6c85cced8cae4597b25b81b15e135c1d (experiment: slowfast)
2025-12-12 22:49:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:16 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6c85cced8cae4597b25b81b15e135c1d
2025-12-12 22:49:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0685ff1b3d0a4ce691076960b6a90be4 (experiment: slowfast)
2025-12-12 22:49:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:18 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0685ff1b3d0a4ce691076960b6a90be4
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 24/32
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8497da249edf4135ad84cb4933373ec7 (experiment: slowfast)
2025-12-12 22:49:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:20 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8497da249edf4135ad84cb4933373ec7
2025-12-12 22:49:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 45a7d4538c8d400d9eb7f7ef6da69485 (experiment: slowfast)
2025-12-12 22:49:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:22 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 45a7d4538c8d400d9eb7f7ef6da69485
2025-12-12 22:49:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4737be30c1574df5bbfbbdc4e302b053 (experiment: slowfast)
2025-12-12 22:49:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:23 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4737be30c1574df5bbfbbdc4e302b053
2025-12-12 22:49:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bce8eeed2a154fe6bbd55162c8deb054 (experiment: slowfast)
2025-12-12 22:49:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:26 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bce8eeed2a154fe6bbd55162c8deb054
2025-12-12 22:49:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ac694be0fa354eb9a39291c0b877658a (experiment: slowfast)
2025-12-12 22:49:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:28 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ac694be0fa354eb9a39291c0b877658a
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 25/32
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1e7b9edd75584d4c896730750c1ce321 (experiment: slowfast)
2025-12-12 22:49:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:30 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1e7b9edd75584d4c896730750c1ce321
2025-12-12 22:49:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4d0b48b46f884e4eaa25fbdb4368573b (experiment: slowfast)
2025-12-12 22:49:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:31 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4d0b48b46f884e4eaa25fbdb4368573b
2025-12-12 22:49:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 67cfbd7a143c4fc3ace77e163fa9ecd4 (experiment: slowfast)
2025-12-12 22:49:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:33 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 67cfbd7a143c4fc3ace77e163fa9ecd4
2025-12-12 22:49:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0bbfaee1f05c4ca2867b570166fc0b5a (experiment: slowfast)
2025-12-12 22:49:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:35 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0bbfaee1f05c4ca2867b570166fc0b5a
2025-12-12 22:49:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9f7895d6a6e1495692b9ae688ad0aad5 (experiment: slowfast)
2025-12-12 22:49:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:37 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9f7895d6a6e1495692b9ae688ad0aad5
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 26/32
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5a55e2a4d2184a59b70a586d95167e77 (experiment: slowfast)
2025-12-12 22:49:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:39 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5a55e2a4d2184a59b70a586d95167e77
2025-12-12 22:49:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b1a2e72b0c16450396cf3b5d0c3edbff (experiment: slowfast)
2025-12-12 22:49:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:41 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b1a2e72b0c16450396cf3b5d0c3edbff
2025-12-12 22:49:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ac084d674d7a4e5d912ba6024baba1b8 (experiment: slowfast)
2025-12-12 22:49:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:42 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ac084d674d7a4e5d912ba6024baba1b8
2025-12-12 22:49:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 48ee440994d742129c492ed2c8a8de7f (experiment: slowfast)
2025-12-12 22:49:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:45 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 48ee440994d742129c492ed2c8a8de7f
2025-12-12 22:49:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a620d89a251d48f0a51a613dca17cdf3 (experiment: slowfast)
2025-12-12 22:49:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:47 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a620d89a251d48f0a51a613dca17cdf3
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 27/32
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2492188c263f47728dbafb1d1cf6a11a (experiment: slowfast)
2025-12-12 22:49:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:49 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2492188c263f47728dbafb1d1cf6a11a
2025-12-12 22:49:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 599126fdf14641e0b95d2402ea49923b (experiment: slowfast)
2025-12-12 22:49:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:49:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:50 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 599126fdf14641e0b95d2402ea49923b
2025-12-12 22:49:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:49:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: edb14e41a0b54b3198be56594e6fb298 (experiment: slowfast)
2025-12-12 22:49:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:49:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:52 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: edb14e41a0b54b3198be56594e6fb298
2025-12-12 22:49:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:49:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2788486dad7d438d98d8ac485e3bb467 (experiment: slowfast)
2025-12-12 22:49:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:49:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:54 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2788486dad7d438d98d8ac485e3bb467
2025-12-12 22:49:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:49:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:49:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 35cba0b8acab4ea29764b08d5db56315 (experiment: slowfast)
2025-12-12 22:49:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:49:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:56 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 35cba0b8acab4ea29764b08d5db56315
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 28/32
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ccf5d24186044762a66a449a0220230b (experiment: slowfast)
2025-12-12 22:49:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:49:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:49:58 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:49:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ccf5d24186044762a66a449a0220230b
2025-12-12 22:49:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:49:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:49:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:49:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:49:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:49:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:49:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bf8e564c6c5d454a9108512c8eef343d (experiment: slowfast)
2025-12-12 22:49:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:50:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:00 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bf8e564c6c5d454a9108512c8eef343d
2025-12-12 22:50:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:50:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a04c9729580b46f98aa0defeb711aaa3 (experiment: slowfast)
2025-12-12 22:50:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:50:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:01 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a04c9729580b46f98aa0defeb711aaa3
2025-12-12 22:50:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:50:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a01e52d450f04933970615458f9067d5 (experiment: slowfast)
2025-12-12 22:50:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:50:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:04 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a01e52d450f04933970615458f9067d5
2025-12-12 22:50:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:50:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ea51351d803641999c9e0125c123ed96 (experiment: slowfast)
2025-12-12 22:50:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:50:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:06 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ea51351d803641999c9e0125c123ed96
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 29/32
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f0746d889b3a42e58c33dd5f85205ff0 (experiment: slowfast)
2025-12-12 22:50:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:50:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f0746d889b3a42e58c33dd5f85205ff0
2025-12-12 22:50:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:50:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 819742fd89424da9b18f9c113e73f98b (experiment: slowfast)
2025-12-12 22:50:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:50:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 819742fd89424da9b18f9c113e73f98b
2025-12-12 22:50:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:50:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 00120de6d8384ee992b1efe8898caadd (experiment: slowfast)
2025-12-12 22:50:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:50:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 00120de6d8384ee992b1efe8898caadd
2025-12-12 22:50:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:50:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6b7a9c58d9934e83873750d7da12d90c (experiment: slowfast)
2025-12-12 22:50:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:50:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6b7a9c58d9934e83873750d7da12d90c
2025-12-12 22:50:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:50:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 682dc216eefc4cbca63e5efceb6cad3f (experiment: slowfast)
2025-12-12 22:50:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:50:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 682dc216eefc4cbca63e5efceb6cad3f
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 30/32
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:50:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 34e19880cd2d44b7be63a37296b3473d (experiment: slowfast)
2025-12-12 22:50:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:50:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 34e19880cd2d44b7be63a37296b3473d
2025-12-12 22:50:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:50:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b6dc6864217842e59691f58c43cc1f6e (experiment: slowfast)
2025-12-12 22:50:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:50:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b6dc6864217842e59691f58c43cc1f6e
2025-12-12 22:50:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:50:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b0a429b39d2047bdb885fa7af4e918c0 (experiment: slowfast)
2025-12-12 22:50:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:50:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b0a429b39d2047bdb885fa7af4e918c0
2025-12-12 22:50:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:50:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ae92921c61b04d8db6de38e82bd9cb13 (experiment: slowfast)
2025-12-12 22:50:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:50:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:23 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ae92921c61b04d8db6de38e82bd9cb13
2025-12-12 22:50:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:50:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b18a259d75334d969faad89a58c037ad (experiment: slowfast)
2025-12-12 22:50:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:50:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:25 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b18a259d75334d969faad89a58c037ad
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 31/32
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6832ce0460a7483990f530a3c26e834a (experiment: slowfast)
2025-12-12 22:50:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:50:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:27 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6832ce0460a7483990f530a3c26e834a
2025-12-12 22:50:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:50:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b2a793bf6952415bbce3926331db1cdd (experiment: slowfast)
2025-12-12 22:50:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:50:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:28 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b2a793bf6952415bbce3926331db1cdd
2025-12-12 22:50:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:50:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2fce8a0bf33548d38a5f33e8ca105a30 (experiment: slowfast)
2025-12-12 22:50:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:50:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:30 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2fce8a0bf33548d38a5f33e8ca105a30
2025-12-12 22:50:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:50:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5fa3e193cbc9462f9adefd3e2a790f3d (experiment: slowfast)
2025-12-12 22:50:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:50:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:32 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5fa3e193cbc9462f9adefd3e2a790f3d
2025-12-12 22:50:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:50:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:50:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 902eafa4c7f044bdbd10ae4c0363eca2 (experiment: slowfast)
2025-12-12 22:50:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:50:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:35 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 902eafa4c7f044bdbd10ae4c0363eca2
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 32/32
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 37c3485719d24eeea4e5d50b36bc1207 (experiment: slowfast)
2025-12-12 22:50:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:50:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:37 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 37c3485719d24eeea4e5d50b36bc1207
2025-12-12 22:50:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:50:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 47bdad1be8774e28a7b322767c3f06a9 (experiment: slowfast)
2025-12-12 22:50:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:50:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:38 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 47bdad1be8774e28a7b322767c3f06a9
2025-12-12 22:50:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:50:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 09922453a7584143ab474605536fc9da (experiment: slowfast)
2025-12-12 22:50:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:50:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:40 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 09922453a7584143ab474605536fc9da
2025-12-12 22:50:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:50:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9c19dd816f8d4641ae548fc80f988854 (experiment: slowfast)
2025-12-12 22:50:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:50:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:42 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9c19dd816f8d4641ae548fc80f988854
2025-12-12 22:50:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:50:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:50:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a4e3faa5a7b844be86c2a3b668fa5a72 (experiment: slowfast)
2025-12-12 22:50:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:50:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:44 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:50:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a4e3faa5a7b844be86c2a3b668fa5a72
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1823] ================================================================================
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1824] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1825] ================================================================================
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1838] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1848] Final training using default hyperparameters (no grid search)
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 1/5 (full dataset)
2025-12-12 22:50:45 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a0b338e8a296414286908cb5c0c03b04 (experiment: slowfast)
2025-12-12 22:50:46 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 1 (full dataset)...
2025-12-12 22:50:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:50:46 [ERROR] [lib.training.pipeline:2226] Error training final fold 1: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:46 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 2/5 (full dataset)
2025-12-12 22:50:47 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 44eba9363df446989871429acca5f1fd (experiment: slowfast)
2025-12-12 22:50:48 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 2 (full dataset)...
2025-12-12 22:50:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:50:48 [ERROR] [lib.training.pipeline:2226] Error training final fold 2: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:48 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 3/5 (full dataset)
2025-12-12 22:50:48 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a6dad3e64d8f4f219d6650b9c39ff826 (experiment: slowfast)
2025-12-12 22:50:49 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 3 (full dataset)...
2025-12-12 22:50:49 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:50:50 [ERROR] [lib.training.pipeline:2226] Error training final fold 3: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:50 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 4/5 (full dataset)
2025-12-12 22:50:51 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 24d76daff08646d79d5277f7070bf9ff (experiment: slowfast)
2025-12-12 22:50:51 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 4 (full dataset)...
2025-12-12 22:50:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:50:52 [ERROR] [lib.training.pipeline:2226] Error training final fold 4: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:52 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 5/5 (full dataset)
2025-12-12 22:50:52 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:50:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:50:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:50:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:50:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 88a92ae9527b44d09c2425ca9cd6a307 (experiment: slowfast)
2025-12-12 22:50:53 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 5 (full dataset)...
2025-12-12 22:50:53 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:50:57 [ERROR] [lib.training.pipeline:2226] Error training final fold 5: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:50:57 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/fold_1 to copy
2025-12-12 22:50:57 [INFO] [lib.training.pipeline:2299] 
slowfast - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 22:50:59 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots/cv_fold_comparison.png
2025-12-12 22:50:59 [INFO] [lib.training.pipeline:2327] Generated plots for slowfast in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots
2025-12-12 22:50:59 [INFO] [lib.training.pipeline:2364] ================================================================================
2025-12-12 22:50:59 [INFO] [lib.training.pipeline:2365] Stage 5: Model Training Pipeline Completed
2025-12-12 22:50:59 [INFO] [lib.training.pipeline:2366] ================================================================================
2025-12-12 22:50:59 [INFO] [__main__:401] ================================================================================
2025-12-12 22:50:59 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 22:50:59 [INFO] [__main__:403] ================================================================================
2025-12-12 22:50:59 [INFO] [__main__:404] Execution time: 332.63 seconds (5.54 minutes)
2025-12-12 22:50:59 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:50:59 [INFO] [__main__:407] Models trained: ['slowfast']
2025-12-12 22:50:59 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 22:50:59 [INFO] [__main__:414] ================================================================================
2025-12-12 22:50:59 [INFO] [__main__:415] Final memory statistics:
2025-12-12 22:50:59 [INFO] [__main__:416] ================================================================================
2025-12-12 22:50:59 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 2652.5859375, 'cpu_memory_gb': 2.5904159545898438, 'cpu_vms_mb': 48971.7734375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.285212672, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.643129344}
2025-12-12 22:50:59 [INFO] [__main__:419] ================================================================================
2025-12-12 22:50:59 [INFO] [__main__:420] Training complete!
2025-12-12 22:50:59 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:50:59 [INFO] [__main__:422] ================================================================================
