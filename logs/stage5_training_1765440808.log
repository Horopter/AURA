2025-12-11 03:13:28 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 751.30078125, 'cpu_memory_gb': 0.7336921691894531, 'cpu_vms_mb': 10235.875, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-11 03:13:28 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-11 03:13:28 [DEBUG] [lib.utils.memory:96] Num threads: 5
2025-12-11 03:13:28 [INFO] [lib.training.pipeline:169] ================================================================================
2025-12-11 03:13:28 [INFO] [lib.training.pipeline:170] STAGE 5 PREREQUISITE VALIDATION
2025-12-11 03:13:28 [INFO] [lib.training.pipeline:171] ================================================================================
2025-12-11 03:13:28 [INFO] [lib.training.pipeline:174] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-11 03:13:29 [INFO] [lib.training.pipeline:183] ✓ Stage 3 metadata found: 3244 scaled videos
2025-12-11 03:13:29 [INFO] [lib.training.pipeline:184]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-11 03:13:29 [INFO] [lib.training.pipeline:187] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-11 03:13:29 [WARNING] [lib.utils.paths:169] Metadata file is empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, trying other formats...
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:195] ✓ Stage 2 metadata found: 3244 feature rows
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:196]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:199] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:207] ✓ Stage 4 metadata found: 3243 feature rows
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:208]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:211] 
================================================================================
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:212] MODEL REQUIREMENTS CHECK
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:213] ================================================================================
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:252] ✓ logistic_regression: CAN RUN
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:255] 
================================================================================
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:256] VALIDATION SUMMARY
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:257] ================================================================================
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:258] Stage 3 (scaled videos): ✓ Available
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:259]   Count: 3244 videos
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:260] Stage 2 (features): ✓ Available
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:261]   Count: 3244 feature rows
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:262] Stage 4 (scaled features): ✓ Available
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:263]   Count: 3243 feature rows
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:264] 
Runnable models: 1/1
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:265]   ['logistic_regression']
2025-12-11 03:13:30 [INFO] [lib.training.pipeline:272] ================================================================================
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:450] 
Stage 5: Loading metadata...
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:476] Loaded metadata: 3244 rows
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:486] ✓ Data validation passed: 3244 rows (> 3000 required)
2025-12-11 03:13:31 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=498204.80GB, used=2001635.20GB (80.1%)
2025-12-11 03:13:31 [WARNING] [lib.utils.paths:169] Metadata file is empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, trying other formats...
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:508] Stage 5: Found 3244 scaled videos
2025-12-11 03:13:31 [DEBUG] [lib.training.pipeline:538] Successfully imported VideoConfig from lib.models
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:603] 
================================================================================
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:604] Stage 5: Training model: logistic_regression
2025-12-11 03:13:31 [INFO] [lib.training.pipeline:605] ================================================================================
2025-12-11 03:13:32 [INFO] [lib.training.pipeline:642] Using 5-fold stratified cross-validation
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:651] Grid search: 40 hyperparameter combinations to try
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:663] 
================================================================================
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:664] Grid Search: Hyperparameter combination 1/40
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:665] Parameters: {'C': 0.01, 'penalty': 'l1', 'solver': 'liblinear', 'max_iter': 1000}
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:666] ================================================================================
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:677] 
Training logistic_regression - Fold 1/5
2025-12-11 03:13:37 [INFO] [lib.training.pipeline:1129] Training baseline model logistic_regression on fold 1...
2025-12-11 03:13:37 [INFO] [lib.training._linear:82] Extracting handcrafted features directly from 2594 videos...
2025-12-11 03:13:39 [DEBUG] [lib.features.handcrafted:33] ffprobe not found in PATH - codec cue extraction will be disabled
2025-12-11 03:17:25 [ERROR] [libav.mov,mp4,m4a,3gp,3g2,mj2:411] moov atom not found
2025-12-11 03:17:25 [DEBUG] [lib.features.handcrafted:486] Unexpected error processing data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: module 'av' has no attribute 'AVError', using zero features
2025-12-11 03:19:30 [INFO] [lib.training._linear:112] Removing collinear features...
2025-12-11 03:19:30 [INFO] [lib.training.feature_preprocessing:76] Removed 3 features with zero variance
2025-12-11 03:19:31 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: feature_0 (correlation=0.984)
2025-12-11 03:19:31 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: feature_0 (correlation=0.976)
2025-12-11 03:19:31 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: feature_4 (correlation=0.953)
2025-12-11 03:19:31 [DEBUG] [lib.training.feature_preprocessing:128] Removing collinear feature: feature_10 (correlation=0.964)
2025-12-11 03:19:31 [INFO] [lib.training.feature_preprocessing:138] Removed 4 collinear features (correlation >= 0.95)
2025-12-11 03:19:31 [INFO] [lib.training.feature_preprocessing:159] Final feature count: 8/15 (53.3% retained)
2025-12-11 03:19:31 [INFO] [lib.training._linear:162] Using 8 features after collinearity removal
2025-12-11 03:19:31 [INFO] [lib.training._linear:175] Scaling features...
2025-12-11 03:19:31 [INFO] [lib.training._linear:188] Training Logistic Regression...
2025-12-11 03:19:31 [INFO] [lib.training._linear:196] ✓ Logistic Regression trained
2025-12-11 03:20:40 [DEBUG] [lib.training._linear:243] Applied feature filtering: 8 features
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:1196] Fold 1 - Val Loss: 0.6869, Val Acc: 0.5662, Val F1: 0.5841, Val Precision: 0.5673, Val Recall: 0.6018
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:1202]   Class 0 - Precision: 0.5648, Recall: 0.5296, F1: 0.5466
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:1202]   Class 1 - Precision: 0.5673, Recall: 0.6018, F1: 0.5841
2025-12-11 03:20:41 [INFO] [lib.training._linear:285] Saved Logistic Regression model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:1209] Saved baseline model to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/logistic_regression/fold_1
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:677] 
Training logistic_regression - Fold 2/5
2025-12-11 03:20:41 [INFO] [lib.training.pipeline:1129] Training baseline model logistic_regression on fold 2...
2025-12-11 03:20:41 [INFO] [lib.training._linear:82] Extracting handcrafted features directly from 2594 videos...
