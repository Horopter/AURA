2025-12-12 20:55:50 [INFO] [__main__:310] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 20:55:50 [INFO] [__main__:312] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 20:55:50 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:55:50 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 20:55:50 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 20:55:50 [INFO] [__main__:317] Model types: ['x3d']
2025-12-12 20:55:50 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 20:55:50 [INFO] [__main__:319] Number of frames: 500
2025-12-12 20:55:50 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 20:55:50 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 20:55:50 [INFO] [__main__:324] Delete existing: False
2025-12-12 20:55:50 [INFO] [__main__:325] Resume mode: True
2025-12-12 20:55:50 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765590950.log
2025-12-12 20:55:50 [INFO] [__main__:333] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 20:55:50 [INFO] [__main__:335] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:55:50 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 20:55:50 [INFO] [__main__:358] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 20:55:50 [INFO] [__main__:360] ================================================================================
2025-12-12 20:55:50 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.53125, 'cpu_memory_gb': 0.718292236328125, 'cpu_vms_mb': 10217.7109375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 20:55:50 [INFO] [__main__:364] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 20:55:50 [INFO] [__main__:366] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 20:55:50 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 20:55:50 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 20:55:50 [INFO] [__main__:370] ================================================================================
2025-12-12 20:55:50 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 20:55:50 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:490] ================================================================================
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:491] Stage 5: Model Training Pipeline Started
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:492] ================================================================================
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:493] Model types: ['x3d']
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:494] K-fold splits: 5
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:495] Frames per video: 500
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:496] Output directory: data/stage5
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:497] Initializing pipeline...
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 20:55:50 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:333] ✓ x3d: CAN RUN
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:346]   ['x3d']
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:583] 
Stage 5: Loading metadata...
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:609] Loaded metadata: 3278 rows
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:619] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 20:55:52 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=833224.80GB, used=1666615.20GB (66.7%)
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:651] Stage 5: Found 3278 scaled videos
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:699] Enabling adaptive chunked frame loading for x3d: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:771] 
================================================================================
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:772] Stage 5: Training model: x3d
2025-12-12 20:55:52 [INFO] [lib.training.pipeline:773] ================================================================================
2025-12-12 20:55:53 [INFO] [lib.training.pipeline:797] Grid search: 16 hyperparameter combinations to try
2025-12-12 20:55:53 [INFO] [lib.training.pipeline:805] ================================================================================
2025-12-12 20:55:53 [INFO] [lib.training.pipeline:806] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 20:55:53 [INFO] [lib.training.pipeline:807] ================================================================================
2025-12-12 20:55:54 [INFO] [lib.training.pipeline:816] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:829] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 1/16
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:55:55 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:55:55 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:55:56 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:56:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d0f7118337fa434fbecd241f391923eb (experiment: x3d)
2025-12-12 20:56:01 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:56:12 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:56:12 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:56:19 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:56:19 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:56:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d0f7118337fa434fbecd241f391923eb
2025-12-12 20:56:20 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:56:20 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:56:20 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:56:20 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:56:20 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:56:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 494938734e9f4f13a74d380effa0405a (experiment: x3d)
2025-12-12 20:56:20 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:56:24 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:56:24 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:56:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:56:36 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 10.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.31 GiB is allocated by PyTorch, and 77.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 20:56:36 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 3694.84765625, 'cpu_memory_gb': 3.6082496643066406, 'cpu_vms_mb': 50740.4140625, 'gpu_allocated_gb': 16.436335616, 'gpu_reserved_gb': 16.517169152, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.411172864}
2025-12-12 20:56:36 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 10.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.31 GiB is allocated by PyTorch, and 77.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 2, Current batch size: 1
2025-12-12 20:56:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:56:40 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:56:40 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:56:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 494938734e9f4f13a74d380effa0405a
2025-12-12 20:56:41 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:56:41 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:56:41 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:56:41 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:56:41 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:56:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f402c045bd8f41c0aec082ce6f97791c (experiment: x3d)
2025-12-12 20:56:41 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:56:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:56:46 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:56:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:56:53 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:56:53 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:56:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f402c045bd8f41c0aec082ce6f97791c
2025-12-12 20:56:53 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:56:53 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:56:53 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:56:53 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:56:53 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:56:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d71645946ff145f6bd37c9c79880b911 (experiment: x3d)
2025-12-12 20:56:53 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:56:58 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:56:58 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:02 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:57:03 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:57:03 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d71645946ff145f6bd37c9c79880b911
2025-12-12 20:57:03 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:57:03 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:03 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:03 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:04 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 482a7a42a1014adb8b629ca87769fd33 (experiment: x3d)
2025-12-12 20:57:04 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:57:08 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:08 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:13 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:57:13 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 482a7a42a1014adb8b629ca87769fd33
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 2/16
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:13 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:13 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4903002b218643b3b446db0ec3f0774d (experiment: x3d)
2025-12-12 20:57:13 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:57:17 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:57:18 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:18 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:22 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:57:22 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4903002b218643b3b446db0ec3f0774d
2025-12-12 20:57:22 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:57:22 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:23 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:23 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:23 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9dbc674056f94ac3a2c5b55a64f889cb (experiment: x3d)
2025-12-12 20:57:23 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:57:27 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:27 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:31 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:57:32 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:57:32 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9dbc674056f94ac3a2c5b55a64f889cb
2025-12-12 20:57:32 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:57:32 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:32 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:32 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:33 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 177ac8a5b057420fbede5b05f61c0301 (experiment: x3d)
2025-12-12 20:57:33 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:57:37 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:37 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:44 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:57:44 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 177ac8a5b057420fbede5b05f61c0301
2025-12-12 20:57:44 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:57:44 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:45 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:45 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:45 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1abc4a9a40084d3286a879d29c79b062 (experiment: x3d)
2025-12-12 20:57:45 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:57:49 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:57:49 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:49 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:57:54 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:57:54 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:57:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1abc4a9a40084d3286a879d29c79b062
2025-12-12 20:57:54 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:57:54 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:57:55 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:57:55 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:57:55 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:57:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 73ae334184964e50b52bfe17f4827a49 (experiment: x3d)
2025-12-12 20:57:55 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:57:59 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:57:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:05 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:58:06 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:58:06 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 73ae334184964e50b52bfe17f4827a49
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 3/16
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:06 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:06 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:06 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3d479cfde86644798da137068d7f52b3 (experiment: x3d)
2025-12-12 20:58:07 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:58:11 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:58:11 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:16 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:58:16 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3d479cfde86644798da137068d7f52b3
2025-12-12 20:58:16 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:58:16 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:16 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:16 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:16 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8def8424817348d082f44057186ed4be (experiment: x3d)
2025-12-12 20:58:17 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:58:20 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:58:20 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:58:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:25 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:58:25 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8def8424817348d082f44057186ed4be
2025-12-12 20:58:25 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:58:25 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:26 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:26 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:26 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 89536867d5df498f9296d3289c4cd277 (experiment: x3d)
2025-12-12 20:58:26 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:58:30 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:58:30 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:34 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:58:35 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:58:35 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 89536867d5df498f9296d3289c4cd277
2025-12-12 20:58:35 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:58:35 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:35 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:35 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:35 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1796459dd10d4eefb784e1dcc3f649cd (experiment: x3d)
2025-12-12 20:58:36 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:58:40 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:58:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:45 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:58:45 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1796459dd10d4eefb784e1dcc3f649cd
2025-12-12 20:58:45 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:58:45 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:45 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:45 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:45 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fc6de1f2ae0d46258a416c1e06d11dc9 (experiment: x3d)
2025-12-12 20:58:45 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:58:49 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:58:50 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:58:50 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:58:55 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 20:58:55 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:58:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fc6de1f2ae0d46258a416c1e06d11dc9
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 4/16
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:58:55 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:58:55 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:58:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2f8aa0a26c094ced867166bf8139f03b (experiment: x3d)
2025-12-12 20:58:55 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 20:59:00 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:59:00 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:59:04 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:59:04 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 20:59:04 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:59:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2f8aa0a26c094ced867166bf8139f03b
2025-12-12 20:59:05 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 20:59:05 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:59:05 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:59:05 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:59:05 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:59:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5b8876a898c04fb68b4405784bfa70c8 (experiment: x3d)
2025-12-12 20:59:05 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 20:59:09 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:59:09 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:59:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 20:59:14 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:59:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5b8876a898c04fb68b4405784bfa70c8
2025-12-12 20:59:14 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 20:59:14 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:59:14 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:59:14 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:59:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:59:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ecbdcc4e1d3647158f19c0329ef84451 (experiment: x3d)
2025-12-12 20:59:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 20:59:18 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:59:19 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:59:19 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:59:23 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 20:59:23 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:59:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ecbdcc4e1d3647158f19c0329ef84451
2025-12-12 20:59:24 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 20:59:24 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:59:24 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:59:24 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:59:24 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:59:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0bc3a1c7eae54d5ebbc67f3c76ede99d (experiment: x3d)
2025-12-12 20:59:24 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 20:59:28 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:59:29 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:59:32 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:59:33 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 20:59:33 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 20:59:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0bc3a1c7eae54d5ebbc67f3c76ede99d
2025-12-12 20:59:33 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 20:59:33 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 20:59:33 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 20:59:33 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 20:59:34 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 20:59:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cddd1aa380634d64875e969bff5c782a (experiment: x3d)
2025-12-12 20:59:34 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 20:59:38 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 20:59:38 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 20:59:50 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 20:59:50 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 160, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:00:06 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:00:06 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:00:13 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 5: CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 8.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.18 GiB is allocated by PyTorch, and 195.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:00:13 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 5): {'cpu_memory_mb': 4307.03515625, 'cpu_memory_gb': 4.206089019775391, 'cpu_vms_mb': 51422.1171875, 'gpu_allocated_gb': 16.299794944, 'gpu_reserved_gb': 16.50458624, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.423755776}
2025-12-12 21:00:13 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 8.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.18 GiB is allocated by PyTorch, and 195.29 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 5, Current batch size: 1
2025-12-12 21:00:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:00:18 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:00:18 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:00:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cddd1aa380634d64875e969bff5c782a
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 5/16
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:00:19 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:00:19 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:00:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ee2f754885444f5a9739740faf179a6c (experiment: x3d)
2025-12-12 21:00:19 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:00:23 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:00:23 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:00:23 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:00:28 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:00:28 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:00:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ee2f754885444f5a9739740faf179a6c
2025-12-12 21:00:28 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:00:28 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:00:28 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:00:28 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:00:29 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:00:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4abb14a52a6c458c80b4d41551503bff (experiment: x3d)
2025-12-12 21:00:29 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:00:33 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:00:33 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:00:37 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:00:38 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:00:38 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:00:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4abb14a52a6c458c80b4d41551503bff
2025-12-12 21:00:38 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:00:38 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:00:38 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:00:38 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:00:39 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:00:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1c4ec8dc8f354cefb2b8b35b8a9a6b88 (experiment: x3d)
2025-12-12 21:00:39 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:00:43 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:00:43 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:00:49 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:00:49 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4307.1875, 'cpu_memory_gb': 4.20623779296875, 'cpu_vms_mb': 51422.1171875, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.437477376, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.49086464}
2025-12-12 21:00:49 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 72.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 136.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 3, Current batch size: 1
2025-12-12 21:00:50 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:00:53 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:00:54 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:00:54 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:00:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1c4ec8dc8f354cefb2b8b35b8a9a6b88
2025-12-12 21:00:54 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:00:54 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:00:55 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:00:55 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:00:55 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:00:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7c129feb00414dd8b647003655720b7d (experiment: x3d)
2025-12-12 21:00:55 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:00:59 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:00:59 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:04 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:01:04 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:01:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7c129feb00414dd8b647003655720b7d
2025-12-12 21:01:04 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:01:04 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:01:04 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:01:04 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:01:05 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:01:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 20abf548f970440d823208dcc81fe024 (experiment: x3d)
2025-12-12 21:01:05 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:01:09 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:01:09 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:01:09 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:01:14 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:01:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 20abf548f970440d823208dcc81fe024
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 6/16
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:01:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:01:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:01:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a23b059fab0f41aba8812c23375c5847 (experiment: x3d)
2025-12-12 21:01:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:01:20 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:01:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:25 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:01:27 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:01:27 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4307.1875, 'cpu_memory_gb': 4.20623779296875, 'cpu_vms_mb': 51422.1171875, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 21:01:27 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 1, Current batch size: 1
2025-12-12 21:01:27 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:33 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:01:33 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:01:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a23b059fab0f41aba8812c23375c5847
2025-12-12 21:01:33 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:01:33 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:01:34 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:01:34 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:01:34 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:01:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b27b78c60e5941628e5108a46c3163c1 (experiment: x3d)
2025-12-12 21:01:34 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:01:38 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:01:38 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:42 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:01:43 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:01:43 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:01:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b27b78c60e5941628e5108a46c3163c1
2025-12-12 21:01:43 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:01:43 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:01:43 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:01:43 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:01:44 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:01:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3568180fcb1c4ed0a25e202c4762e267 (experiment: x3d)
2025-12-12 21:01:44 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:01:48 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:01:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:01:53 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:01:53 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:01:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3568180fcb1c4ed0a25e202c4762e267
2025-12-12 21:01:53 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:01:53 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:01:54 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:01:54 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:01:54 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:01:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 59d8aa4570f64f8091be1e8e8f33f4c0 (experiment: x3d)
2025-12-12 21:01:54 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:01:58 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:01:58 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:01:58 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:02:05 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:02:05 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:02:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 59d8aa4570f64f8091be1e8e8f33f4c0
2025-12-12 21:02:06 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:02:06 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:02:06 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:02:06 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:02:06 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:02:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5afaad81f9d04b4a9e29c211778edf14 (experiment: x3d)
2025-12-12 21:02:06 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:02:11 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:02:11 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:02:14 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:02:15 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:02:15 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:02:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5afaad81f9d04b4a9e29c211778edf14
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 7/16
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:02:16 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:02:16 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:02:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 872d6a8b23394a7f856de6137d37bb2d (experiment: x3d)
2025-12-12 21:02:16 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:02:21 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:02:21 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:02:38 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:02:38 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:02:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 872d6a8b23394a7f856de6137d37bb2d
2025-12-12 21:02:39 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:02:39 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:02:39 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:02:39 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:02:39 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:02:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eecbc96272c74fa4bc49971502d72c99 (experiment: x3d)
2025-12-12 21:02:39 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:02:42 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:02:43 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:02:43 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:02:49 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:02:49 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:02:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eecbc96272c74fa4bc49971502d72c99
2025-12-12 21:02:49 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:02:49 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:02:49 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:02:49 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:02:50 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:02:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0c9dbef2e5194de6875007a2796059b6 (experiment: x3d)
2025-12-12 21:02:50 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:02:54 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:02:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:02:58 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:02:59 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:02:59 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:02:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0c9dbef2e5194de6875007a2796059b6
2025-12-12 21:02:59 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:02:59 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:02:59 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:02:59 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:02:59 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:03:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93b2b02e1009460b9c5c3de0011ed160 (experiment: x3d)
2025-12-12 21:03:00 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:03:04 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:03:04 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:03:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:03:14 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:03:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93b2b02e1009460b9c5c3de0011ed160
2025-12-12 21:03:15 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:03:15 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:03:15 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:03:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:03:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:03:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b80d342aef3049f1a5521b3c46447cda (experiment: x3d)
2025-12-12 21:03:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:03:19 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:03:20 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:03:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:03:28 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:03:28 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:03:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b80d342aef3049f1a5521b3c46447cda
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 8/16
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:03:28 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:03:28 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:03:29 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:03:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5ec83da4447341be929459f8adb1585e (experiment: x3d)
2025-12-12 21:03:29 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:03:33 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:03:33 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:03:37 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:03:37 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:03:37 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:03:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5ec83da4447341be929459f8adb1585e
2025-12-12 21:03:38 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:03:38 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:03:38 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:03:38 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:03:38 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:03:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1072cba35e684a6dbcfb209a6239daf2 (experiment: x3d)
2025-12-12 21:03:38 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:03:42 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:03:42 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:03:53 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:03:53 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:03:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1072cba35e684a6dbcfb209a6239daf2
2025-12-12 21:03:53 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:03:53 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:03:53 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:03:53 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:03:54 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:03:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fedacd0e88e7451bbb3c03ebd584043d (experiment: x3d)
2025-12-12 21:03:54 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:03:57 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:03:58 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:03:58 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:02 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:04:02 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fedacd0e88e7451bbb3c03ebd584043d
2025-12-12 21:04:03 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:04:03 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:03 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:03 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:03 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9d5ad1d4cf054c78ad6d76d85d478579 (experiment: x3d)
2025-12-12 21:04:03 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:04:08 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:04:08 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:11 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:04:12 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:04:12 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9d5ad1d4cf054c78ad6d76d85d478579
2025-12-12 21:04:12 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:04:12 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:13 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:13 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:13 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 969a83a3af33429c8bc77d9fa0772c3f (experiment: x3d)
2025-12-12 21:04:13 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:04:17 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:04:17 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:22 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:04:22 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 969a83a3af33429c8bc77d9fa0772c3f
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 9/16
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:23 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:23 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ae7f96d5f92f4211bf233bcbb0c3681b (experiment: x3d)
2025-12-12 21:04:23 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:04:27 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:04:27 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:04:28 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:32 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:04:32 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ae7f96d5f92f4211bf233bcbb0c3681b
2025-12-12 21:04:32 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:04:32 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:33 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:33 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:33 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0346d020fa0d4079a513552e1a09c614 (experiment: x3d)
2025-12-12 21:04:33 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:04:37 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:04:37 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:46 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:04:47 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:04:47 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0346d020fa0d4079a513552e1a09c614
2025-12-12 21:04:47 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:04:47 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:48 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:48 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:48 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6580ba327fc7477ba9ec3da9405765e1 (experiment: x3d)
2025-12-12 21:04:48 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:04:53 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:04:53 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:04:57 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:04:57 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:04:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6580ba327fc7477ba9ec3da9405765e1
2025-12-12 21:04:57 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:04:57 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:04:58 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:04:58 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:04:58 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:04:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bee19c9eaef64e348888f7420f668610 (experiment: x3d)
2025-12-12 21:04:58 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:05:02 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:05:02 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:05:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:05:06 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:05:06 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:05:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bee19c9eaef64e348888f7420f668610
2025-12-12 21:05:07 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:05:07 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:05:07 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:05:07 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:05:07 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:05:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: faa83daa784c49b28be9d50dd227a1b1 (experiment: x3d)
2025-12-12 21:05:07 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:05:12 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:05:12 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:05:16 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:05:16 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:05:16 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:05:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: faa83daa784c49b28be9d50dd227a1b1
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 10/16
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:05:17 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:05:17 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:05:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aa59cad8abe941489af5a5683e20b8f5 (experiment: x3d)
2025-12-12 21:05:17 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:05:21 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:05:22 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:05:31 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:05:31 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:05:36 [WARNING] [lib.training.trainer:363] Skipping batch 2 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:05:40 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:05:46 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:05:47 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:05:51 [WARNING] [lib.training.trainer:363] Skipping batch 5 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:05:56 [WARNING] [lib.training.trainer:363] Skipping batch 6 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:06:01 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:06:03 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 7: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:06:03 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 7): {'cpu_memory_mb': 5500.5546875, 'cpu_memory_gb': 5.371635437011719, 'cpu_vms_mb': 52613.77734375, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.460546048, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.467795968}
2025-12-12 21:06:03 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 50.19 MiB is free. Including non-PyTorch memory, this process has 15.71 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 147.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 1, Current batch size: 1
2025-12-12 21:06:03 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:06:08 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:06:08 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:06:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aa59cad8abe941489af5a5683e20b8f5
2025-12-12 21:06:08 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:06:08 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:06:08 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:06:08 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:06:09 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:06:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c8be4f5680e64cecaebee6ff0c6a6a64 (experiment: x3d)
2025-12-12 21:06:09 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:06:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:06:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:06:28 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:06:29 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:06:29 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:06:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c8be4f5680e64cecaebee6ff0c6a6a64
2025-12-12 21:06:29 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:06:29 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:06:29 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:06:29 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:06:30 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:06:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0e93417ea1994b61aaa54cfbd4c5c2d0 (experiment: x3d)
2025-12-12 21:06:30 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:06:35 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:06:35 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:06:41 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:06:41 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:06:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0e93417ea1994b61aaa54cfbd4c5c2d0
2025-12-12 21:06:42 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:06:42 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:06:42 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:06:42 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:06:42 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:06:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b5136e888184c69a2be0915825feaad (experiment: x3d)
2025-12-12 21:06:42 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:06:46 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:06:47 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:06:47 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:06:51 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:06:51 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:06:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b5136e888184c69a2be0915825feaad
2025-12-12 21:06:52 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:06:52 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:06:52 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:06:52 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:06:52 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:06:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: add9b58467694fe1ad3d5e6f5cbc9578 (experiment: x3d)
2025-12-12 21:06:52 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:06:56 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:06:57 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:00 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:07:01 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:07:01 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: add9b58467694fe1ad3d5e6f5cbc9578
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 11/16
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:07:01 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:02 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:02 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:02 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5f6657a4d6da417ab2cb4c3b4d9818ee (experiment: x3d)
2025-12-12 21:07:02 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:07:06 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:07:06 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:10 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:07:10 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5f6657a4d6da417ab2cb4c3b4d9818ee
2025-12-12 21:07:11 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:07:11 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:11 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:11 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:12 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d3122e618acc4cc29e28b0b8c46f84c4 (experiment: x3d)
2025-12-12 21:07:12 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:07:15 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:07:16 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:07:16 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:20 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:07:20 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d3122e618acc4cc29e28b0b8c46f84c4
2025-12-12 21:07:21 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:07:21 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:21 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:21 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:21 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 669a6b36c96c40e8a9ca09edeaa95ded (experiment: x3d)
2025-12-12 21:07:21 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:07:25 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:07:26 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:30 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:07:31 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 32.19 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 15.14 GiB is allocated by PyTorch, and 209.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:07:32 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 5499.11328125, 'cpu_memory_gb': 5.370227813720703, 'cpu_vms_mb': 52612.47265625, 'gpu_allocated_gb': 16.260172288, 'gpu_reserved_gb': 16.479420416, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.4489216}
2025-12-12 21:07:32 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 28.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 32.19 MiB is free. Including non-PyTorch memory, this process has 15.73 GiB memory in use. Of the allocated memory 15.14 GiB is allocated by PyTorch, and 209.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 3, Current batch size: 1
2025-12-12 21:07:32 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:36 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:07:36 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 669a6b36c96c40e8a9ca09edeaa95ded
2025-12-12 21:07:37 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:07:37 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:37 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:37 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:38 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: be4b38d9435e4c79a7567f84a380af17 (experiment: x3d)
2025-12-12 21:07:38 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:07:42 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:07:42 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:07:46 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:07:46 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: be4b38d9435e4c79a7567f84a380af17
2025-12-12 21:07:46 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:07:46 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:47 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:47 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:47 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 30fd9c4b4900499a950a60f44e6daa30 (experiment: x3d)
2025-12-12 21:07:47 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:07:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:07:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:07:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:07:56 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:07:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 30fd9c4b4900499a950a60f44e6daa30
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 12/16
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:07:56 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:07:56 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:07:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 32bad94c78064cea9503abbd2a5aec8b (experiment: x3d)
2025-12-12 21:07:56 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:08:00 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:08:01 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:01 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:06 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:08:06 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 32bad94c78064cea9503abbd2a5aec8b
2025-12-12 21:08:06 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:08:06 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:06 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:06 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:06 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2f14161b08b04fd3afb4681f27d26342 (experiment: x3d)
2025-12-12 21:08:07 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:08:10 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:10 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:14 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:08:15 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:08:15 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2f14161b08b04fd3afb4681f27d26342
2025-12-12 21:08:15 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:08:15 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:15 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:16 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7e670853c03b46cb958f50c4307fa695 (experiment: x3d)
2025-12-12 21:08:16 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:08:21 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:21 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:26 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:08:26 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7e670853c03b46cb958f50c4307fa695
2025-12-12 21:08:26 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:08:26 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:26 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:26 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:27 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9387b288d6174a8686fbff5dd0902f7d (experiment: x3d)
2025-12-12 21:08:27 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:08:30 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:08:31 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:31 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:36 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:08:36 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9387b288d6174a8686fbff5dd0902f7d
2025-12-12 21:08:36 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:08:36 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:37 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:37 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:37 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6967d580d3b84cfb8aca2109f269dc2f (experiment: x3d)
2025-12-12 21:08:37 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:08:41 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:41 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:08:45 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:08:45 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 8 W: 5) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6967d580d3b84cfb8aca2109f269dc2f
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 13/16
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001}
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:46 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:46 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 889ca8c9eb7843a58c34a84c2c869ec0 (experiment: x3d)
2025-12-12 21:08:46 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:08:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:08:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:08:56 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:08:56 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:08:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 889ca8c9eb7843a58c34a84c2c869ec0
2025-12-12 21:08:56 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:08:56 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:08:57 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:08:57 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:08:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:08:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 92b5f5aa47a84c3490b46e9d8edcde9e (experiment: x3d)
2025-12-12 21:08:57 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:09:00 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:09:01 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:01 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:06 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:09:06 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 92b5f5aa47a84c3490b46e9d8edcde9e
2025-12-12 21:09:06 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:09:06 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:06 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:06 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:06 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3bb237cc889349f6b20bb2a8e189c32b (experiment: x3d)
2025-12-12 21:09:07 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:09:11 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:11 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:15 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:09:16 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:09:16 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3bb237cc889349f6b20bb2a8e189c32b
2025-12-12 21:09:16 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:09:16 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:16 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:16 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:16 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 429b7dc7adba421da078d182fb0e7bde (experiment: x3d)
2025-12-12 21:09:16 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:09:21 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:21 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:25 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:09:25 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 429b7dc7adba421da078d182fb0e7bde
2025-12-12 21:09:26 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:09:26 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:26 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:26 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:26 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0b82d658b0214df6998c71ca9ff0f30c (experiment: x3d)
2025-12-12 21:09:26 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:09:30 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:09:30 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:31 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:35 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:09:35 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0b82d658b0214df6998c71ca9ff0f30c
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 14/16
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001}
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:09:35 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:36 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:36 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:36 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4266a9fae39d4b99adf04e1a9aa5b363 (experiment: x3d)
2025-12-12 21:09:36 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:09:40 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:41 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:45 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:09:46 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:09:46 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4266a9fae39d4b99adf04e1a9aa5b363
2025-12-12 21:09:46 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:09:46 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:46 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:46 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:47 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f57d7a3b7be941adb91ed4427f0f7fef (experiment: x3d)
2025-12-12 21:09:47 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:09:51 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:09:51 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:09:58 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:09:58 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:09:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f57d7a3b7be941adb91ed4427f0f7fef
2025-12-12 21:09:58 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:09:58 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:09:59 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:09:59 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:09:59 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:09:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9cfaf57fe8f549a4842b3207d791603e (experiment: x3d)
2025-12-12 21:09:59 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:10:03 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:10:03 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:03 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:08 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:10:08 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9cfaf57fe8f549a4842b3207d791603e
2025-12-12 21:10:08 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:10:08 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:09 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:09 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:09 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b958eb75d3174bdc90b6c048fe668cfa (experiment: x3d)
2025-12-12 21:10:09 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:10:13 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:13 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:17 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:10:18 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:10:18 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b958eb75d3174bdc90b6c048fe668cfa
2025-12-12 21:10:18 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:10:18 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:18 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:18 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:19 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e787d69867a14e72a490553ed22fcc31 (experiment: x3d)
2025-12-12 21:10:19 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:10:23 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:23 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:28 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:10:28 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e787d69867a14e72a490553ed22fcc31
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 15/16
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001}
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:10:28 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:29 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:29 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:29 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 41d96739bc2543a98a91d39d5c81712b (experiment: x3d)
2025-12-12 21:10:29 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:10:33 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:10:33 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:38 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:10:38 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 41d96739bc2543a98a91d39d5c81712b
2025-12-12 21:10:39 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:10:39 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:39 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:39 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:39 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 967817c0acec4d7194ce63bbd19dcd9d (experiment: x3d)
2025-12-12 21:10:39 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:10:43 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:43 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:48 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:10:49 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:10:49 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 967817c0acec4d7194ce63bbd19dcd9d
2025-12-12 21:10:49 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:10:49 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:50 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:50 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:50 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 16f1a5acaea84badb59e25d21d77e193 (experiment: x3d)
2025-12-12 21:10:50 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:10:54 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:10:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:10:58 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:10:58 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:10:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 16f1a5acaea84badb59e25d21d77e193
2025-12-12 21:10:59 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:10:59 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:10:59 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:10:59 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:10:59 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:10:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 94c4813359174f8b9a76bb6464cfd72b (experiment: x3d)
2025-12-12 21:10:59 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:11:03 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:11:04 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:11:04 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:11:09 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:11:09 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 5500.125, 'cpu_memory_gb': 5.3712158203125, 'cpu_vms_mb': 52613.47265625, 'gpu_allocated_gb': 16.293907968, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 21:11:09 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.17 GiB is allocated by PyTorch, and 138.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 4, Current batch size: 1
2025-12-12 21:11:10 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:11:14 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:11:14 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:11:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 94c4813359174f8b9a76bb6464cfd72b
2025-12-12 21:11:15 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:11:15 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:11:15 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:11:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:11:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:11:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93648c2564c2444f9d72a5c9d1b6b72c (experiment: x3d)
2025-12-12 21:11:15 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:11:19 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:11:19 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:11:20 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:11:24 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:11:24 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:11:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93648c2564c2444f9d72a5c9d1b6b72c
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:842] 
================================================================================
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:843] Grid Search: Hyperparameter combination 16/16
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:844] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001}
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:845] ================================================================================
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 1/5 (20% sample)
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:11:24 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:11:24 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:11:25 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:11:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 00a15581c7ca4e03a52c81f6d37578c8 (experiment: x3d)
2025-12-12 21:11:25 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 1...
2025-12-12 21:11:29 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:11:29 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:11:32 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:11:33 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 1
2025-12-12 21:11:33 [ERROR] [lib.training.pipeline:1738] Error training fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:11:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 00a15581c7ca4e03a52c81f6d37578c8
2025-12-12 21:11:33 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 2/5 (20% sample)
2025-12-12 21:11:33 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:11:34 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:11:34 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:11:34 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:11:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 30bc6f73275d426f860766a5abf24eb2 (experiment: x3d)
2025-12-12 21:11:34 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 2...
2025-12-12 21:11:38 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:11:38 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:11:42 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 2
2025-12-12 21:11:42 [ERROR] [lib.training.pipeline:1738] Error training fold 2: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:11:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 30bc6f73275d426f860766a5abf24eb2
2025-12-12 21:11:42 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 3/5 (20% sample)
2025-12-12 21:11:42 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:11:43 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:11:43 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:11:43 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:11:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 804eddca257c4fba864d418919fd7240 (experiment: x3d)
2025-12-12 21:11:43 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 3...
2025-12-12 21:11:47 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:11:47 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:11:47 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:12:03 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:07 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:12:08 [WARNING] [lib.training.trainer:363] Skipping batch 2 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:12 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:16 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:20 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:12:21 [WARNING] [lib.training.trainer:363] Skipping batch 5 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:25 [WARNING] [lib.training.trainer:363] Skipping batch 6 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:31 [WARNING] [lib.training.trainer:363] Skipping batch 7 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:12:35 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:12:36 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 8: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 127.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:12:36 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 8): {'cpu_memory_mb': 5502.08984375, 'cpu_memory_gb': 5.373134613037109, 'cpu_vms_mb': 52615.47265625, 'gpu_allocated_gb': 16.305878528, 'gpu_reserved_gb': 16.439574528, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.488767488}
2025-12-12 21:12:36 [WARNING] [lib.training.pipeline:1341] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 70.19 MiB is free. Including non-PyTorch memory, this process has 15.69 GiB memory in use. Of the allocated memory 15.19 GiB is allocated by PyTorch, and 127.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: x3d, Fold: 3, Current batch size: 1
2025-12-12 21:12:37 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:12:41 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 3
2025-12-12 21:12:41 [ERROR] [lib.training.pipeline:1738] Error training fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:12:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 804eddca257c4fba864d418919fd7240
2025-12-12 21:12:41 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 4/5 (20% sample)
2025-12-12 21:12:41 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:12:42 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:12:42 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:12:42 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:12:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 39a858beb8cb47f4bce126b780b1e367 (experiment: x3d)
2025-12-12 21:12:42 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 4...
2025-12-12 21:12:46 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:12:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:12:50 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:12:51 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 4
2025-12-12 21:12:51 [ERROR] [lib.training.pipeline:1738] Error training fold 4: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:12:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 39a858beb8cb47f4bce126b780b1e367
2025-12-12 21:12:51 [INFO] [lib.training.pipeline:874] 
Hyperparameter Search - x3d - Fold 5/5 (20% sample)
2025-12-12 21:12:51 [INFO] [lib.training.pipeline:978] Training configuration - Batch size: 1, Gradient accumulation steps: 32, Effective batch size: 32
2025-12-12 21:12:51 [INFO] [lib.training.pipeline:1024] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:12:51 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:12:52 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:12:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a9c2f9c063304cb6a9a395ddffc336bc (experiment: x3d)
2025-12-12 21:12:52 [INFO] [lib.training.pipeline:1117] Training PyTorch model x3d on fold 5...
2025-12-12 21:12:56 [WARNING] [lib.training.pipeline:1206] Input dimension mismatch during forward pass test for x3d: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 142, 256]). This may indicate some videos have very small spatial dimensions. Training will handle this via error handling. Continuing...
2025-12-12 21:12:56 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:13:03 [ERROR] [lib.training.pipeline:1365] Runtime error during training: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Model: x3d, Fold: 5
2025-12-12 21:13:03 [ERROR] [lib.training.pipeline:1738] Error training fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1305, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:13:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a9c2f9c063304cb6a9a395ddffc336bc
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1797] ================================================================================
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1798] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1799] ================================================================================
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1812] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1822] Final training using default hyperparameters (no grid search)
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 1/5 (full dataset)
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:13:04 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:13:04 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:13:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1808bd8489d54828ad1a0669b91a64c5 (experiment: x3d)
2025-12-12 21:13:04 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 1 (full dataset)...
2025-12-12 21:13:04 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:13:14 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:13:15 [ERROR] [lib.training.pipeline:2200] Error training final fold 1: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:13:15 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 2/5 (full dataset)
2025-12-12 21:13:15 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:13:15 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:13:15 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:13:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2cfc5da816944d669a6bfc14fc3a2b98 (experiment: x3d)
2025-12-12 21:13:15 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 2 (full dataset)...
2025-12-12 21:13:15 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:13:25 [WARNING] [lib.training.trainer:363] Skipping batch 1 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:13:29 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:13:34 [WARNING] [lib.training.trainer:363] Skipping batch 3 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:13:39 [WARNING] [lib.training.trainer:363] Skipping batch 4 due to input dimension mismatch: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 192, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:13:43 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:13:44 [WARNING] [lib.training.trainer:363] Skipping batch 5 due to input dimension mismatch: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7). Input shape: torch.Size([1, 3, 500, 144, 256]). This may indicate videos with very small spatial dimensions.
2025-12-12 21:13:51 [ERROR] [lib.utils.memory:130] OOM error forward pass batch 6: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 40.19 MiB is free. Including non-PyTorch memory, this process has 15.72 GiB memory in use. Of the allocated memory 15.20 GiB is allocated by PyTorch, and 145.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:13:51 [INFO] [lib.utils.memory:91] Memory stats (after OOM forward pass batch 6): {'cpu_memory_mb': 5507.48828125, 'cpu_memory_gb': 5.378406524658203, 'cpu_vms_mb': 52620.47265625, 'gpu_allocated_gb': 16.318051328, 'gpu_reserved_gb': 16.471031808, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.457310208}
2025-12-12 21:13:51 [ERROR] [lib.training.pipeline:2200] Error training final fold 2: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 40.19 MiB is free. Including non-PyTorch memory, this process has 15.72 GiB memory in use. Of the allocated memory 15.20 GiB is allocated by PyTorch, and 145.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 343, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/resnet.py", line 1399, in forward
    x = res_block(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/resnet.py", line 1186, in forward
    x = self.branch_fusion(shortcut, self.branch2(x))
                                     ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/resnet.py", line 1352, in forward
    x = self.act_a(x)
        ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/activation.py", line 144, in forward
    return F.relu(input, inplace=self.inplace)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 1697, in relu
    result = torch.relu(input)
             ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 40.19 MiB is free. Including non-PyTorch memory, this process has 15.72 GiB memory in use. Of the allocated memory 15.20 GiB is allocated by PyTorch, and 145.88 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 21:13:51 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 3/5 (full dataset)
2025-12-12 21:13:51 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:13:51 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:13:52 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:13:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8eaf77414098463584071f6010e01c3c (experiment: x3d)
2025-12-12 21:13:52 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 3 (full dataset)...
2025-12-12 21:13:52 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:13:56 [ERROR] [lib.training.pipeline:2200] Error training final fold 3: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    return self.backbone(x)
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 6 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:13:56 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 4/5 (full dataset)
2025-12-12 21:13:57 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:13:57 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:13:57 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:13:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7a220fcc1ac2465ea8b01c15767dff97 (experiment: x3d)
2025-12-12 21:13:57 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 4 (full dataset)...
2025-12-12 21:13:57 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:14:00 [INFO] [lib.models.video:448] Chunk size increased from 30 to 40 (after 3 successes, increment: 10)
2025-12-12 21:14:01 [ERROR] [lib.training.pipeline:2200] Error training final fold 4: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    try:
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    warmup_progress = epoch / train_cfg.warmup_epochs
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    # X3D requires minimum spatial dimensions (32x32) for pooling kernels
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:14:01 [INFO] [lib.training.pipeline:1826] 
Final Training - x3d - Fold 5/5 (full dataset)
2025-12-12 21:14:01 [INFO] [lib.training.pipeline:1935] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:14:01 [INFO] [lib.training.x3d:47] Loading X3D model from PyTorchVideo: x3d_m (pretrained=True)
2025-12-12 21:14:02 [INFO] [lib.training.x3d:106] ✓ Successfully loaded X3D model from PyTorchVideo: x3d_m
2025-12-12 21:14:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4dfb102127cf48fcba6e4fc767e0aff6 (experiment: x3d)
2025-12-12 21:14:02 [INFO] [lib.training.pipeline:2000] Training PyTorch model x3d on fold 5 (full dataset)...
2025-12-12 21:14:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:14:06 [ERROR] [lib.training.pipeline:2200] Error training final fold 5: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2006, in stage5_train_models
    try:
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 672, in fit
    warmup_progress = epoch / train_cfg.warmup_epochs
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 331, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/x3d.py", line 176, in forward
    # X3D requires minimum spatial dimensions (32x32) for pooling kernels
           ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/net.py", line 43, in forward
    x = block(x)
        ^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/head.py", line 374, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/urvim/.cache/torch/hub/facebookresearch_pytorchvideo_main/pytorchvideo/models/x3d.py", line 799, in forward
    x = self.pool(x)
        ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/pooling.py", line 898, in forward
    return F.avg_pool3d(
           ^^^^^^^^^^^^^
RuntimeError: input image (T: 500 H: 5 W: 8) smaller than kernel size (kT: 16 kH: 7 kW: 7)
2025-12-12 21:14:06 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/fold_1 to copy
2025-12-12 21:14:06 [INFO] [lib.training.pipeline:2273] 
x3d - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 21:14:08 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots/cv_fold_comparison.png
2025-12-12 21:14:08 [INFO] [lib.training.pipeline:2301] Generated plots for x3d in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/x3d/plots
2025-12-12 21:14:09 [INFO] [lib.training.pipeline:2338] ================================================================================
2025-12-12 21:14:09 [INFO] [lib.training.pipeline:2339] Stage 5: Model Training Pipeline Completed
2025-12-12 21:14:09 [INFO] [lib.training.pipeline:2340] ================================================================================
2025-12-12 21:14:09 [INFO] [__main__:401] ================================================================================
2025-12-12 21:14:09 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 21:14:09 [INFO] [__main__:403] ================================================================================
2025-12-12 21:14:09 [INFO] [__main__:404] Execution time: 1098.39 seconds (18.31 minutes)
2025-12-12 21:14:09 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 21:14:09 [INFO] [__main__:407] Models trained: ['x3d']
2025-12-12 21:14:09 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 21:14:09 [INFO] [__main__:414] ================================================================================
2025-12-12 21:14:09 [INFO] [__main__:415] Final memory statistics:
2025-12-12 21:14:09 [INFO] [__main__:416] ================================================================================
2025-12-12 21:14:09 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 5505.90625, 'cpu_memory_gb': 5.376861572265625, 'cpu_vms_mb': 52650.03515625, 'gpu_allocated_gb': 0.01703936, 'gpu_reserved_gb': 0.396361728, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.531980288}
2025-12-12 21:14:09 [INFO] [__main__:419] ================================================================================
2025-12-12 21:14:09 [INFO] [__main__:420] Training complete!
2025-12-12 21:14:09 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 21:14:09 [INFO] [__main__:422] ================================================================================
