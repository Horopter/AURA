2025-12-12 21:51:50 [INFO] [__main__:310] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 21:51:50 [INFO] [__main__:312] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 21:51:50 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 21:51:50 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 21:51:50 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 21:51:50 [INFO] [__main__:317] Model types: ['slowfast']
2025-12-12 21:51:50 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 21:51:50 [INFO] [__main__:319] Number of frames: 500
2025-12-12 21:51:50 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 21:51:50 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 21:51:50 [INFO] [__main__:324] Delete existing: False
2025-12-12 21:51:50 [INFO] [__main__:325] Resume mode: True
2025-12-12 21:51:50 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765594310.log
2025-12-12 21:51:50 [INFO] [__main__:333] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 21:51:50 [INFO] [__main__:335] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 21:51:50 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 21:51:50 [INFO] [__main__:358] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 21:51:50 [INFO] [__main__:360] ================================================================================
2025-12-12 21:51:50 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.63671875, 'cpu_memory_gb': 0.7193717956542969, 'cpu_vms_mb': 10219.25390625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 21:51:50 [INFO] [__main__:364] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 21:51:50 [INFO] [__main__:366] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 21:51:50 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 21:51:50 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 21:51:50 [INFO] [__main__:370] ================================================================================
2025-12-12 21:51:50 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 21:51:50 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:499] Model types: ['slowfast']
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:501] Frames per video: 500
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 21:51:50 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 21:51:51 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:333] ✓ slowfast: CAN RUN
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:346]   ['slowfast']
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 21:51:52 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=832734.78GB, used=1667105.22GB (66.7%)
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:705] Enabling adaptive chunked frame loading for slowfast: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:788] 
================================================================================
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:789] Stage 5: Training model: slowfast
2025-12-12 21:51:52 [INFO] [lib.training.pipeline:790] ================================================================================
2025-12-12 21:51:53 [INFO] [lib.training.pipeline:823] Grid search: 32 hyperparameter combinations to try
2025-12-12 21:51:53 [INFO] [lib.training.pipeline:831] ================================================================================
2025-12-12 21:51:53 [INFO] [lib.training.pipeline:832] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 21:51:53 [INFO] [lib.training.pipeline:833] ================================================================================
2025-12-12 21:51:54 [INFO] [lib.training.pipeline:842] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:855] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 1/32
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:51:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:51:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:51:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:51:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 60d43d0a0ae84450baaf563524a77574 (experiment: slowfast)
2025-12-12 21:52:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:07 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 60d43d0a0ae84450baaf563524a77574
2025-12-12 21:52:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 06a217a926184fbcaa964f65112983f4 (experiment: slowfast)
2025-12-12 21:52:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 06a217a926184fbcaa964f65112983f4
2025-12-12 21:52:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 84f03bccf03a47c4a72f7e8d1865f364 (experiment: slowfast)
2025-12-12 21:52:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:52:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 84f03bccf03a47c4a72f7e8d1865f364
2025-12-12 21:52:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:52:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ec52bd5b31e4971b3f9e420e89a3953 (experiment: slowfast)
2025-12-12 21:52:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:52:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ec52bd5b31e4971b3f9e420e89a3953
2025-12-12 21:52:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:52:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 868ca43599fe443ebbe2ee8181e40013 (experiment: slowfast)
2025-12-12 21:52:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:52:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 868ca43599fe443ebbe2ee8181e40013
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 2/32
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d5094b59946548b69c3c6256e7d6aa7b (experiment: slowfast)
2025-12-12 21:52:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d5094b59946548b69c3c6256e7d6aa7b
2025-12-12 21:52:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ba36fe7bc02746278b897592edeae19e (experiment: slowfast)
2025-12-12 21:52:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ba36fe7bc02746278b897592edeae19e
2025-12-12 21:52:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8236f6b40f9e4b13ae273e1d777949b3 (experiment: slowfast)
2025-12-12 21:52:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:52:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8236f6b40f9e4b13ae273e1d777949b3
2025-12-12 21:52:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:52:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8fcc18ccb4214463b1cc93e9093b79b6 (experiment: slowfast)
2025-12-12 21:52:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:52:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:23 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8fcc18ccb4214463b1cc93e9093b79b6
2025-12-12 21:52:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:52:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f373882aa1d7463e9251e3d5cf960a02 (experiment: slowfast)
2025-12-12 21:52:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:52:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:25 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f373882aa1d7463e9251e3d5cf960a02
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 3/32
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:52:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8c657793650448118b7994408a4768d3 (experiment: slowfast)
2025-12-12 21:52:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:27 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8c657793650448118b7994408a4768d3
2025-12-12 21:52:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5cb6798bf737487bbb6f6c90d94aeafc (experiment: slowfast)
2025-12-12 21:52:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:28 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5cb6798bf737487bbb6f6c90d94aeafc
2025-12-12 21:52:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aa303809b43540878d64e34e1e1bee2c (experiment: slowfast)
2025-12-12 21:52:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:52:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:30 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aa303809b43540878d64e34e1e1bee2c
2025-12-12 21:52:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:52:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5707c4eb32fd4e05a37bcbe99c869d1b (experiment: slowfast)
2025-12-12 21:52:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:52:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:33 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5707c4eb32fd4e05a37bcbe99c869d1b
2025-12-12 21:52:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:52:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2110f566f935498ea0a3f943324596c2 (experiment: slowfast)
2025-12-12 21:52:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:52:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:35 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2110f566f935498ea0a3f943324596c2
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 4/32
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 45b3296fcdee4bcc9d715d4edca92dd5 (experiment: slowfast)
2025-12-12 21:52:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:37 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 45b3296fcdee4bcc9d715d4edca92dd5
2025-12-12 21:52:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8b3797eedfc5414baddf5851b4b9472f (experiment: slowfast)
2025-12-12 21:52:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:38 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8b3797eedfc5414baddf5851b4b9472f
2025-12-12 21:52:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7aec65034363495e9943db418fbce38c (experiment: slowfast)
2025-12-12 21:52:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:52:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:40 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7aec65034363495e9943db418fbce38c
2025-12-12 21:52:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:52:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4c770f5a009d41d795d0498ad9a9ab0f (experiment: slowfast)
2025-12-12 21:52:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:52:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:42 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4c770f5a009d41d795d0498ad9a9ab0f
2025-12-12 21:52:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:52:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 284bbdc094f84246986875e74b0c7680 (experiment: slowfast)
2025-12-12 21:52:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:52:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:44 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 284bbdc094f84246986875e74b0c7680
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 5/32
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7fae421f98294fb4a9c7cfa66e10bda5 (experiment: slowfast)
2025-12-12 21:52:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:46 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7fae421f98294fb4a9c7cfa66e10bda5
2025-12-12 21:52:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 002cfc3cccbd4fcfaa7f4d2b4722fc0a (experiment: slowfast)
2025-12-12 21:52:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:48 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 002cfc3cccbd4fcfaa7f4d2b4722fc0a
2025-12-12 21:52:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a41e883d27a1476c859fbd72bb3ddcdf (experiment: slowfast)
2025-12-12 21:52:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:52:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:50 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a41e883d27a1476c859fbd72bb3ddcdf
2025-12-12 21:52:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:52:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b90ab08b6f4b499d94bc7024c51076ac (experiment: slowfast)
2025-12-12 21:52:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:52:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:52 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b90ab08b6f4b499d94bc7024c51076ac
2025-12-12 21:52:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:52:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:52:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1a21ac9602644300bee895e4d1c2ed7f (experiment: slowfast)
2025-12-12 21:52:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:52:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:54 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1a21ac9602644300bee895e4d1c2ed7f
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 6/32
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5cd21ce760c5448bb6f715c6554f2a02 (experiment: slowfast)
2025-12-12 21:52:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:52:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:56 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5cd21ce760c5448bb6f715c6554f2a02
2025-12-12 21:52:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:52:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 177b3726ac7f4f498a9b91f4e646092f (experiment: slowfast)
2025-12-12 21:52:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:52:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:52:57 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:52:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 177b3726ac7f4f498a9b91f4e646092f
2025-12-12 21:52:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:52:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:52:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:52:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:52:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:52:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:52:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 96183e7251bc410d8f56b6b09e50197f (experiment: slowfast)
2025-12-12 21:52:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:00 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 96183e7251bc410d8f56b6b09e50197f
2025-12-12 21:53:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 25f0635e101448e2890d6d8c7a582d08 (experiment: slowfast)
2025-12-12 21:53:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:02 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 25f0635e101448e2890d6d8c7a582d08
2025-12-12 21:53:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 077bdda465a047fda99508581a8e673b (experiment: slowfast)
2025-12-12 21:53:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:04 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 077bdda465a047fda99508581a8e673b
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 7/32
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 779f8e258aef45ef91604949242612c7 (experiment: slowfast)
2025-12-12 21:53:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:06 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 779f8e258aef45ef91604949242612c7
2025-12-12 21:53:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bbf6d08ff00b49b2ac0fe9882f604a4f (experiment: slowfast)
2025-12-12 21:53:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:07 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bbf6d08ff00b49b2ac0fe9882f604a4f
2025-12-12 21:53:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 337c6c3d5a6e464a8e4c58c0ae92f34b (experiment: slowfast)
2025-12-12 21:53:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:09 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 337c6c3d5a6e464a8e4c58c0ae92f34b
2025-12-12 21:53:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0967098e834347c6b84a6c88b9a3f71b (experiment: slowfast)
2025-12-12 21:53:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:11 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0967098e834347c6b84a6c88b9a3f71b
2025-12-12 21:53:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6b0e4606c15548bbbcd26498bb99650b (experiment: slowfast)
2025-12-12 21:53:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:13 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6b0e4606c15548bbbcd26498bb99650b
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 8/32
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 91dcf7a80db443128af0d35e35f50065 (experiment: slowfast)
2025-12-12 21:53:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:15 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 91dcf7a80db443128af0d35e35f50065
2025-12-12 21:53:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 466163dd3b0e4169aaedef08073fb1c4 (experiment: slowfast)
2025-12-12 21:53:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:17 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 466163dd3b0e4169aaedef08073fb1c4
2025-12-12 21:53:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 50cff1848cf443a598d52b507d3d9f1a (experiment: slowfast)
2025-12-12 21:53:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:19 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 50cff1848cf443a598d52b507d3d9f1a
2025-12-12 21:53:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 58501dfb6a5a4d699f8b77a241bc67b2 (experiment: slowfast)
2025-12-12 21:53:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:21 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 58501dfb6a5a4d699f8b77a241bc67b2
2025-12-12 21:53:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 45ceeadc8e974c37bdbd360bfc150558 (experiment: slowfast)
2025-12-12 21:53:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:23 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 45ceeadc8e974c37bdbd360bfc150558
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 9/32
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 55d880c0dec44070b2e552c8da918b01 (experiment: slowfast)
2025-12-12 21:53:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:25 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 55d880c0dec44070b2e552c8da918b01
2025-12-12 21:53:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26d78fb98d664956b97ff17ea783e479 (experiment: slowfast)
2025-12-12 21:53:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:26 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26d78fb98d664956b97ff17ea783e479
2025-12-12 21:53:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 00b6ef2611e64cdd96c3fd409401506b (experiment: slowfast)
2025-12-12 21:53:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:28 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 00b6ef2611e64cdd96c3fd409401506b
2025-12-12 21:53:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d49b411860d04ad39e98f5a38b121659 (experiment: slowfast)
2025-12-12 21:53:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:30 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d49b411860d04ad39e98f5a38b121659
2025-12-12 21:53:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 41b83e3ef5924199bc3f2addac29c0d2 (experiment: slowfast)
2025-12-12 21:53:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:32 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 41b83e3ef5924199bc3f2addac29c0d2
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 10/32
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 69c97dfe8e714f6ebd366c8fde0b3e22 (experiment: slowfast)
2025-12-12 21:53:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:34 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 69c97dfe8e714f6ebd366c8fde0b3e22
2025-12-12 21:53:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5f5d77bbe829416e96ec457a39e887e3 (experiment: slowfast)
2025-12-12 21:53:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5f5d77bbe829416e96ec457a39e887e3
2025-12-12 21:53:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1985ac232aa94e749f6ace543b34ba00 (experiment: slowfast)
2025-12-12 21:53:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1985ac232aa94e749f6ace543b34ba00
2025-12-12 21:53:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8da5b12a57a04f4987bba85af44228a3 (experiment: slowfast)
2025-12-12 21:53:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8da5b12a57a04f4987bba85af44228a3
2025-12-12 21:53:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1ba78fc7954941ff8962278e699209b5 (experiment: slowfast)
2025-12-12 21:53:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1ba78fc7954941ff8962278e699209b5
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 11/32
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bedb5ca620924170a62863d62fbf56d6 (experiment: slowfast)
2025-12-12 21:53:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:44 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bedb5ca620924170a62863d62fbf56d6
2025-12-12 21:53:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 82265373d7ec49dca11ca239d2a1f078 (experiment: slowfast)
2025-12-12 21:53:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:45 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 82265373d7ec49dca11ca239d2a1f078
2025-12-12 21:53:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b437f0caa06a4bf3b5acb6d52cb09c54 (experiment: slowfast)
2025-12-12 21:53:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:47 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b437f0caa06a4bf3b5acb6d52cb09c54
2025-12-12 21:53:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ece504d87b949c4bbc78aa36500d42e (experiment: slowfast)
2025-12-12 21:53:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:53:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:49 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ece504d87b949c4bbc78aa36500d42e
2025-12-12 21:53:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:53:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:53:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0801c122a0534cceb31d9000f0417208 (experiment: slowfast)
2025-12-12 21:53:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:53:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:51 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0801c122a0534cceb31d9000f0417208
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 12/32
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dd9fa9533f3d40639f8d4f7986b6c206 (experiment: slowfast)
2025-12-12 21:53:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:53:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:53 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dd9fa9533f3d40639f8d4f7986b6c206
2025-12-12 21:53:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:53:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9385c0edc61c42858edf5e3548e81182 (experiment: slowfast)
2025-12-12 21:53:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:53:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:55 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9385c0edc61c42858edf5e3548e81182
2025-12-12 21:53:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:53:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 759a90e5ecdf4686a5d77d301c39b087 (experiment: slowfast)
2025-12-12 21:53:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:53:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:53:57 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:53:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 759a90e5ecdf4686a5d77d301c39b087
2025-12-12 21:53:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:53:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:53:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:53:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:53:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:53:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:53:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e0e5beaf2b814fac9e07fd399a909253 (experiment: slowfast)
2025-12-12 21:53:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:00 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e0e5beaf2b814fac9e07fd399a909253
2025-12-12 21:54:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e7cdefe5f5ef43d4bfd4bce8f15019e3 (experiment: slowfast)
2025-12-12 21:54:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:02 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e7cdefe5f5ef43d4bfd4bce8f15019e3
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 13/32
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a72fa4a6b6214b0d82ebf9f0b800209d (experiment: slowfast)
2025-12-12 21:54:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:04 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a72fa4a6b6214b0d82ebf9f0b800209d
2025-12-12 21:54:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 32f16d0175604105b27616cb58d26adb (experiment: slowfast)
2025-12-12 21:54:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:05 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 32f16d0175604105b27616cb58d26adb
2025-12-12 21:54:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 49b52b48fd434ca9af21515e9fe0dfe7 (experiment: slowfast)
2025-12-12 21:54:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:07 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 49b52b48fd434ca9af21515e9fe0dfe7
2025-12-12 21:54:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3a8c5232b85148c2941d5a5368f75c0e (experiment: slowfast)
2025-12-12 21:54:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:09 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3a8c5232b85148c2941d5a5368f75c0e
2025-12-12 21:54:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: af1af38a0a66425c8d93208dc2c3836a (experiment: slowfast)
2025-12-12 21:54:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:11 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: af1af38a0a66425c8d93208dc2c3836a
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 14/32
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 787e7e4afca140d298af9a86fc865d4e (experiment: slowfast)
2025-12-12 21:54:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:13 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 787e7e4afca140d298af9a86fc865d4e
2025-12-12 21:54:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bebd1360a9234bdca651128f20a8108e (experiment: slowfast)
2025-12-12 21:54:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:15 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bebd1360a9234bdca651128f20a8108e
2025-12-12 21:54:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a92632a65d7f4e4a9112e272ec9381ef (experiment: slowfast)
2025-12-12 21:54:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:17 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a92632a65d7f4e4a9112e272ec9381ef
2025-12-12 21:54:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b9d3a704dff4429ea7262cdc2c4c68bf (experiment: slowfast)
2025-12-12 21:54:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:19 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b9d3a704dff4429ea7262cdc2c4c68bf
2025-12-12 21:54:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0b5f86b677b0421b8351190c29a3ad0d (experiment: slowfast)
2025-12-12 21:54:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:21 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0b5f86b677b0421b8351190c29a3ad0d
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 15/32
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2eef2a471494428aa812b632876c7226 (experiment: slowfast)
2025-12-12 21:54:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:23 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2eef2a471494428aa812b632876c7226
2025-12-12 21:54:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93618ff05126450b8b31deaecc1d3678 (experiment: slowfast)
2025-12-12 21:54:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:24 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93618ff05126450b8b31deaecc1d3678
2025-12-12 21:54:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ffbdfc975c434f388a1f0c24dbe15b11 (experiment: slowfast)
2025-12-12 21:54:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:26 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ffbdfc975c434f388a1f0c24dbe15b11
2025-12-12 21:54:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0174e48d3b3d4e2ea4819f581b4be9a5 (experiment: slowfast)
2025-12-12 21:54:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:28 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0174e48d3b3d4e2ea4819f581b4be9a5
2025-12-12 21:54:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6365339141c84188a6315175cef80b33 (experiment: slowfast)
2025-12-12 21:54:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:30 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6365339141c84188a6315175cef80b33
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 16/32
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: faf741074bbd45c49ec0dabb4c424220 (experiment: slowfast)
2025-12-12 21:54:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:32 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: faf741074bbd45c49ec0dabb4c424220
2025-12-12 21:54:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5927cae2247148cf973c643914acf5d6 (experiment: slowfast)
2025-12-12 21:54:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:34 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5927cae2247148cf973c643914acf5d6
2025-12-12 21:54:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9e3bac56278149f6b6cf87dd1ec91605 (experiment: slowfast)
2025-12-12 21:54:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:36 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9e3bac56278149f6b6cf87dd1ec91605
2025-12-12 21:54:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2189f1618e544f289388b2ad2611606f (experiment: slowfast)
2025-12-12 21:54:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:38 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2189f1618e544f289388b2ad2611606f
2025-12-12 21:54:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7a127e6daae747d1bbd557afa5a669d2 (experiment: slowfast)
2025-12-12 21:54:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:40 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7a127e6daae747d1bbd557afa5a669d2
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 17/32
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bd652768acfa4eb1991788bad3a6fca1 (experiment: slowfast)
2025-12-12 21:54:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:42 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bd652768acfa4eb1991788bad3a6fca1
2025-12-12 21:54:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5f25b50d77034e78a246b2e8426aa2a2 (experiment: slowfast)
2025-12-12 21:54:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:43 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5f25b50d77034e78a246b2e8426aa2a2
2025-12-12 21:54:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 76ad5708d7f04d72bb15a01b728c364e (experiment: slowfast)
2025-12-12 21:54:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:45 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 76ad5708d7f04d72bb15a01b728c364e
2025-12-12 21:54:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 08475c105d2a474ba43e9507360fbccb (experiment: slowfast)
2025-12-12 21:54:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:47 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 08475c105d2a474ba43e9507360fbccb
2025-12-12 21:54:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 003fac364be24a24815fa65b709c3316 (experiment: slowfast)
2025-12-12 21:54:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:49 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 003fac364be24a24815fa65b709c3316
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 18/32
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7a272da885a44dbd94616b0326911c14 (experiment: slowfast)
2025-12-12 21:54:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:54:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:51 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7a272da885a44dbd94616b0326911c14
2025-12-12 21:54:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:54:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6f9bda3686154da38eb6662bda86fe90 (experiment: slowfast)
2025-12-12 21:54:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:54:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:53 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6f9bda3686154da38eb6662bda86fe90
2025-12-12 21:54:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:54:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ff9b59199be945efb19bea5cbf250b8d (experiment: slowfast)
2025-12-12 21:54:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:54:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:55 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ff9b59199be945efb19bea5cbf250b8d
2025-12-12 21:54:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:54:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a8fd0dca582e477f8da9e26d7df34d17 (experiment: slowfast)
2025-12-12 21:54:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:54:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:57 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a8fd0dca582e477f8da9e26d7df34d17
2025-12-12 21:54:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:54:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:54:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:54:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:54:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c6e002e48c2d427eb201fd5f1622bc7a (experiment: slowfast)
2025-12-12 21:54:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:54:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:54:59 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:54:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c6e002e48c2d427eb201fd5f1622bc7a
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 19/32
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:54:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:54:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:54:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d7f4b2d9f3ca4de0952b997551677e08 (experiment: slowfast)
2025-12-12 21:55:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:01 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d7f4b2d9f3ca4de0952b997551677e08
2025-12-12 21:55:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c054d5fc113d4275ba0a69921b1d7c2d (experiment: slowfast)
2025-12-12 21:55:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:02 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c054d5fc113d4275ba0a69921b1d7c2d
2025-12-12 21:55:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bca2a33442ce404a8bfc840a54f7c85e (experiment: slowfast)
2025-12-12 21:55:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:04 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bca2a33442ce404a8bfc840a54f7c85e
2025-12-12 21:55:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d9cbc3daae114c649d56247f1a65a78f (experiment: slowfast)
2025-12-12 21:55:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:06 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d9cbc3daae114c649d56247f1a65a78f
2025-12-12 21:55:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e82115fbb5cc4cc1bdca73ee2e5a0f34 (experiment: slowfast)
2025-12-12 21:55:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:08 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e82115fbb5cc4cc1bdca73ee2e5a0f34
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 20/32
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cb3dedd20e3942b2938cb179a800c693 (experiment: slowfast)
2025-12-12 21:55:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:10 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cb3dedd20e3942b2938cb179a800c693
2025-12-12 21:55:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3e35b8383b674c748a54809dbe93ce5d (experiment: slowfast)
2025-12-12 21:55:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:12 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3e35b8383b674c748a54809dbe93ce5d
2025-12-12 21:55:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 905eea58fa0d4f76b9f4f06e61728d28 (experiment: slowfast)
2025-12-12 21:55:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:14 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 905eea58fa0d4f76b9f4f06e61728d28
2025-12-12 21:55:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1be12bc90b8e44b2be46fb8f19ef5252 (experiment: slowfast)
2025-12-12 21:55:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:16 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1be12bc90b8e44b2be46fb8f19ef5252
2025-12-12 21:55:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 78453c4ed8be4076a08b58d368441693 (experiment: slowfast)
2025-12-12 21:55:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:18 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 78453c4ed8be4076a08b58d368441693
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 21/32
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2c74dda8dd3646e3973d0343c0dfa8dd (experiment: slowfast)
2025-12-12 21:55:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:20 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2c74dda8dd3646e3973d0343c0dfa8dd
2025-12-12 21:55:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7c20985000f14647bac08ab0fc085281 (experiment: slowfast)
2025-12-12 21:55:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:21 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7c20985000f14647bac08ab0fc085281
2025-12-12 21:55:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: af19c218ef9f40528f2ff569d51a4c35 (experiment: slowfast)
2025-12-12 21:55:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:23 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: af19c218ef9f40528f2ff569d51a4c35
2025-12-12 21:55:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1e3ea5168cd0449db55b53a54e982097 (experiment: slowfast)
2025-12-12 21:55:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:25 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1e3ea5168cd0449db55b53a54e982097
2025-12-12 21:55:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fa46785ecb4d42ff9c3d4621e9cad38a (experiment: slowfast)
2025-12-12 21:55:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:27 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fa46785ecb4d42ff9c3d4621e9cad38a
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 22/32
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7c6c963eb3f24263b389287f1575e508 (experiment: slowfast)
2025-12-12 21:55:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:29 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7c6c963eb3f24263b389287f1575e508
2025-12-12 21:55:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36408a40b6c749899545b7469a3e7504 (experiment: slowfast)
2025-12-12 21:55:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:31 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36408a40b6c749899545b7469a3e7504
2025-12-12 21:55:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e01b110b48e04ed5bb80a3823b565979 (experiment: slowfast)
2025-12-12 21:55:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:33 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e01b110b48e04ed5bb80a3823b565979
2025-12-12 21:55:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 97eaf62cefa54ac293bd696a012b75a4 (experiment: slowfast)
2025-12-12 21:55:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:35 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 97eaf62cefa54ac293bd696a012b75a4
2025-12-12 21:55:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 37dab788e8ff410bb7ca2727b40158a6 (experiment: slowfast)
2025-12-12 21:55:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:37 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 37dab788e8ff410bb7ca2727b40158a6
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 23/32
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 01b3dd0ddafc48e8982e7b244daf5e14 (experiment: slowfast)
2025-12-12 21:55:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:39 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 01b3dd0ddafc48e8982e7b244daf5e14
2025-12-12 21:55:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 70e33f73550c4d8aa9eb608bc1b3387a (experiment: slowfast)
2025-12-12 21:55:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:40 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 70e33f73550c4d8aa9eb608bc1b3387a
2025-12-12 21:55:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a29a28d03e0644de923b0a545d51c1df (experiment: slowfast)
2025-12-12 21:55:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:42 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a29a28d03e0644de923b0a545d51c1df
2025-12-12 21:55:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: afb9471abe1f48019a1c9c07ce256080 (experiment: slowfast)
2025-12-12 21:55:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:44 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: afb9471abe1f48019a1c9c07ce256080
2025-12-12 21:55:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9ecbd7e2c14a456ab1011e21a8558de1 (experiment: slowfast)
2025-12-12 21:55:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:46 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9ecbd7e2c14a456ab1011e21a8558de1
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 24/32
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 51156a66b524484e8d852956f37746a5 (experiment: slowfast)
2025-12-12 21:55:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:48 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 51156a66b524484e8d852956f37746a5
2025-12-12 21:55:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d5104be786f347858604ff819880579a (experiment: slowfast)
2025-12-12 21:55:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:50 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d5104be786f347858604ff819880579a
2025-12-12 21:55:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:55:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aa4a1d21dc99464896d77ca3850820bc (experiment: slowfast)
2025-12-12 21:55:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:55:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:52 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aa4a1d21dc99464896d77ca3850820bc
2025-12-12 21:55:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:55:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e683b1d713f04dbe8c9541755e65c18a (experiment: slowfast)
2025-12-12 21:55:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:55:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:54 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e683b1d713f04dbe8c9541755e65c18a
2025-12-12 21:55:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:55:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:55:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6b21fb869ae34602ab2e85af1f225405 (experiment: slowfast)
2025-12-12 21:55:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:55:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:56 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6b21fb869ae34602ab2e85af1f225405
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 25/32
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9b0e566e14264351b3ff2baa373797c9 (experiment: slowfast)
2025-12-12 21:55:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:55:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:58 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9b0e566e14264351b3ff2baa373797c9
2025-12-12 21:55:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:55:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:55:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:55:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:55:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:55:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:55:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b19524115926448aa18fca119eba167e (experiment: slowfast)
2025-12-12 21:55:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:55:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:55:59 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:55:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b19524115926448aa18fca119eba167e
2025-12-12 21:56:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e2e2b19552e04257afa695e8dd5833ea (experiment: slowfast)
2025-12-12 21:56:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:02 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e2e2b19552e04257afa695e8dd5833ea
2025-12-12 21:56:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5e19f4868a0a4370a8085b0a35011a76 (experiment: slowfast)
2025-12-12 21:56:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:04 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5e19f4868a0a4370a8085b0a35011a76
2025-12-12 21:56:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 54f2c9a2079b47b19a66b81c855995b2 (experiment: slowfast)
2025-12-12 21:56:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:06 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 54f2c9a2079b47b19a66b81c855995b2
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 26/32
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6200d07dce194443b250992c9903795b (experiment: slowfast)
2025-12-12 21:56:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6200d07dce194443b250992c9903795b
2025-12-12 21:56:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5ab5b789e07e4199aa75e8aa78a8f65f (experiment: slowfast)
2025-12-12 21:56:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5ab5b789e07e4199aa75e8aa78a8f65f
2025-12-12 21:56:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 47c6769bd73c4ed1ab6e1679f320ff43 (experiment: slowfast)
2025-12-12 21:56:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 47c6769bd73c4ed1ab6e1679f320ff43
2025-12-12 21:56:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b678abfb5c6746fd8fce10f5eb354dd1 (experiment: slowfast)
2025-12-12 21:56:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b678abfb5c6746fd8fce10f5eb354dd1
2025-12-12 21:56:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d4bd5ce0218a465b994b27a548443b15 (experiment: slowfast)
2025-12-12 21:56:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d4bd5ce0218a465b994b27a548443b15
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 27/32
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36d0cb0977264ff591b4bf7f3d202243 (experiment: slowfast)
2025-12-12 21:56:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36d0cb0977264ff591b4bf7f3d202243
2025-12-12 21:56:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 624fd038161e4c91a913c62e579bcbb1 (experiment: slowfast)
2025-12-12 21:56:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 624fd038161e4c91a913c62e579bcbb1
2025-12-12 21:56:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6eb76d6eef204b4f92cd44545a9d147c (experiment: slowfast)
2025-12-12 21:56:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:20 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6eb76d6eef204b4f92cd44545a9d147c
2025-12-12 21:56:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aba3ef68efdd450ca9c503f25958eb5c (experiment: slowfast)
2025-12-12 21:56:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:22 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aba3ef68efdd450ca9c503f25958eb5c
2025-12-12 21:56:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bbfe41be5fc64139b04c50f5f76d83fc (experiment: slowfast)
2025-12-12 21:56:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:25 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bbfe41be5fc64139b04c50f5f76d83fc
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 28/32
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 781f25d19eff49dbbb9cf531cd1e376f (experiment: slowfast)
2025-12-12 21:56:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:27 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 781f25d19eff49dbbb9cf531cd1e376f
2025-12-12 21:56:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9249b59c1db7497f8878283fc6f5b687 (experiment: slowfast)
2025-12-12 21:56:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:28 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9249b59c1db7497f8878283fc6f5b687
2025-12-12 21:56:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 73a39165a9d347f5a98979ee19f91e6c (experiment: slowfast)
2025-12-12 21:56:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:30 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 73a39165a9d347f5a98979ee19f91e6c
2025-12-12 21:56:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f16d145b4037471e90d93ada150ee61b (experiment: slowfast)
2025-12-12 21:56:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:32 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f16d145b4037471e90d93ada150ee61b
2025-12-12 21:56:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6a76c985c16b49ed96c4c9996de9616d (experiment: slowfast)
2025-12-12 21:56:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:34 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6a76c985c16b49ed96c4c9996de9616d
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 29/32
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 867c34b7d9f7469c92739c8b94e19353 (experiment: slowfast)
2025-12-12 21:56:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:36 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 867c34b7d9f7469c92739c8b94e19353
2025-12-12 21:56:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 042b6cd1b17f4725847651c2451429a8 (experiment: slowfast)
2025-12-12 21:56:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:37 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 042b6cd1b17f4725847651c2451429a8
2025-12-12 21:56:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e052d649e5134afcb17c2ae7836e4589 (experiment: slowfast)
2025-12-12 21:56:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:39 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e052d649e5134afcb17c2ae7836e4589
2025-12-12 21:56:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 266300a82a4045e982d699a3aa4ed49d (experiment: slowfast)
2025-12-12 21:56:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:41 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 266300a82a4045e982d699a3aa4ed49d
2025-12-12 21:56:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cfe412cb7a824d1e98041b3130e9ba95 (experiment: slowfast)
2025-12-12 21:56:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:43 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cfe412cb7a824d1e98041b3130e9ba95
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 30/32
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 48ba149e39124af48867228ea88cac72 (experiment: slowfast)
2025-12-12 21:56:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:45 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 48ba149e39124af48867228ea88cac72
2025-12-12 21:56:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4a0a4a1053eb4947aa18b0ed384e6516 (experiment: slowfast)
2025-12-12 21:56:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:47 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4a0a4a1053eb4947aa18b0ed384e6516
2025-12-12 21:56:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 06411b243f3345668f686a512280a28e (experiment: slowfast)
2025-12-12 21:56:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:49 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 06411b243f3345668f686a512280a28e
2025-12-12 21:56:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2e9fc74d7082452597ff07e3c1652025 (experiment: slowfast)
2025-12-12 21:56:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:56:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:51 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2e9fc74d7082452597ff07e3c1652025
2025-12-12 21:56:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:56:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:56:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e7e65efe04b14247b6da875a28fc1082 (experiment: slowfast)
2025-12-12 21:56:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:56:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:53 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e7e65efe04b14247b6da875a28fc1082
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 31/32
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:56:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f4ce8f2462404150a3ae471444dfec0a (experiment: slowfast)
2025-12-12 21:56:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:56:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:55 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f4ce8f2462404150a3ae471444dfec0a
2025-12-12 21:56:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:56:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a79f52e31ff843eb8b56e863a19e2262 (experiment: slowfast)
2025-12-12 21:56:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:56:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:56 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a79f52e31ff843eb8b56e863a19e2262
2025-12-12 21:56:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:56:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:56:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:56:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 60b57cd141ba455588c03a58d556fad5 (experiment: slowfast)
2025-12-12 21:56:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:56:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:56:58 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:56:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 60b57cd141ba455588c03a58d556fad5
2025-12-12 21:56:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:56:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:56:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:56:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:56:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 86f567a25ad74eacbc3dd4097ecac56e (experiment: slowfast)
2025-12-12 21:57:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:57:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:00 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 86f567a25ad74eacbc3dd4097ecac56e
2025-12-12 21:57:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:57:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 21:57:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 84cb52eff6574818b61bb3dd66a0eb3d (experiment: slowfast)
2025-12-12 21:57:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:57:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:03 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 84cb52eff6574818b61bb3dd66a0eb3d
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 32/32
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:57:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 326a8dad0d034af2afdbe4e6019b8e4b (experiment: slowfast)
2025-12-12 21:57:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 21:57:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:05 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 326a8dad0d034af2afdbe4e6019b8e4b
2025-12-12 21:57:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 21:57:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:57:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 530ba1425093450ebd78c0141ffab029 (experiment: slowfast)
2025-12-12 21:57:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 21:57:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:06 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 530ba1425093450ebd78c0141ffab029
2025-12-12 21:57:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 21:57:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:57:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f10da59aedd2404cabde85573c821727 (experiment: slowfast)
2025-12-12 21:57:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 21:57:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:08 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f10da59aedd2404cabde85573c821727
2025-12-12 21:57:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 21:57:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:57:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 60dce032430b477298fe438a46d715b0 (experiment: slowfast)
2025-12-12 21:57:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 21:57:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:10 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 60dce032430b477298fe438a46d715b0
2025-12-12 21:57:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 21:57:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 21:57:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eaa0d54376d241a1a2be74292ea5a8f0 (experiment: slowfast)
2025-12-12 21:57:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 21:57:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:12 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 21:57:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eaa0d54376d241a1a2be74292ea5a8f0
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1823] ================================================================================
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1824] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1825] ================================================================================
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1838] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1848] Final training using default hyperparameters (no grid search)
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 1/5 (full dataset)
2025-12-12 21:57:13 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: be76756148734cb3a7ebd40d8da35683 (experiment: slowfast)
2025-12-12 21:57:14 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 1 (full dataset)...
2025-12-12 21:57:14 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:57:14 [ERROR] [lib.training.pipeline:2226] Error training final fold 1: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:14 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 2/5 (full dataset)
2025-12-12 21:57:15 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ada9b6decf3420e8e58be8b5f60a88f (experiment: slowfast)
2025-12-12 21:57:15 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 2 (full dataset)...
2025-12-12 21:57:15 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:57:15 [ERROR] [lib.training.pipeline:2226] Error training final fold 2: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:15 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 3/5 (full dataset)
2025-12-12 21:57:16 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 115050131408459fb68a6b7040bc6a98 (experiment: slowfast)
2025-12-12 21:57:17 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 3 (full dataset)...
2025-12-12 21:57:17 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:57:18 [ERROR] [lib.training.pipeline:2226] Error training final fold 3: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:18 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 4/5 (full dataset)
2025-12-12 21:57:18 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1a7ba3a2948d461f94b841e950d4a01c (experiment: slowfast)
2025-12-12 21:57:19 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 4 (full dataset)...
2025-12-12 21:57:19 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:57:20 [ERROR] [lib.training.pipeline:2226] Error training final fold 4: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:20 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 5/5 (full dataset)
2025-12-12 21:57:21 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 21:57:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 21:57:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 21:57:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 21:57:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e061934165ff4626a247f8fc1bbcdc68 (experiment: slowfast)
2025-12-12 21:57:21 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 5 (full dataset)...
2025-12-12 21:57:21 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 21:57:22 [ERROR] [lib.training.pipeline:2226] Error training final fold 5: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 21:57:22 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/fold_1 to copy
2025-12-12 21:57:22 [INFO] [lib.training.pipeline:2299] 
slowfast - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 21:57:24 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots/cv_fold_comparison.png
2025-12-12 21:57:24 [INFO] [lib.training.pipeline:2327] Generated plots for slowfast in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots
2025-12-12 21:57:24 [INFO] [lib.training.pipeline:2364] ================================================================================
2025-12-12 21:57:24 [INFO] [lib.training.pipeline:2365] Stage 5: Model Training Pipeline Completed
2025-12-12 21:57:24 [INFO] [lib.training.pipeline:2366] ================================================================================
2025-12-12 21:57:24 [INFO] [__main__:401] ================================================================================
2025-12-12 21:57:24 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 21:57:24 [INFO] [__main__:403] ================================================================================
2025-12-12 21:57:24 [INFO] [__main__:404] Execution time: 334.39 seconds (5.57 minutes)
2025-12-12 21:57:24 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 21:57:24 [INFO] [__main__:407] Models trained: ['slowfast']
2025-12-12 21:57:24 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 21:57:24 [INFO] [__main__:414] ================================================================================
2025-12-12 21:57:24 [INFO] [__main__:415] Final memory statistics:
2025-12-12 21:57:24 [INFO] [__main__:416] ================================================================================
2025-12-12 21:57:24 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 1591.08203125, 'cpu_memory_gb': 1.5537910461425781, 'cpu_vms_mb': 47910.71875, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.285212672, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.643129344}
2025-12-12 21:57:24 [INFO] [__main__:419] ================================================================================
2025-12-12 21:57:24 [INFO] [__main__:420] Training complete!
2025-12-12 21:57:24 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 21:57:24 [INFO] [__main__:422] ================================================================================
