2025-12-12 19:34:37 [INFO] [__main__:310] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 19:34:37 [INFO] [__main__:312] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 19:34:37 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 19:34:37 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 19:34:37 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 19:34:37 [INFO] [__main__:317] Model types: ['naive_cnn']
2025-12-12 19:34:37 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 19:34:37 [INFO] [__main__:319] Number of frames: 1000
2025-12-12 19:34:37 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 19:34:37 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 19:34:37 [INFO] [__main__:324] Delete existing: True
2025-12-12 19:34:37 [INFO] [__main__:325] Resume mode: True
2025-12-12 19:34:37 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765586077.log
2025-12-12 19:34:37 [INFO] [__main__:333] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 19:34:37 [INFO] [__main__:335] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 19:34:37 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 19:34:37 [INFO] [__main__:358] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 19:34:37 [INFO] [__main__:360] ================================================================================
2025-12-12 19:34:37 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.3828125, 'cpu_memory_gb': 0.7181472778320312, 'cpu_vms_mb': 10218.72265625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 19:34:37 [INFO] [__main__:364] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 19:34:37 [INFO] [__main__:366] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 19:34:37 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 19:34:37 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 19:34:37 [INFO] [__main__:370] ================================================================================
2025-12-12 19:34:37 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 19:34:37 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:490] ================================================================================
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:491] Stage 5: Model Training Pipeline Started
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:492] ================================================================================
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:493] Model types: ['naive_cnn']
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:494] K-fold splits: 5
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:495] Frames per video: 1000
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:496] Output directory: data/stage5
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:497] Initializing pipeline...
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 19:34:37 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:333] ✓ naive_cnn: CAN RUN
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:346]   ['naive_cnn']
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:583] 
Stage 5: Loading metadata...
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:609] Loaded metadata: 3278 rows
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:619] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 19:34:38 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=833677.58GB, used=1666162.42GB (66.7%)
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:651] Stage 5: Found 3278 scaled videos
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:730] Stage 5: Deleting existing model results (clean mode)...
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:739] Deleted existing results for naive_cnn
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:742] Stage 5: Deleted 1 existing model directories
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:747] 
================================================================================
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:748] Stage 5: Training model: naive_cnn
2025-12-12 19:34:38 [INFO] [lib.training.pipeline:749] ================================================================================
2025-12-12 19:34:40 [INFO] [lib.training.pipeline:773] Grid search: 18 hyperparameter combinations to try
2025-12-12 19:34:40 [INFO] [lib.training.pipeline:781] ================================================================================
2025-12-12 19:34:40 [INFO] [lib.training.pipeline:782] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 19:34:40 [INFO] [lib.training.pipeline:783] ================================================================================
2025-12-12 19:34:40 [INFO] [lib.training.pipeline:792] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:805] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 1/18
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'weight_decay': 1e-05, 'batch_size': 1, 'num_epochs': 20}
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 19:34:41 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 1/5 (20% sample)
2025-12-12 19:34:42 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:34:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a3a38daf3d604eaa839497653b81b639 (experiment: naive_cnn)
2025-12-12 19:34:50 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 1...
2025-12-12 19:35:02 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:35:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:35:32 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:35:32 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 4: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:35:32 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 4): {'cpu_memory_mb': 4497.8515625, 'cpu_memory_gb': 4.392433166503906, 'cpu_vms_mb': 51587.34765625, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.299065344, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.629276672}
2025-12-12 19:35:32 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:35:32 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:35:52 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 176.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.06 GiB is allocated by PyTorch, and 205.35 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 224, 256]), Model num_frames: 1000
2025-12-12 19:35:52 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 3: CUDA out of memory. Tried to allocate 176.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.06 GiB is allocated by PyTorch, and 205.35 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:35:52 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 3): {'cpu_memory_mb': 4498.11328125, 'cpu_memory_gb': 4.392688751220703, 'cpu_vms_mb': 51587.34765625, 'gpu_allocated_gb': 16.167622656, 'gpu_reserved_gb': 16.382951424, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.545390592}
2025-12-12 19:35:52 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 176.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.06 GiB is allocated by PyTorch, and 205.35 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:35:52 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:36:07 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:36:07 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:36:07 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 4513.1640625, 'cpu_memory_gb': 4.407386779785156, 'cpu_vms_mb': 51602.17578125, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:36:07 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:36:07 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:36:15 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:36:15 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:36:15 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 4498.97265625, 'cpu_memory_gb': 4.393527984619141, 'cpu_vms_mb': 51587.8359375, 'gpu_allocated_gb': 16.09196544, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:36:15 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Final batch size: 1
2025-12-12 19:36:15 [ERROR] [lib.training.pipeline:1650] Error training fold 1: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                            ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:36:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a3a38daf3d604eaa839497653b81b639
2025-12-12 19:36:15 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 2/5 (20% sample)
2025-12-12 19:36:15 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:36:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4b2c97099b4048a18971298b172d49ea (experiment: naive_cnn)
2025-12-12 19:36:15 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 2...
2025-12-12 19:36:19 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:36:19 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:36:29 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:36:29 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 1: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:36:29 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 1): {'cpu_memory_mb': 4499.0, 'cpu_memory_gb': 4.3935546875, 'cpu_vms_mb': 51587.8359375, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:36:29 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:36:29 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:36:53 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 186, 256]), Model num_frames: 1000
2025-12-12 19:36:53 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 3: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:36:54 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 3): {'cpu_memory_mb': 6432.2578125, 'cpu_memory_gb': 6.281501770019531, 'cpu_vms_mb': 53520.4375, 'gpu_allocated_gb': 16.194983936, 'gpu_reserved_gb': 16.361979904, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.566362112}
2025-12-12 19:36:54 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:36:54 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:37:03 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 186, 256]), Model num_frames: 1000
2025-12-12 19:37:03 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 1: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:37:03 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 1): {'cpu_memory_mb': 6432.26953125, 'cpu_memory_gb': 6.281513214111328, 'cpu_vms_mb': 53520.4375, 'gpu_allocated_gb': 16.194983936, 'gpu_reserved_gb': 16.382951424, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.545390592}
2025-12-12 19:37:03 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:37:03 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:37:52 [INFO] [lib.training.trainer:419] Epoch 1, Batch 10/524, Loss: 0.6948
2025-12-12 19:38:03 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:38:03 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 11: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:03 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 11): {'cpu_memory_mb': 5013.74609375, 'cpu_memory_gb': 4.896236419677734, 'cpu_vms_mb': 52101.8671875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:38:03 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Final batch size: 1
2025-12-12 19:38:03 [ERROR] [lib.training.pipeline:1650] Error training fold 2: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                            ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4b2c97099b4048a18971298b172d49ea
2025-12-12 19:38:04 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 3/5 (20% sample)
2025-12-12 19:38:04 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:38:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2aa0b1f127014b0e8788acbc3fab5818 (experiment: naive_cnn)
2025-12-12 19:38:04 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 3...
2025-12-12 19:38:07 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:38:08 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:38:22 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:38:22 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:22 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 5013.74609375, 'cpu_memory_gb': 4.896236419677734, 'cpu_vms_mb': 52101.8671875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:38:22 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 3, Current batch size: 1
2025-12-12 19:38:22 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:38:39 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 204]), Model num_frames: 1000
2025-12-12 19:38:39 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 3: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:40 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 3): {'cpu_memory_mb': 5013.78125, 'cpu_memory_gb': 4.896270751953125, 'cpu_vms_mb': 52101.8671875, 'gpu_allocated_gb': 15.968823296, 'gpu_reserved_gb': 16.152264704, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.776077312}
2025-12-12 19:38:40 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 3, Current batch size: 1
2025-12-12 19:38:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:38:50 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 330.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 244.19 MiB is free. Including non-PyTorch memory, this process has 15.52 GiB memory in use. Of the allocated memory 14.96 GiB is allocated by PyTorch, and 183.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 210, 256]), Model num_frames: 1000
2025-12-12 19:38:50 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 1: CUDA out of memory. Tried to allocate 330.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 244.19 MiB is free. Including non-PyTorch memory, this process has 15.52 GiB memory in use. Of the allocated memory 14.96 GiB is allocated by PyTorch, and 183.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:50 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 1): {'cpu_memory_mb': 5013.84765625, 'cpu_memory_gb': 4.896335601806641, 'cpu_vms_mb': 52101.8671875, 'gpu_allocated_gb': 16.064361472, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:38:50 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 330.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 244.19 MiB is free. Including non-PyTorch memory, this process has 15.52 GiB memory in use. Of the allocated memory 14.96 GiB is allocated by PyTorch, and 183.83 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 3, Current batch size: 1
2025-12-12 19:38:50 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:38:56 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:38:56 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:56 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 5013.84765625, 'cpu_memory_gb': 4.896335601806641, 'cpu_vms_mb': 52101.8671875, 'gpu_allocated_gb': 16.09196544, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:38:56 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 3, Final batch size: 1
2025-12-12 19:38:56 [ERROR] [lib.training.pipeline:1650] Error training fold 3: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                            ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:38:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2aa0b1f127014b0e8788acbc3fab5818
2025-12-12 19:38:57 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 4/5 (20% sample)
2025-12-12 19:38:57 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:38:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fa3b4786abd340faa6d1841aa21e55ae (experiment: naive_cnn)
2025-12-12 19:38:57 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 4...
2025-12-12 19:39:01 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:39:01 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:39:38 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 186, 256]), Model num_frames: 1000
2025-12-12 19:39:38 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:39:39 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 14311.0703125, 'cpu_memory_gb': 13.975654602050781, 'cpu_vms_mb': 61399.921875, 'gpu_allocated_gb': 16.194983936, 'gpu_reserved_gb': 16.361979904, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.566362112}
2025-12-12 19:39:39 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 144.19 MiB is free. Including non-PyTorch memory, this process has 15.62 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 159.26 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 4, Current batch size: 1
2025-12-12 19:39:39 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:40:02 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:40:02 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 4: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:40:02 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 4): {'cpu_memory_mb': 14311.33984375, 'cpu_memory_gb': 13.97591781616211, 'cpu_vms_mb': 61399.921875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:40:02 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 4, Current batch size: 1
2025-12-12 19:40:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:40:14 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 152.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 256]), Model num_frames: 1000
2025-12-12 19:40:14 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 1: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 152.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:40:14 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 1): {'cpu_memory_mb': 14311.33984375, 'cpu_memory_gb': 13.97591781616211, 'cpu_vms_mb': 61399.921875, 'gpu_allocated_gb': 16.180668416, 'gpu_reserved_gb': 16.341008384, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.587333632}
2025-12-12 19:40:14 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 152.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 4, Current batch size: 1
2025-12-12 19:40:14 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:41:02 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 204, 256]), Model num_frames: 1000
2025-12-12 19:41:02 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 9: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:41:02 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 9): {'cpu_memory_mb': 14313.30859375, 'cpu_memory_gb': 13.977840423583984, 'cpu_vms_mb': 61401.921875, 'gpu_allocated_gb': 15.968823296, 'gpu_reserved_gb': 16.152264704, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.776077312}
2025-12-12 19:41:02 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 4, Final batch size: 1
2025-12-12 19:41:02 [ERROR] [lib.training.pipeline:1650] Error training fold 4: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 132, in forward
    chunk = F.max_pool2d(chunk, 2)
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/_jit_internal.py", line 627, in fn
    return if_false(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 823, in _max_pool2d
    return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 320.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 264.19 MiB is free. Including non-PyTorch memory, this process has 15.50 GiB memory in use. Of the allocated memory 14.95 GiB is allocated by PyTorch, and 175.25 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:41:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fa3b4786abd340faa6d1841aa21e55ae
2025-12-12 19:41:02 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 5/5 (20% sample)
2025-12-12 19:41:02 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:41:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36d8437783394b4fb2331f5f7ba3d8d1 (experiment: naive_cnn)
2025-12-12 19:41:02 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 5...
2025-12-12 19:41:06 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:41:06 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:41:12 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 256]), Model num_frames: 1000
2025-12-12 19:41:12 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:41:12 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14312.30859375, 'cpu_memory_gb': 13.976863861083984, 'cpu_vms_mb': 61400.921875, 'gpu_allocated_gb': 16.180255744, 'gpu_reserved_gb': 16.341008384, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.587333632}
2025-12-12 19:41:12 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 5, Current batch size: 1
2025-12-12 19:41:12 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:41:18 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 256]), Model num_frames: 1000
2025-12-12 19:41:18 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:41:18 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14312.30859375, 'cpu_memory_gb': 13.976863861083984, 'cpu_vms_mb': 61400.921875, 'gpu_allocated_gb': 16.180255744, 'gpu_reserved_gb': 16.341008384, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.587333632}
2025-12-12 19:41:18 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 164.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 153.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 5, Current batch size: 1
2025-12-12 19:41:18 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:41:48 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:41:48 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 5: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:41:48 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 5): {'cpu_memory_mb': 14312.30859375, 'cpu_memory_gb': 13.976863861083984, 'cpu_vms_mb': 61400.921875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:41:48 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 5, Current batch size: 1
2025-12-12 19:41:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:02 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:42:02 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 1: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:02 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 1): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:42:02 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 5, Final batch size: 1
2025-12-12 19:42:02 [ERROR] [lib.training.pipeline:1650] Error training fold 5: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                            ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 204.19 MiB is free. Including non-PyTorch memory, this process has 15.56 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 168.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36d8437783394b4fb2331f5f7ba3d8d1
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:818] 
================================================================================
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:819] Grid Search: Hyperparameter combination 2/18
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:820] Parameters: {'learning_rate': 0.0001, 'weight_decay': 1e-05, 'batch_size': 1, 'num_epochs': 30}
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:821] ================================================================================
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 1/5 (20% sample)
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:859] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:42:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8172ad16e37345a099f1885075fb31de (experiment: naive_cnn)
2025-12-12 19:42:03 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 1...
2025-12-12 19:42:06 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:42:06 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:12 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:42:12 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:12 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.09196544, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:42:12 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:42:12 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:26 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:42:26 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:26 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:42:26 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:42:26 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:33 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:42:33 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:33 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.09196544, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:42:33 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Current batch size: 1
2025-12-12 19:42:33 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:39 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 380.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 4.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.23 GiB is allocated by PyTorch, and 152.70 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 242]), Model num_frames: 1000
2025-12-12 19:42:39 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 380.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 4.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.23 GiB is allocated by PyTorch, and 152.70 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:39 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.34866176, 'gpu_reserved_gb': 16.508780544, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.419561472}
2025-12-12 19:42:39 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 380.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 4.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.23 GiB is allocated by PyTorch, and 152.70 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 1, Final batch size: 1
2025-12-12 19:42:39 [ERROR] [lib.training.pipeline:1650] Error training fold 1: CUDA out of memory. Tried to allocate 380.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 4.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.23 GiB is allocated by PyTorch, and 152.70 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
           ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/functional.py", line 2813, in batch_norm
    return torch.batch_norm(
           ^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 380.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 4.19 MiB is free. Including non-PyTorch memory, this process has 15.75 GiB memory in use. Of the allocated memory 15.23 GiB is allocated by PyTorch, and 152.70 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8172ad16e37345a099f1885075fb31de
2025-12-12 19:42:40 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 2/5 (20% sample)
2025-12-12 19:42:40 [INFO] [lib.training.pipeline:859] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-12 19:42:40 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:42:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 23dd6de502154a4698428d08a04922ee (experiment: naive_cnn)
2025-12-12 19:42:40 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 2...
2025-12-12 19:42:43 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:42:43 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:42:57 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 184.19 MiB is free. Including non-PyTorch memory, this process has 15.58 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 132.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 256]), Model num_frames: 1000
2025-12-12 19:42:57 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 2: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 184.19 MiB is free. Including non-PyTorch memory, this process has 15.58 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 132.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:42:57 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 2): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.180668416, 'gpu_reserved_gb': 16.320036864, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.608305152}
2025-12-12 19:42:57 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 184.19 MiB is free. Including non-PyTorch memory, this process has 15.58 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 132.91 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:42:57 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:43:02 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 166.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 151.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 256, 256]), Model num_frames: 1000
2025-12-12 19:43:02 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 166.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 151.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:43:02 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.180255744, 'gpu_reserved_gb': 16.338911232, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.589430784}
2025-12-12 19:43:02 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 2/4): CUDA out of memory. Tried to allocate 200.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 166.19 MiB is free. Including non-PyTorch memory, this process has 15.60 GiB memory in use. Of the allocated memory 15.07 GiB is allocated by PyTorch, and 151.30 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:43:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:43:08 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.65 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 186, 256]), Model num_frames: 1000
2025-12-12 19:43:08 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.65 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:43:08 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.194571264, 'gpu_reserved_gb': 16.382951424, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.545390592}
2025-12-12 19:43:08 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 3/4): CUDA out of memory. Tried to allocate 292.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 124.19 MiB is free. Including non-PyTorch memory, this process has 15.64 GiB memory in use. Of the allocated memory 15.08 GiB is allocated by PyTorch, and 179.65 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Current batch size: 1
2025-12-12 19:43:08 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:43:13 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:43:13 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 0: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:43:14 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 0): {'cpu_memory_mb': 14315.8984375, 'cpu_memory_gb': 13.980369567871094, 'cpu_vms_mb': 61403.921875, 'gpu_allocated_gb': 16.09196544, 'gpu_reserved_gb': 16.257122304, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.671219712}
2025-12-12 19:43:14 [ERROR] [lib.training.pipeline:1271] CUDA OOM or runtime error during training (max retries reached): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 2, Final batch size: 1
2025-12-12 19:43:14 [ERROR] [lib.training.pipeline:1650] Error training fold 2: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1220, in stage5_train_models
    model = fit(
            ^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 624, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 342, in train_one_epoch
    logits = model(clips)
             ^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_cnn.py", line 131, in forward
    chunk = F.relu(self.bn1(self.conv1(chunk)))
                            ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 548, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 543, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 149.38 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:43:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 23dd6de502154a4698428d08a04922ee
2025-12-12 19:43:14 [INFO] [lib.training.pipeline:850] 
Hyperparameter Search - naive_cnn - Fold 3/5 (20% sample)
2025-12-12 19:43:14 [INFO] [lib.training.pipeline:859] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-12 19:43:14 [INFO] [lib.training.pipeline:954] Training configuration - Batch size: 1, Gradient accumulation steps: 16, Effective batch size: 16
2025-12-12 19:43:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 89ece70e2f4746c2a205b7e8e0f151f1 (experiment: naive_cnn)
2025-12-12 19:43:14 [INFO] [lib.training.pipeline:1073] Training PyTorch model naive_cnn on fold 3...
2025-12-12 19:43:18 [INFO] [lib.training.pipeline:1115] Model forward pass test successful. Output shape: torch.Size([1, 2])
2025-12-12 19:43:18 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:44:01 [ERROR] [lib.training._cnn:182] Runtime error in forward pass: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Input shape: torch.Size([1, 3, 1000, 192, 256]), Model num_frames: 1000
2025-12-12 19:44:01 [ERROR] [lib.utils.memory:128] OOM error forward pass batch 7: CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-12-12 19:44:02 [INFO] [lib.utils.memory:89] Memory stats (after OOM forward pass batch 7): {'cpu_memory_mb': 14317.0, 'cpu_memory_gb': 13.9814453125, 'cpu_vms_mb': 61404.921875, 'gpu_allocated_gb': 16.092378112, 'gpu_reserved_gb': 16.278093824, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 0.650248192}
2025-12-12 19:44:02 [WARNING] [lib.training.pipeline:1256] CUDA OOM during training (attempt 1/4): CUDA out of memory. Tried to allocate 300.00 MiB. GPU 0 has a total capacity of 15.77 GiB of which 224.19 MiB is free. Including non-PyTorch memory, this process has 15.54 GiB memory in use. Of the allocated memory 15.01 GiB is allocated by PyTorch, and 148.98 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables). Model: naive_cnn, Fold: 3, Current batch size: 1
2025-12-12 19:44:02 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 19:44:52 [INFO] [lib.training.trainer:419] Epoch 1, Batch 10/524, Loss: 0.6938
