2025-12-09 04:30:18 [INFO] [__main__:167] ================================================================================
2025-12-09 04:30:18 [INFO] [__main__:168] STAGE 4: SCALED VIDEO FEATURE EXTRACTION
2025-12-09 04:30:18 [INFO] [__main__:169] ================================================================================
2025-12-09 04:30:18 [INFO] [__main__:170] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-09 04:30:18 [INFO] [__main__:171] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-09 04:30:18 [INFO] [__main__:172] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4
2025-12-09 04:30:18 [INFO] [__main__:176] Frame sampling: Adaptive (10.0% of frames, min=5, max=50)
2025-12-09 04:30:18 [INFO] [__main__:179] Video range: [0, 1082)
2025-12-09 04:30:18 [INFO] [__main__:182] Delete existing: False
2025-12-09 04:30:18 [INFO] [__main__:183] Resume mode: True
2025-12-09 04:30:18 [INFO] [__main__:184] Execution order: forward
2025-12-09 04:30:18 [INFO] [__main__:185] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage4_scaled_features_1765272618.log
2025-12-09 04:30:18 [DEBUG] [__main__:186] Python version: 3.11.7 (main, Dec 15 2023, 18:12:31) [GCC 11.2.0]
2025-12-09 04:30:18 [DEBUG] [__main__:187] Python executable: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/bin/python
2025-12-09 04:30:18 [DEBUG] [__main__:188] Working directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-09 04:30:18 [DEBUG] [__main__:189] Command line arguments: ['/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage4_scaled_features.py', '--project-root', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc', '--scaled-metadata', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow', '--output-dir', 'data/features_stage4', '--start-idx', '0', '--end-idx', '1082', '--execution-order', 'forward', '--resume']
2025-12-09 04:30:18 [INFO] [__main__:192] ================================================================================
2025-12-09 04:30:18 [INFO] [__main__:193] Checking prerequisites...
2025-12-09 04:30:18 [INFO] [__main__:194] ================================================================================
2025-12-09 04:30:18 [INFO] [__main__:200] âœ“ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-09 04:30:18 [DEBUG] [__main__:205] System information:
2025-12-09 04:30:18 [DEBUG] [__main__:206]   CPU count: 40
2025-12-09 04:30:18 [DEBUG] [__main__:207]   Total memory: 200.64 GB
2025-12-09 04:30:18 [DEBUG] [__main__:208]   Available memory: 186.06 GB
2025-12-09 04:30:18 [INFO] [__main__:213] ================================================================================
2025-12-09 04:30:18 [INFO] [__main__:214] Initial memory statistics:
2025-12-09 04:30:18 [INFO] [__main__:215] ================================================================================
2025-12-09 04:30:19 [INFO] [lib.utils.memory:89] Memory stats (Stage 4: before scaled feature extraction): {'cpu_memory_mb': 536.59765625, 'cpu_memory_gb': 0.5240211486816406, 'cpu_vms_mb': 5238.25, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-09 04:30:19 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-09 04:30:19 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-09 04:30:19 [INFO] [__main__:219] ================================================================================
2025-12-09 04:30:19 [INFO] [__main__:220] Starting Stage 4: Scaled Video Feature Extraction
2025-12-09 04:30:19 [INFO] [__main__:221] ================================================================================
2025-12-09 04:30:19 [INFO] [__main__:222] This may take a while depending on dataset size...
2025-12-09 04:30:19 [INFO] [__main__:223] Progress will be logged in real-time
2025-12-09 04:30:19 [INFO] [__main__:224] ================================================================================
2025-12-09 04:30:19 [INFO] [lib.features.scaled:210] Stage 4: Loading scaled metadata...
2025-12-09 04:30:19 [INFO] [lib.features.scaled:242] Stage 4: Processing video range [0, 1082) of 3244 total videos
2025-12-09 04:30:19 [INFO] [lib.features.scaled:251] Stage 4: Processing 1082 scaled videos in this range
2025-12-09 04:30:19 [INFO] [lib.features.scaled:265] Stage 4: Found 2435 existing feature files (resume mode)
2025-12-09 04:30:19 [INFO] [lib.features.scaled:301] Stage 4: Processing videos in FORWARD order (from start to end)
2025-12-09 04:30:19 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1473 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:30:27 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/2GgPk1N6-Kc_original_scaled_original.mp4 - feature file already exists
2025-12-09 04:30:29 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1246 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:30:36 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/130440720500480_aug3_scaled_aug3.mp4 - feature file already exists
2025-12-09 04:30:36 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1573 total frames -> 50 frames (10.0%, bounded [5, 50])
2025-12-09 04:30:45 [DEBUG] [lib.features.scaled:388] Skipping /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/H7B0Vo7w8V0_aug7_scaled_aug7.mp4 - feature file already exists
2025-12-09 04:30:45 [DEBUG] [lib.features.scaled:83] Adaptive sampling: 1885 total frames -> 50 frames (10.0%, bounded [5, 50])
