2025-12-13 00:22:20 [INFO] [__main__:310] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 00:22:20 [INFO] [__main__:312] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 00:22:20 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 00:22:20 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 00:22:20 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 00:22:20 [INFO] [__main__:317] Model types: ['slowfast']
2025-12-13 00:22:20 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 00:22:20 [INFO] [__main__:319] Number of frames: 500
2025-12-13 00:22:20 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 00:22:20 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 00:22:20 [INFO] [__main__:324] Delete existing: False
2025-12-13 00:22:20 [INFO] [__main__:325] Resume mode: True
2025-12-13 00:22:20 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765603340.log
2025-12-13 00:22:20 [INFO] [__main__:333] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 00:22:20 [INFO] [__main__:335] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 00:22:20 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 00:22:20 [INFO] [__main__:358] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 00:22:20 [INFO] [__main__:360] ================================================================================
2025-12-13 00:22:20 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.16796875, 'cpu_memory_gb': 0.7189140319824219, 'cpu_vms_mb': 10218.18359375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 00:22:20 [INFO] [__main__:364] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 00:22:20 [INFO] [__main__:366] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 00:22:20 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 00:22:20 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 00:22:20 [INFO] [__main__:370] ================================================================================
2025-12-13 00:22:20 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 00:22:20 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:499] Model types: ['slowfast']
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:501] Frames per video: 500
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-13 00:22:20 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:333] ✓ slowfast: CAN RUN
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:346]   ['slowfast']
2025-12-13 00:22:21 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 00:22:22 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=830857.25GB, used=1668982.75GB (66.8%)
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:705] Enabling adaptive chunked frame loading for slowfast: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:788] 
================================================================================
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:789] Stage 5: Training model: slowfast
2025-12-13 00:22:22 [INFO] [lib.training.pipeline:790] ================================================================================
2025-12-13 00:22:23 [INFO] [lib.training.pipeline:823] Grid search: 32 hyperparameter combinations to try
2025-12-13 00:22:23 [INFO] [lib.training.pipeline:831] ================================================================================
2025-12-13 00:22:23 [INFO] [lib.training.pipeline:832] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-13 00:22:23 [INFO] [lib.training.pipeline:833] ================================================================================
2025-12-13 00:22:23 [INFO] [lib.training.pipeline:842] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:855] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 1/32
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ff69d0fb34954567a29a1f7bca04f7f8 (experiment: slowfast)
2025-12-13 00:22:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:22:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:32 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ff69d0fb34954567a29a1f7bca04f7f8
2025-12-13 00:22:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:22:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d1cb8fea615e4e5cb4dbbe90da570c76 (experiment: slowfast)
2025-12-13 00:22:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:22:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:34 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d1cb8fea615e4e5cb4dbbe90da570c76
2025-12-13 00:22:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:22:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4d6af37c53b54ae5af644b88d151ebb7 (experiment: slowfast)
2025-12-13 00:22:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:22:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:36 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4d6af37c53b54ae5af644b88d151ebb7
2025-12-13 00:22:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:22:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1c71757869a34b81b2cfd6f264a9cdef (experiment: slowfast)
2025-12-13 00:22:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:22:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:38 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1c71757869a34b81b2cfd6f264a9cdef
2025-12-13 00:22:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:22:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2aa58279dbc44bffb29108479cb2163f (experiment: slowfast)
2025-12-13 00:22:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:22:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:40 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2aa58279dbc44bffb29108479cb2163f
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 2/32
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e0b6045a36ff463c8ac85f7a8270ffcf (experiment: slowfast)
2025-12-13 00:22:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:22:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:41 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e0b6045a36ff463c8ac85f7a8270ffcf
2025-12-13 00:22:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:22:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c63a7d9b641941508991c9737270c6bf (experiment: slowfast)
2025-12-13 00:22:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:22:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:43 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c63a7d9b641941508991c9737270c6bf
2025-12-13 00:22:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:22:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d876df8233384c2aac3c4d7ef63a6b1c (experiment: slowfast)
2025-12-13 00:22:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:22:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:45 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d876df8233384c2aac3c4d7ef63a6b1c
2025-12-13 00:22:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:22:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a1ce2a587a9f405ba6cdc817e7822c4a (experiment: slowfast)
2025-12-13 00:22:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:22:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:47 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a1ce2a587a9f405ba6cdc817e7822c4a
2025-12-13 00:22:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:22:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 15b18ef97d4143bfa50bee6972b0fa9b (experiment: slowfast)
2025-12-13 00:22:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:22:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:49 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 15b18ef97d4143bfa50bee6972b0fa9b
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 3/32
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f3097a72a3f44a4e9addcd3d75bb421a (experiment: slowfast)
2025-12-13 00:22:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:22:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:51 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f3097a72a3f44a4e9addcd3d75bb421a
2025-12-13 00:22:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:22:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ca72c65599240e4931a08b55e7383e7 (experiment: slowfast)
2025-12-13 00:22:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:22:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:52 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6ca72c65599240e4931a08b55e7383e7
2025-12-13 00:22:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:22:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7ea91627656b409a88de4906726ce3d2 (experiment: slowfast)
2025-12-13 00:22:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:22:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:54 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7ea91627656b409a88de4906726ce3d2
2025-12-13 00:22:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:22:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d818d73ce2f544f49983e34ac9a115aa (experiment: slowfast)
2025-12-13 00:22:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:22:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:56 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d818d73ce2f544f49983e34ac9a115aa
2025-12-13 00:22:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:22:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:22:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ece58886abc344bca13a8b2fc655cb63 (experiment: slowfast)
2025-12-13 00:22:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:22:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:22:58 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:22:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ece58886abc344bca13a8b2fc655cb63
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 4/32
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:22:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:22:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:22:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:22:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:22:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:22:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cbc7bbae9e904dd0af322c243be88652 (experiment: slowfast)
2025-12-13 00:22:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:00 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cbc7bbae9e904dd0af322c243be88652
2025-12-13 00:23:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9d93fabe20024848a3ef8ebada051497 (experiment: slowfast)
2025-12-13 00:23:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:01 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9d93fabe20024848a3ef8ebada051497
2025-12-13 00:23:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7a721faa4d0547fbb3c8887538078350 (experiment: slowfast)
2025-12-13 00:23:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:03 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7a721faa4d0547fbb3c8887538078350
2025-12-13 00:23:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2d29b304b8404c9eacbab506163d60dc (experiment: slowfast)
2025-12-13 00:23:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:05 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2d29b304b8404c9eacbab506163d60dc
2025-12-13 00:23:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6913cbf4d8e84632a975252dbecedc95 (experiment: slowfast)
2025-12-13 00:23:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:07 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6913cbf4d8e84632a975252dbecedc95
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 5/32
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b6b84f6350f046e499af421cccc4611f (experiment: slowfast)
2025-12-13 00:23:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:09 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b6b84f6350f046e499af421cccc4611f
2025-12-13 00:23:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 62c235417d884f468f28b2762e04c3e9 (experiment: slowfast)
2025-12-13 00:23:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:11 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 62c235417d884f468f28b2762e04c3e9
2025-12-13 00:23:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b58a32ff695a465d98acb7d2caefed27 (experiment: slowfast)
2025-12-13 00:23:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:12 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b58a32ff695a465d98acb7d2caefed27
2025-12-13 00:23:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b2bc07942d1a4d398f9d1aafa441c606 (experiment: slowfast)
2025-12-13 00:23:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:14 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b2bc07942d1a4d398f9d1aafa441c606
2025-12-13 00:23:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8e39393fdc3f4f31a609d4bd32019ab6 (experiment: slowfast)
2025-12-13 00:23:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:16 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8e39393fdc3f4f31a609d4bd32019ab6
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 6/32
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 73969dd6ad904e27aa92c6aa04c04094 (experiment: slowfast)
2025-12-13 00:23:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:18 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 73969dd6ad904e27aa92c6aa04c04094
2025-12-13 00:23:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: da04a2df809748e3aaac14090414ee3b (experiment: slowfast)
2025-12-13 00:23:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:20 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: da04a2df809748e3aaac14090414ee3b
2025-12-13 00:23:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f449252959784ab9bb168fb3e3165e07 (experiment: slowfast)
2025-12-13 00:23:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:22 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f449252959784ab9bb168fb3e3165e07
2025-12-13 00:23:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 34eca4479df348aeb07c5910889b0fe3 (experiment: slowfast)
2025-12-13 00:23:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:24 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 34eca4479df348aeb07c5910889b0fe3
2025-12-13 00:23:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 34b43fa97aed412d939c3bcb1c8da607 (experiment: slowfast)
2025-12-13 00:23:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:26 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 34b43fa97aed412d939c3bcb1c8da607
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 7/32
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 848977819261412e9211760a8c064247 (experiment: slowfast)
2025-12-13 00:23:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:28 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 848977819261412e9211760a8c064247
2025-12-13 00:23:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 016f7a0d09aa4ce08d3fa912fe51faa9 (experiment: slowfast)
2025-12-13 00:23:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:29 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 016f7a0d09aa4ce08d3fa912fe51faa9
2025-12-13 00:23:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c72c9d0784d64450964416a4138d9d5d (experiment: slowfast)
2025-12-13 00:23:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:31 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c72c9d0784d64450964416a4138d9d5d
2025-12-13 00:23:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: df416fef0776457b83c6dc67c5d52a47 (experiment: slowfast)
2025-12-13 00:23:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:33 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: df416fef0776457b83c6dc67c5d52a47
2025-12-13 00:23:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 22c53c1508d1422eb067bb790afd0463 (experiment: slowfast)
2025-12-13 00:23:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:35 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 22c53c1508d1422eb067bb790afd0463
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 8/32
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26d5f49ee4f6445eae0f705c565d728f (experiment: slowfast)
2025-12-13 00:23:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:37 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26d5f49ee4f6445eae0f705c565d728f
2025-12-13 00:23:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6923e2d7e54a4be9808b8f30b0b4109f (experiment: slowfast)
2025-12-13 00:23:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:38 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6923e2d7e54a4be9808b8f30b0b4109f
2025-12-13 00:23:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c0dac9b4ca20405f83afbb27d78d2a83 (experiment: slowfast)
2025-12-13 00:23:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:40 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c0dac9b4ca20405f83afbb27d78d2a83
2025-12-13 00:23:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cbd63ed0d8084eca81736a3a112c6ee8 (experiment: slowfast)
2025-12-13 00:23:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:42 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cbd63ed0d8084eca81736a3a112c6ee8
2025-12-13 00:23:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 82e0446cabad4a0ab16413abe3856a7e (experiment: slowfast)
2025-12-13 00:23:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:44 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 82e0446cabad4a0ab16413abe3856a7e
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 9/32
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2e3fc65f7e9140708e981abfab9b314e (experiment: slowfast)
2025-12-13 00:23:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:46 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2e3fc65f7e9140708e981abfab9b314e
2025-12-13 00:23:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5bfabb3990d3461589bfbc78bbe21ae5 (experiment: slowfast)
2025-12-13 00:23:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:48 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5bfabb3990d3461589bfbc78bbe21ae5
2025-12-13 00:23:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c44cf9aea33f4382952a7e957be3be2a (experiment: slowfast)
2025-12-13 00:23:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:49 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c44cf9aea33f4382952a7e957be3be2a
2025-12-13 00:23:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2740eccb0e4841eeb46b16fac5248d69 (experiment: slowfast)
2025-12-13 00:23:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:23:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:51 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2740eccb0e4841eeb46b16fac5248d69
2025-12-13 00:23:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:23:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:23:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7d19781b449e478b858eee476ae456ec (experiment: slowfast)
2025-12-13 00:23:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:23:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:53 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7d19781b449e478b858eee476ae456ec
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 10/32
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 33d1d4f8ba9b4ae881259c68dc323506 (experiment: slowfast)
2025-12-13 00:23:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:23:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:55 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 33d1d4f8ba9b4ae881259c68dc323506
2025-12-13 00:23:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:23:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: efaec87aaf2a4088a69795e7c5167cff (experiment: slowfast)
2025-12-13 00:23:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:23:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:57 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: efaec87aaf2a4088a69795e7c5167cff
2025-12-13 00:23:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:23:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:23:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:23:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6c11a49c855a49499c4ed1660549e170 (experiment: slowfast)
2025-12-13 00:23:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:23:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:23:58 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:23:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6c11a49c855a49499c4ed1660549e170
2025-12-13 00:23:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:23:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:23:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:23:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:23:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8d621292dcf5454c9eb9bf202cc15d98 (experiment: slowfast)
2025-12-13 00:24:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:01 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8d621292dcf5454c9eb9bf202cc15d98
2025-12-13 00:24:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6fcc91a6aa034d81b02853e4b101ef13 (experiment: slowfast)
2025-12-13 00:24:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:03 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6fcc91a6aa034d81b02853e4b101ef13
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 11/32
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 082856f0960a4de9ae9152df07ab631a (experiment: slowfast)
2025-12-13 00:24:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:04 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 082856f0960a4de9ae9152df07ab631a
2025-12-13 00:24:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3504ba48532e41f9bddf81164de00173 (experiment: slowfast)
2025-12-13 00:24:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:06 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3504ba48532e41f9bddf81164de00173
2025-12-13 00:24:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1d46bc9a1e0c4c9486da398fa089b466 (experiment: slowfast)
2025-12-13 00:24:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:08 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1d46bc9a1e0c4c9486da398fa089b466
2025-12-13 00:24:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1e9138c6f7d040af8bd1cc6a4db2122d (experiment: slowfast)
2025-12-13 00:24:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:10 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1e9138c6f7d040af8bd1cc6a4db2122d
2025-12-13 00:24:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 23adb9e6783d44d4b373bad94ac27b28 (experiment: slowfast)
2025-12-13 00:24:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:12 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 23adb9e6783d44d4b373bad94ac27b28
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 12/32
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a8ef81b3d0c74319bfb01a49264418e4 (experiment: slowfast)
2025-12-13 00:24:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:13 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a8ef81b3d0c74319bfb01a49264418e4
2025-12-13 00:24:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b67dce044aa3476fb1c73955081b85cb (experiment: slowfast)
2025-12-13 00:24:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:15 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b67dce044aa3476fb1c73955081b85cb
2025-12-13 00:24:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2c420b7222534cf184f73cd85bca2bd4 (experiment: slowfast)
2025-12-13 00:24:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:17 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2c420b7222534cf184f73cd85bca2bd4
2025-12-13 00:24:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 595de42087bb43278926dba423e05476 (experiment: slowfast)
2025-12-13 00:24:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:19 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 595de42087bb43278926dba423e05476
2025-12-13 00:24:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7f456fcca02a474d8dd8bd6ee793b4f8 (experiment: slowfast)
2025-12-13 00:24:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:21 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7f456fcca02a474d8dd8bd6ee793b4f8
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 13/32
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8df5b08dcb67434eaf6ccb27062046ba (experiment: slowfast)
2025-12-13 00:24:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:23 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8df5b08dcb67434eaf6ccb27062046ba
2025-12-13 00:24:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e689248b19f04658a15c9bcd4e55efba (experiment: slowfast)
2025-12-13 00:24:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:24 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e689248b19f04658a15c9bcd4e55efba
2025-12-13 00:24:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8ce7ef2d66dd40aba757d0fdbe6b68b3 (experiment: slowfast)
2025-12-13 00:24:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:26 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8ce7ef2d66dd40aba757d0fdbe6b68b3
2025-12-13 00:24:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 85060e8e6a6e4f0bbb59a9f1aacd58cb (experiment: slowfast)
2025-12-13 00:24:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:28 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 85060e8e6a6e4f0bbb59a9f1aacd58cb
2025-12-13 00:24:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6d56a509c9704a298a1308e4e76dfcb6 (experiment: slowfast)
2025-12-13 00:24:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:30 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6d56a509c9704a298a1308e4e76dfcb6
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 14/32
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 19caa0d16c634c90a1677aea205aa621 (experiment: slowfast)
2025-12-13 00:24:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:32 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 19caa0d16c634c90a1677aea205aa621
2025-12-13 00:24:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 81d7234e36da4b48be9330eec3379114 (experiment: slowfast)
2025-12-13 00:24:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:33 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 81d7234e36da4b48be9330eec3379114
2025-12-13 00:24:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3eeee56aa88643df8bcc9a1f913b5596 (experiment: slowfast)
2025-12-13 00:24:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:35 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3eeee56aa88643df8bcc9a1f913b5596
2025-12-13 00:24:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3c9e08c51ba445169dafed3f26b39a1e (experiment: slowfast)
2025-12-13 00:24:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:37 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3c9e08c51ba445169dafed3f26b39a1e
2025-12-13 00:24:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fb2b61ba98d9418cabd11d09ad3f2179 (experiment: slowfast)
2025-12-13 00:24:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:39 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fb2b61ba98d9418cabd11d09ad3f2179
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 15/32
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a3c031c7ca6e4deb90a0ce3a923abeb7 (experiment: slowfast)
2025-12-13 00:24:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:41 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a3c031c7ca6e4deb90a0ce3a923abeb7
2025-12-13 00:24:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a1b7bef1c5af41d197b1225bd8a593aa (experiment: slowfast)
2025-12-13 00:24:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:42 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a1b7bef1c5af41d197b1225bd8a593aa
2025-12-13 00:24:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 90a032099be94511bb7d2a08d4c47690 (experiment: slowfast)
2025-12-13 00:24:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:44 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 90a032099be94511bb7d2a08d4c47690
2025-12-13 00:24:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ee3d91dc550c4b07ad0fe8a161d029e5 (experiment: slowfast)
2025-12-13 00:24:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:46 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ee3d91dc550c4b07ad0fe8a161d029e5
2025-12-13 00:24:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b65c556634ab4f22906bb9e133f32f0b (experiment: slowfast)
2025-12-13 00:24:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:48 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b65c556634ab4f22906bb9e133f32f0b
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 16/32
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93e8e182857d4bf593a7131de320db6b (experiment: slowfast)
2025-12-13 00:24:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:50 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93e8e182857d4bf593a7131de320db6b
2025-12-13 00:24:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8e1a52d2a04e44958344115bd289412d (experiment: slowfast)
2025-12-13 00:24:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:24:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:51 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8e1a52d2a04e44958344115bd289412d
2025-12-13 00:24:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:24:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c4192dffa3b4462eadedcb7cf18c8a2f (experiment: slowfast)
2025-12-13 00:24:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:24:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:53 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c4192dffa3b4462eadedcb7cf18c8a2f
2025-12-13 00:24:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:24:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:54 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a38e846fd866441c932d9ec1491229cb (experiment: slowfast)
2025-12-13 00:24:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:24:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:55 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a38e846fd866441c932d9ec1491229cb
2025-12-13 00:24:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:24:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:24:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f811105994354d82b064af38bd47a4e5 (experiment: slowfast)
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:24:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:57 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f811105994354d82b064af38bd47a4e5
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 17/32
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:24:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:24:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:24:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:24:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:24:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:24:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5e095ac3f8104c129c64dac7030da576 (experiment: slowfast)
2025-12-13 00:24:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:24:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:24:59 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:24:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5e095ac3f8104c129c64dac7030da576
2025-12-13 00:24:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:24:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7069cfa5b6824ca1816b8ede337442c6 (experiment: slowfast)
2025-12-13 00:25:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:00 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7069cfa5b6824ca1816b8ede337442c6
2025-12-13 00:25:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 353cb344b15b4d39905383789f91769e (experiment: slowfast)
2025-12-13 00:25:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:02 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 353cb344b15b4d39905383789f91769e
2025-12-13 00:25:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 186c0f3b20854b0089d7350e5f74e5a6 (experiment: slowfast)
2025-12-13 00:25:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:04 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 186c0f3b20854b0089d7350e5f74e5a6
2025-12-13 00:25:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9f2cda8f5f9f49feafc4d11a6cfa5fa7 (experiment: slowfast)
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:06 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9f2cda8f5f9f49feafc4d11a6cfa5fa7
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 18/32
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 95f4dcabee814a0abf20759a734e2858 (experiment: slowfast)
2025-12-13 00:25:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 95f4dcabee814a0abf20759a734e2858
2025-12-13 00:25:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b6b8474317df44b18cb38f947fe53d4c (experiment: slowfast)
2025-12-13 00:25:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b6b8474317df44b18cb38f947fe53d4c
2025-12-13 00:25:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36e10dfb25b54fa9a794ab76eb280a12 (experiment: slowfast)
2025-12-13 00:25:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36e10dfb25b54fa9a794ab76eb280a12
2025-12-13 00:25:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7fd67abd03234e249a8f1eb5b44ff35a (experiment: slowfast)
2025-12-13 00:25:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7fd67abd03234e249a8f1eb5b44ff35a
2025-12-13 00:25:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1f249ef967c24fc781a85b35dba42f5f (experiment: slowfast)
2025-12-13 00:25:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1f249ef967c24fc781a85b35dba42f5f
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 19/32
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ec5043de85a84d738296fc4b1c6bc8fb (experiment: slowfast)
2025-12-13 00:25:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ec5043de85a84d738296fc4b1c6bc8fb
2025-12-13 00:25:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 13efff3dcd6e46e18f579d3b6a89a33c (experiment: slowfast)
2025-12-13 00:25:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 13efff3dcd6e46e18f579d3b6a89a33c
2025-12-13 00:25:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d5db972735674b50b62101481f9d4b0e (experiment: slowfast)
2025-12-13 00:25:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:20 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d5db972735674b50b62101481f9d4b0e
2025-12-13 00:25:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 21115d0dd56f42f1903552ffd2ed937d (experiment: slowfast)
2025-12-13 00:25:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:22 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 21115d0dd56f42f1903552ffd2ed937d
2025-12-13 00:25:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 443eec5e0dfe44e592bcdf5c07a89629 (experiment: slowfast)
2025-12-13 00:25:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 443eec5e0dfe44e592bcdf5c07a89629
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 20/32
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3406e696724e460784e469cfd2c56395 (experiment: slowfast)
2025-12-13 00:25:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3406e696724e460784e469cfd2c56395
2025-12-13 00:25:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9a28acaa3a374774abda2ee945b87550 (experiment: slowfast)
2025-12-13 00:25:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:28 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9a28acaa3a374774abda2ee945b87550
2025-12-13 00:25:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ee70f0e490c446a5a7fd5588f7ee9c49 (experiment: slowfast)
2025-12-13 00:25:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:30 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ee70f0e490c446a5a7fd5588f7ee9c49
2025-12-13 00:25:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ec9d0b1f2bbb4567b0108f78fcccef85 (experiment: slowfast)
2025-12-13 00:25:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:32 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ec9d0b1f2bbb4567b0108f78fcccef85
2025-12-13 00:25:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5d855e1ea4e0468898cb9f36303bc491 (experiment: slowfast)
2025-12-13 00:25:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:34 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5d855e1ea4e0468898cb9f36303bc491
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 21/32
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 489cb93b0f944179b1da7d42edc41446 (experiment: slowfast)
2025-12-13 00:25:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:36 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 489cb93b0f944179b1da7d42edc41446
2025-12-13 00:25:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 15a5d6fabf8944bd952b5b53e8e5fdff (experiment: slowfast)
2025-12-13 00:25:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:37 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 15a5d6fabf8944bd952b5b53e8e5fdff
2025-12-13 00:25:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dc773daa1f4b44edb748ba361f6f3948 (experiment: slowfast)
2025-12-13 00:25:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:39 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dc773daa1f4b44edb748ba361f6f3948
2025-12-13 00:25:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: cba3b42eb127423088926a57f8bd9a9f (experiment: slowfast)
2025-12-13 00:25:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:41 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: cba3b42eb127423088926a57f8bd9a9f
2025-12-13 00:25:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 81821ca9417f47768a3cfb8b46cdc907 (experiment: slowfast)
2025-12-13 00:25:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:43 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 81821ca9417f47768a3cfb8b46cdc907
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 22/32
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d9cb9ee2e6694031b36da918feaa8101 (experiment: slowfast)
2025-12-13 00:25:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:45 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d9cb9ee2e6694031b36da918feaa8101
2025-12-13 00:25:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 54f644af6a1f46bead0fd2c76344719c (experiment: slowfast)
2025-12-13 00:25:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:46 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 54f644af6a1f46bead0fd2c76344719c
2025-12-13 00:25:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eaa3b8840cdc462faa18ae9142d206f5 (experiment: slowfast)
2025-12-13 00:25:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:48 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eaa3b8840cdc462faa18ae9142d206f5
2025-12-13 00:25:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 74212b92e3794603818f984881c54281 (experiment: slowfast)
2025-12-13 00:25:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:50 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 74212b92e3794603818f984881c54281
2025-12-13 00:25:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:25:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3229ce3be78e419ba17ef74fd0fca9c2 (experiment: slowfast)
2025-12-13 00:25:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:25:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:52 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3229ce3be78e419ba17ef74fd0fca9c2
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 23/32
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:25:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e68e548a9b9e4d368beab66de44473de (experiment: slowfast)
2025-12-13 00:25:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:25:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:54 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e68e548a9b9e4d368beab66de44473de
2025-12-13 00:25:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:25:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 10a011093eb24d958517d1370fc2825a (experiment: slowfast)
2025-12-13 00:25:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:25:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:55 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 10a011093eb24d958517d1370fc2825a
2025-12-13 00:25:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:25:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fc02995102154317bb67a4183602bedb (experiment: slowfast)
2025-12-13 00:25:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:25:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:57 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fc02995102154317bb67a4183602bedb
2025-12-13 00:25:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:25:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:25:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:25:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:25:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:25:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:25:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 106c8350b7ba4f7ba1af49e315a0ca52 (experiment: slowfast)
2025-12-13 00:25:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:25:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:25:59 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:25:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 106c8350b7ba4f7ba1af49e315a0ca52
2025-12-13 00:25:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:25:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1a9295fc730a415abe597437a963b09f (experiment: slowfast)
2025-12-13 00:26:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:01 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1a9295fc730a415abe597437a963b09f
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 24/32
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ed788512a8c4738a690380cd3d5d26a (experiment: slowfast)
2025-12-13 00:26:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:03 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ed788512a8c4738a690380cd3d5d26a
2025-12-13 00:26:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 232616ae904244c081888ac3fd24ebb1 (experiment: slowfast)
2025-12-13 00:26:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:04 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 232616ae904244c081888ac3fd24ebb1
2025-12-13 00:26:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9b566028cb9447e5aaeb82b5ae70b945 (experiment: slowfast)
2025-12-13 00:26:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:06 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9b566028cb9447e5aaeb82b5ae70b945
2025-12-13 00:26:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 03aa39a386ec4f92a38047204f678382 (experiment: slowfast)
2025-12-13 00:26:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:08 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 03aa39a386ec4f92a38047204f678382
2025-12-13 00:26:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d7821f0643c5454595c68b4ad4fed094 (experiment: slowfast)
2025-12-13 00:26:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:10 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d7821f0643c5454595c68b4ad4fed094
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 25/32
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c3162586609e4b5cabc25565a3026980 (experiment: slowfast)
2025-12-13 00:26:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:12 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c3162586609e4b5cabc25565a3026980
2025-12-13 00:26:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26a1c6ec34c24ce68b91f2de05ea62fe (experiment: slowfast)
2025-12-13 00:26:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:14 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26a1c6ec34c24ce68b91f2de05ea62fe
2025-12-13 00:26:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ed570c118b2c48139d4e7990fe1d81bd (experiment: slowfast)
2025-12-13 00:26:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:15 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ed570c118b2c48139d4e7990fe1d81bd
2025-12-13 00:26:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 90e88019b9874e7bbe72f2a00aca5e6c (experiment: slowfast)
2025-12-13 00:26:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:17 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 90e88019b9874e7bbe72f2a00aca5e6c
2025-12-13 00:26:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e1034c5b35dc4ce3ab7a4db2d00c39b4 (experiment: slowfast)
2025-12-13 00:26:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:19 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e1034c5b35dc4ce3ab7a4db2d00c39b4
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 26/32
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1dfbef8dfd0f4788b8ec3565dd674e25 (experiment: slowfast)
2025-12-13 00:26:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:21 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1dfbef8dfd0f4788b8ec3565dd674e25
2025-12-13 00:26:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6c7a695188004e05b26c0ab4b4e30a71 (experiment: slowfast)
2025-12-13 00:26:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:22 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6c7a695188004e05b26c0ab4b4e30a71
2025-12-13 00:26:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7f1121dc41cd42a3bfd7a68116f4c0be (experiment: slowfast)
2025-12-13 00:26:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:24 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7f1121dc41cd42a3bfd7a68116f4c0be
2025-12-13 00:26:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a6cf98e7c06649caab0c3a1657590cde (experiment: slowfast)
2025-12-13 00:26:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:27 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a6cf98e7c06649caab0c3a1657590cde
2025-12-13 00:26:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0143d33c6cf14ea18a8cb9582a195b8f (experiment: slowfast)
2025-12-13 00:26:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:29 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0143d33c6cf14ea18a8cb9582a195b8f
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 27/32
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3bfc2a226f844d0485289022fcea8c33 (experiment: slowfast)
2025-12-13 00:26:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:31 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3bfc2a226f844d0485289022fcea8c33
2025-12-13 00:26:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1fac736f7b554e35af0bbb428d91b4a1 (experiment: slowfast)
2025-12-13 00:26:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:32 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1fac736f7b554e35af0bbb428d91b4a1
2025-12-13 00:26:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ce2c154313b44dcfa947689045a48f81 (experiment: slowfast)
2025-12-13 00:26:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:34 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ce2c154313b44dcfa947689045a48f81
2025-12-13 00:26:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1f53967ff1694df3bbef239cd259a47b (experiment: slowfast)
2025-12-13 00:26:35 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:36 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1f53967ff1694df3bbef239cd259a47b
2025-12-13 00:26:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8ef10bd316b94c899b900f40671ba362 (experiment: slowfast)
2025-12-13 00:26:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:38 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8ef10bd316b94c899b900f40671ba362
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 28/32
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: edd0c5ae52944ba3b77baca411a0967c (experiment: slowfast)
2025-12-13 00:26:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:40 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: edd0c5ae52944ba3b77baca411a0967c
2025-12-13 00:26:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0b09dad58ca3489daf0c3246791443ba (experiment: slowfast)
2025-12-13 00:26:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:41 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0b09dad58ca3489daf0c3246791443ba
2025-12-13 00:26:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1219e1685e0b48139cd3ca9f3c72a1fa (experiment: slowfast)
2025-12-13 00:26:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:43 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1219e1685e0b48139cd3ca9f3c72a1fa
2025-12-13 00:26:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c2dcea97c3a146659f9004aef06c2c27 (experiment: slowfast)
2025-12-13 00:26:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:45 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c2dcea97c3a146659f9004aef06c2c27
2025-12-13 00:26:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 001bc86b8e5949538ff4317469e691f5 (experiment: slowfast)
2025-12-13 00:26:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:47 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 001bc86b8e5949538ff4317469e691f5
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 29/32
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c2badebd8ef74438915a8473d4e70298 (experiment: slowfast)
2025-12-13 00:26:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:49 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c2badebd8ef74438915a8473d4e70298
2025-12-13 00:26:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ee23f6cbeab41a0b90e683fca2b024d (experiment: slowfast)
2025-12-13 00:26:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:50 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ee23f6cbeab41a0b90e683fca2b024d
2025-12-13 00:26:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:26:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 62a0067cb4ca4bc383a8e1ab993ae84a (experiment: slowfast)
2025-12-13 00:26:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:26:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:52 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 62a0067cb4ca4bc383a8e1ab993ae84a
2025-12-13 00:26:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:26:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 18609fe54d5c4562b2339a390844ebca (experiment: slowfast)
2025-12-13 00:26:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:26:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:54 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 18609fe54d5c4562b2339a390844ebca
2025-12-13 00:26:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:26:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:26:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8d9f61f773504eae889a07524717a8c0 (experiment: slowfast)
2025-12-13 00:26:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:26:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:56 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8d9f61f773504eae889a07524717a8c0
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 30/32
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:26:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 804a5146a3244379b75f70a5a3c4ce59 (experiment: slowfast)
2025-12-13 00:26:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:26:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:58 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 804a5146a3244379b75f70a5a3c4ce59
2025-12-13 00:26:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:26:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:26:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:26:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:26:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:26:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:26:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f1d07ddecc6c4ceb9b4f29efebabe198 (experiment: slowfast)
2025-12-13 00:26:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:26:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:26:59 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:26:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f1d07ddecc6c4ceb9b4f29efebabe198
2025-12-13 00:27:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:27:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9547d44d657040e09110efcc10f822be (experiment: slowfast)
2025-12-13 00:27:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:27:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:01 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9547d44d657040e09110efcc10f822be
2025-12-13 00:27:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:27:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b1e6574fd7e84a7f8ea6e971cac499c1 (experiment: slowfast)
2025-12-13 00:27:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:27:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:03 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b1e6574fd7e84a7f8ea6e971cac499c1
2025-12-13 00:27:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:27:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d257d7b35977457c97b5097db45d6745 (experiment: slowfast)
2025-12-13 00:27:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:27:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:05 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d257d7b35977457c97b5097db45d6745
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 31/32
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:27:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e353c2e3b8894fe787a4dd4b68814d0c (experiment: slowfast)
2025-12-13 00:27:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:27:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:07 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e353c2e3b8894fe787a4dd4b68814d0c
2025-12-13 00:27:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:27:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:27:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d643819d186641aeb41288870f2b53f9 (experiment: slowfast)
2025-12-13 00:27:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:27:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d643819d186641aeb41288870f2b53f9
2025-12-13 00:27:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:27:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:27:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5b70ddb7ee7542d1bfe742c1c3bab104 (experiment: slowfast)
2025-12-13 00:27:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:27:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:10 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5b70ddb7ee7542d1bfe742c1c3bab104
2025-12-13 00:27:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:27:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:27:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c3a8c0780acb4712a19744e9a3709631 (experiment: slowfast)
2025-12-13 00:27:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:27:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:12 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c3a8c0780acb4712a19744e9a3709631
2025-12-13 00:27:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:27:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-13 00:27:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6d2a48cca84b422987a3872f7803fa4e (experiment: slowfast)
2025-12-13 00:27:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:27:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:14 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6d2a48cca84b422987a3872f7803fa4e
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 32/32
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 533326f069894e54a102062b5428228e (experiment: slowfast)
2025-12-13 00:27:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-13 00:27:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:16 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 533326f069894e54a102062b5428228e
2025-12-13 00:27:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-13 00:27:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 52532afff1104474ab6b956c5a53301a (experiment: slowfast)
2025-12-13 00:27:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-13 00:27:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:18 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 52532afff1104474ab6b956c5a53301a
2025-12-13 00:27:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-13 00:27:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 726f65372bd64fedbf6cc8fd741c44c4 (experiment: slowfast)
2025-12-13 00:27:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-13 00:27:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:19 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 726f65372bd64fedbf6cc8fd741c44c4
2025-12-13 00:27:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-13 00:27:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1938ecaa0dfb4d2b91fe9cbd80d8ed76 (experiment: slowfast)
2025-12-13 00:27:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-13 00:27:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:21 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1938ecaa0dfb4d2b91fe9cbd80d8ed76
2025-12-13 00:27:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-13 00:27:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-13 00:27:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1f2170e0001c4dd38f6af5fbe399cb9c (experiment: slowfast)
2025-12-13 00:27:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-13 00:27:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:23 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 00:27:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1f2170e0001c4dd38f6af5fbe399cb9c
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1823] ================================================================================
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1824] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1825] ================================================================================
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1838] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1848] Final training using default hyperparameters (no grid search)
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 1/5 (full dataset)
2025-12-13 00:27:24 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5665026996614a68aae3d9ec739c24b3 (experiment: slowfast)
2025-12-13 00:27:25 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 1 (full dataset)...
2025-12-13 00:27:25 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 00:27:29 [ERROR] [lib.training.pipeline:2226] Error training final fold 1: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:29 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 2/5 (full dataset)
2025-12-13 00:27:30 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a84e16cca2f34da39ac1794ed3a6e3d9 (experiment: slowfast)
2025-12-13 00:27:30 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 2 (full dataset)...
2025-12-13 00:27:30 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 00:27:32 [ERROR] [lib.training.pipeline:2226] Error training final fold 2: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:32 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 3/5 (full dataset)
2025-12-13 00:27:32 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0fd2c27da1824ba5afd2da4c0e598d2e (experiment: slowfast)
2025-12-13 00:27:33 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 3 (full dataset)...
2025-12-13 00:27:33 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 00:27:34 [ERROR] [lib.training.pipeline:2226] Error training final fold 3: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:34 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 4/5 (full dataset)
2025-12-13 00:27:34 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4acae09b943c499989d1421adea0c4f3 (experiment: slowfast)
2025-12-13 00:27:35 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 4 (full dataset)...
2025-12-13 00:27:35 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 00:27:35 [ERROR] [lib.training.pipeline:2226] Error training final fold 4: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:35 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 5/5 (full dataset)
2025-12-13 00:27:35 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 00:27:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-13 00:27:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-13 00:27:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-13 00:27:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ab03d22b5fbd4dd28362a31d631eb7f7 (experiment: slowfast)
2025-12-13 00:27:36 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 5 (full dataset)...
2025-12-13 00:27:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 00:27:37 [ERROR] [lib.training.pipeline:2226] Error training final fold 5: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 00:27:37 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/fold_1 to copy
2025-12-13 00:27:37 [INFO] [lib.training.pipeline:2299] 
slowfast - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-13 00:27:39 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots/cv_fold_comparison.png
2025-12-13 00:27:39 [INFO] [lib.training.pipeline:2327] Generated plots for slowfast in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots
2025-12-13 00:27:39 [INFO] [lib.training.pipeline:2364] ================================================================================
2025-12-13 00:27:39 [INFO] [lib.training.pipeline:2365] Stage 5: Model Training Pipeline Completed
2025-12-13 00:27:39 [INFO] [lib.training.pipeline:2366] ================================================================================
2025-12-13 00:27:39 [INFO] [__main__:401] ================================================================================
2025-12-13 00:27:39 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-13 00:27:39 [INFO] [__main__:403] ================================================================================
2025-12-13 00:27:39 [INFO] [__main__:404] Execution time: 319.44 seconds (5.32 minutes)
2025-12-13 00:27:39 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 00:27:39 [INFO] [__main__:407] Models trained: ['slowfast']
2025-12-13 00:27:39 [INFO] [__main__:408] K-fold splits: 5
2025-12-13 00:27:39 [INFO] [__main__:414] ================================================================================
2025-12-13 00:27:39 [INFO] [__main__:415] Final memory statistics:
2025-12-13 00:27:39 [INFO] [__main__:416] ================================================================================
2025-12-13 00:27:39 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 3098.71484375, 'cpu_memory_gb': 3.0260887145996094, 'cpu_vms_mb': 49418.375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.285212672, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.643129344}
2025-12-13 00:27:39 [INFO] [__main__:419] ================================================================================
2025-12-13 00:27:39 [INFO] [__main__:420] Training complete!
2025-12-13 00:27:39 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 00:27:39 [INFO] [__main__:422] ================================================================================
