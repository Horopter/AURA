2025-12-14 11:51:57 [INFO] [__main__:310] ================================================================================
2025-12-14 11:51:57 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-14 11:51:57 [INFO] [__main__:312] ================================================================================
2025-12-14 11:51:57 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-14 11:51:57 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-14 11:51:57 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-14 11:51:57 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-14 11:51:57 [INFO] [__main__:317] Model types: ['xgboost_vit_transformer']
2025-12-14 11:51:57 [INFO] [__main__:318] K-fold splits: 5
2025-12-14 11:51:57 [INFO] [__main__:319] Number of frames: 1000
2025-12-14 11:51:57 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 11:51:57 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-14 11:51:57 [INFO] [__main__:324] Delete existing: False
2025-12-14 11:51:57 [INFO] [__main__:325] Resume mode: True
2025-12-14 11:51:57 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765731117.log
2025-12-14 11:51:57 [INFO] [__main__:333] ================================================================================
2025-12-14 11:51:57 [INFO] [__main__:334] Checking prerequisites...
2025-12-14 11:51:57 [INFO] [__main__:335] ================================================================================
2025-12-14 11:51:57 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-14 11:51:57 [INFO] [__main__:352] ✓ All model types are valid
2025-12-14 11:51:57 [INFO] [__main__:358] ================================================================================
2025-12-14 11:51:57 [INFO] [__main__:359] Initial memory statistics:
2025-12-14 11:51:57 [INFO] [__main__:360] ================================================================================
2025-12-14 11:51:58 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.875, 'cpu_memory_gb': 0.7186279296875, 'cpu_vms_mb': 10218.62109375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-14 11:51:58 [INFO] [__main__:364] ================================================================================
2025-12-14 11:51:58 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-14 11:51:58 [INFO] [__main__:366] ================================================================================
2025-12-14 11:51:58 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-14 11:51:58 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-14 11:51:58 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-14 11:51:58 [INFO] [__main__:370] ================================================================================
2025-12-14 11:51:58 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-14 11:51:58 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-14 11:51:58 [ERROR] [__main__:439] ================================================================================
2025-12-14 11:51:58 [ERROR] [__main__:440] STAGE 5 FAILED
2025-12-14 11:51:58 [ERROR] [__main__:441] ================================================================================
2025-12-14 11:51:58 [ERROR] [__main__:442] Error: cannot access local variable 'os' where it is not associated with a value
2025-12-14 11:51:58 [ERROR] [__main__:443] Exception type: UnboundLocalError
2025-12-14 11:51:58 [ERROR] [__main__:444] Full traceback:
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage5_training.py", line 382, in main
    results = stage5_train_models(
              ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 489, in stage5_train_models
    if "PYTORCH_CUDA_ALLOC_CONF" not in os.environ:
                                        ^^
UnboundLocalError: cannot access local variable 'os' where it is not associated with a value
2025-12-14 11:51:58 [ERROR] [__main__:445] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-14 11:51:58 [ERROR] [__main__:446] Partial results may be available
2025-12-14 11:51:58 [ERROR] [__main__:447] ================================================================================
