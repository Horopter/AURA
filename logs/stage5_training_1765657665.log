2025-12-13 15:27:45 [INFO] [__main__:310] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 15:27:45 [INFO] [__main__:312] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 15:27:45 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 15:27:45 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 15:27:45 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 15:27:45 [INFO] [__main__:317] Model types: ['xgboost_pretrained_inception']
2025-12-13 15:27:45 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 15:27:45 [INFO] [__main__:319] Number of frames: 1000
2025-12-13 15:27:45 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 15:27:45 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 15:27:45 [INFO] [__main__:324] Delete existing: True
2025-12-13 15:27:45 [INFO] [__main__:325] Resume mode: True
2025-12-13 15:27:45 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765657665.log
2025-12-13 15:27:45 [INFO] [__main__:333] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 15:27:45 [INFO] [__main__:335] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 15:27:45 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 15:27:45 [INFO] [__main__:358] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 15:27:45 [INFO] [__main__:360] ================================================================================
2025-12-13 15:27:45 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 735.79296875, 'cpu_memory_gb': 0.7185478210449219, 'cpu_vms_mb': 10217.7890625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 15:27:45 [INFO] [__main__:364] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 15:27:45 [INFO] [__main__:366] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 15:27:45 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 15:27:45 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 15:27:45 [INFO] [__main__:370] ================================================================================
2025-12-13 15:27:45 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 15:27:45 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:497] ================================================================================
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:498] Stage 5: Model Training Pipeline Started
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:499] ================================================================================
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:500] Model types: ['xgboost_pretrained_inception']
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:501] K-fold splits: 5
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:502] Frames per video: 1000
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:503] Output directory: data/stage5
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:504] Initializing pipeline...
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:266] ================================================================================
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:267] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:268] ================================================================================
2025-12-13 15:27:45 [INFO] [lib.training.pipeline:271] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:280] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:281]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:284] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:292] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:293]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:296] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:304] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:305]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:308] 
================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:309] MODEL REQUIREMENTS CHECK
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:310] ================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:334] ✓ xgboost_pretrained_inception: CAN RUN
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:337] 
================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:338] VALIDATION SUMMARY
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:339] ================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:340] Stage 3 (scaled videos): ✓ Available
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:341]   Count: 3278 videos
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:342] Stage 2 (features): ✓ Available
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:343]   Count: 3278 feature rows
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:344] Stage 4 (scaled features): ✓ Available
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:345]   Count: 3277 feature rows
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:346] 
Runnable models: 1/1
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:347]   ['xgboost_pretrained_inception']
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:354] ================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:590] 
Stage 5: Loading metadata...
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:616] Loaded metadata: 3278 rows
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:626] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 15:27:47 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=828200.40GB, used=1671639.60GB (66.9%)
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:648] Loading Stage 2 and Stage 4 features (required for feature-based models)...
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:658] Stage 5: Found 3278 scaled videos
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:663] ================================================================================
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:664] STAGE 5: VALIDATING VIDEOS (checking for corruption and empty videos)
2025-12-13 15:27:47 [INFO] [lib.training.pipeline:665] ================================================================================
2025-12-13 15:27:47 [INFO] [lib.data.loading:151] Checking file existence for 3278 videos...
2025-12-13 15:27:52 [INFO] [lib.data.loading:161] Found 3278 existing video files (filtered out 0 missing files)
2025-12-13 15:27:52 [INFO] [lib.data.loading:165] Checking for corrupted videos (moov atom errors, etc.)...
2025-12-13 15:27:52 [INFO] [lib.data.loading:193] No cache found, validating all 3278 videos
2025-12-13 15:40:11 [INFO] [lib.data.loading:262]   Validated 500/3278 videos... (corrupted: 0, empty: 0)
2025-12-13 15:51:55 [INFO] [lib.data.loading:262]   Validated 1000/3278 videos... (corrupted: 0, empty: 0)
2025-12-13 16:01:51 [INFO] [lib.data.loading:262]   Validated 1500/3278 videos... (corrupted: 0, empty: 0)
2025-12-13 16:13:19 [INFO] [lib.data.loading:262]   Validated 2000/3278 videos... (corrupted: 0, empty: 0)
2025-12-13 16:15:15 [ERROR] [libav.mov,mp4,m4a,3gp,3g2,mj2:337] moov atom not found
2025-12-13 16:24:59 [INFO] [lib.data.loading:262]   Validated 2500/3278 videos... (corrupted: 1, empty: 0)
2025-12-13 16:35:27 [INFO] [lib.data.loading:262]   Validated 3000/3278 videos... (corrupted: 1, empty: 0)
2025-12-13 16:40:54 [INFO] [lib.data.loading:262]   Validated 3278/3278 videos... (corrupted: 1, empty: 0)
2025-12-13 16:40:57 [INFO] [lib.data.loading:109] Saved validation cache to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/.video_validation_cache/validation_0192be168a40eb7e_corruptTrue_framesTrue.parquet (3278 entries)
2025-12-13 16:40:57 [WARNING] [lib.data.loading:301] Filtered out 1 corrupted videos and 0 empty videos. Keeping 3277 valid videos.
2025-12-13 16:40:57 [WARNING] [lib.data.loading:306] Sample of invalid videos:
2025-12-13 16:40:57 [WARNING] [lib.data.loading:308]   data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: Corrupted video: moov atom not found
2025-12-13 16:40:57 [INFO] [lib.data.loading:319] Checking video frames (this may take a while and use memory)...
2025-12-13 17:53:01 [INFO] [lib.data.loading:355] ✓ All 3277 videos have frames
2025-12-13 17:53:01 [INFO] [lib.data.loading:356] Frame check complete.
2025-12-13 17:53:01 [WARNING] [lib.data.loading:367] Filtered out 1 invalid videos (corrupted or empty). Keeping 3277 valid videos.
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:677] ✓ Video validation complete: 3277 valid videos ready for training
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:678] ================================================================================
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:764] Frame caching enabled (default): cache_dir=data/.frame_cache. This will cache processed frames to disk to speed up training. First epoch will be slower (building cache), subsequent epochs will be faster. To disable, set FVC_USE_FRAME_CACHE=0
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:833] Overriding num_frames to 400 for xgboost_pretrained_inception (XGBoost pretrained model with enhanced features) to balance performance and memory. Original num_frames was 1000.
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:867] Stage 5: Deleting existing model results (clean mode)...
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:876] Deleted existing results for xgboost_pretrained_inception
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:879] Stage 5: Deleted 1 existing model directories
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:884] 
================================================================================
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:885] Stage 5: Training model: xgboost_pretrained_inception
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:886] ================================================================================
2025-12-13 17:53:01 [INFO] [lib.training.pipeline:907] Overriding model_config num_frames to 400 for xgboost_pretrained_inception (XGBoost pretrained model with enhanced feature extraction) to improve feature quality.
2025-12-13 17:53:02 [INFO] [lib.training.pipeline:927] Grid search: 1 hyperparameter combinations to try
2025-12-13 17:53:02 [INFO] [lib.training.pipeline:941] ================================================================================
2025-12-13 17:53:02 [INFO] [lib.training.pipeline:942] HYPERPARAMETER SEARCH: Using 10.0% stratified sample for efficiency
2025-12-13 17:53:02 [INFO] [lib.training.pipeline:943] ================================================================================
2025-12-13 17:53:03 [INFO] [lib.training.pipeline:953] Hyperparameter search sample: 327 rows (10.0% of 3277 total)
2025-12-13 17:53:03 [INFO] [lib.training.pipeline:954] To change sample size, set FVC_GRID_SEARCH_SAMPLE_SIZE environment variable (current: 0.1)
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:967] Using 5-fold stratified cross-validation on 10.0% sample for hyperparameter search
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:980] 
================================================================================
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:981] Grid Search: Hyperparameter combination 1/1
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:982] Parameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:983] ================================================================================
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:1012] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 1/5 (10.0% sample)
2025-12-13 17:53:04 [INFO] [lib.training.pipeline:1598] Training XGBoost model xgboost_pretrained_inception on fold 1...
2025-12-13 17:53:04 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 17:53:04 [INFO] [lib.training._xgboost_pretrained:618] Processing 261 videos...
2025-12-13 17:53:05 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 17:53:07 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 17:53:07 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 17:53:08 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 18:04:32 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-13 18:04:32 [INFO] [lib.training._xgboost_pretrained:603] Cleared pretrained_inception model from GPU after feature extraction
2025-12-13 18:04:32 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 18:04:32 [INFO] [lib.training.feature_preprocessing:77] Removed 16 features with zero variance
2025-12-13 18:04:33 [INFO] [lib.training.feature_preprocessing:141] Removed 452 collinear features (correlation >= 0.95)
2025-12-13 18:04:33 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1964/2432 (80.8% retained)
2025-12-13 18:04:33 [INFO] [lib.training._xgboost_pretrained:648] Using 1964 features after collinearity removal
2025-12-13 18:04:33 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-13 18:04:33 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-13 18:04:33 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 18:04:33 [ERROR] [lib.training.pipeline:1666] Error training XGBoost fold 1: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1613, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 704, in fit
    self.model.fit(
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
TypeError: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
2025-12-13 18:04:34 [INFO] [lib.training.pipeline:1012] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 2/5 (10.0% sample)
2025-12-13 18:04:34 [INFO] [lib.training.pipeline:1598] Training XGBoost model xgboost_pretrained_inception on fold 2...
2025-12-13 18:04:34 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 18:04:34 [INFO] [lib.training._xgboost_pretrained:618] Processing 261 videos...
2025-12-13 18:04:34 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 18:04:34 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 18:04:35 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 18:04:35 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 18:15:41 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (261, 2432)
2025-12-13 18:15:41 [INFO] [lib.training._xgboost_pretrained:603] Cleared pretrained_inception model from GPU after feature extraction
2025-12-13 18:15:41 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 18:15:41 [INFO] [lib.training.feature_preprocessing:77] Removed 10 features with zero variance
2025-12-13 18:15:42 [INFO] [lib.training.feature_preprocessing:141] Removed 458 collinear features (correlation >= 0.95)
2025-12-13 18:15:42 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1964/2432 (80.8% retained)
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:648] Using 1964 features after collinearity removal
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=133, scale_pos_weight=0.962
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 208 train samples, 53 validation samples for early stopping
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 18:15:42 [ERROR] [lib.training.pipeline:1666] Error training XGBoost fold 2: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1613, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 704, in fit
    self.model.fit(
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
TypeError: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
2025-12-13 18:15:42 [INFO] [lib.training.pipeline:1012] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 3/5 (10.0% sample)
2025-12-13 18:15:42 [INFO] [lib.training.pipeline:1598] Training XGBoost model xgboost_pretrained_inception on fold 3...
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 18:15:42 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 18:15:43 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 18:15:43 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 18:15:43 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 18:15:44 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 18:26:41 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 18:26:41 [INFO] [lib.training._xgboost_pretrained:603] Cleared pretrained_inception model from GPU after feature extraction
2025-12-13 18:26:42 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 18:26:42 [INFO] [lib.training.feature_preprocessing:77] Removed 14 features with zero variance
2025-12-13 18:26:42 [INFO] [lib.training.feature_preprocessing:141] Removed 444 collinear features (correlation >= 0.95)
2025-12-13 18:26:42 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1974/2432 (81.2% retained)
2025-12-13 18:26:42 [INFO] [lib.training._xgboost_pretrained:648] Using 1974 features after collinearity removal
2025-12-13 18:26:42 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 18:26:42 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 18:26:42 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 18:26:42 [ERROR] [lib.training.pipeline:1666] Error training XGBoost fold 3: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1613, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 704, in fit
    self.model.fit(
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
TypeError: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
2025-12-13 18:26:43 [INFO] [lib.training.pipeline:1012] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 4/5 (10.0% sample)
2025-12-13 18:26:43 [INFO] [lib.training.pipeline:1598] Training XGBoost model xgboost_pretrained_inception on fold 4...
2025-12-13 18:26:43 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 18:26:43 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 18:26:43 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 18:26:43 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 18:26:44 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 18:26:44 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 18:37:38 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 18:37:39 [INFO] [lib.training._xgboost_pretrained:603] Cleared pretrained_inception model from GPU after feature extraction
2025-12-13 18:37:39 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 18:37:39 [INFO] [lib.training.feature_preprocessing:77] Removed 15 features with zero variance
2025-12-13 18:37:40 [INFO] [lib.training.feature_preprocessing:141] Removed 463 collinear features (correlation >= 0.95)
2025-12-13 18:37:40 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1954/2432 (80.3% retained)
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:648] Using 1954 features after collinearity removal
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 18:37:40 [ERROR] [lib.training.pipeline:1666] Error training XGBoost fold 4: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1613, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 704, in fit
    self.model.fit(
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
TypeError: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
2025-12-13 18:37:40 [INFO] [lib.training.pipeline:1012] 
Hyperparameter Search - xgboost_pretrained_inception - Fold 5/5 (10.0% sample)
2025-12-13 18:37:40 [INFO] [lib.training.pipeline:1598] Training XGBoost model xgboost_pretrained_inception on fold 5...
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:618] Processing 262 videos...
2025-12-13 18:37:40 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 18:37:41 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 18:37:41 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 18:37:41 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
2025-12-13 18:49:03 [INFO] [lib.training._xgboost_pretrained:410] Extracted features shape: (262, 2432)
2025-12-13 18:49:03 [INFO] [lib.training._xgboost_pretrained:603] Cleared pretrained_inception model from GPU after feature extraction
2025-12-13 18:49:03 [INFO] [lib.training._xgboost_pretrained:641] Removing collinear features...
2025-12-13 18:49:03 [INFO] [lib.training.feature_preprocessing:77] Removed 16 features with zero variance
2025-12-13 18:49:04 [INFO] [lib.training.feature_preprocessing:141] Removed 470 collinear features (correlation >= 0.95)
2025-12-13 18:49:04 [INFO] [lib.training.feature_preprocessing:162] Final feature count: 1946/2432 (80.0% retained)
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:648] Using 1946 features after collinearity removal
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:664] Class distribution: Class 0=128, Class 1=134, scale_pos_weight=0.955
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:682] Training XGBoost: 209 train samples, 53 validation samples for early stopping
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:685] Training XGBoost with improved architecture (multi-layer + temporal pooling + class weights + early stopping)...
2025-12-13 18:49:04 [ERROR] [lib.training.pipeline:1666] Error training XGBoost fold 5: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1613, in stage5_train_models
    model.fit(train_df, project_root=project_root_str_orig)
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_xgboost_pretrained.py", line 704, in fit
    self.model.fit(
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
TypeError: XGBClassifier.fit() got an unexpected keyword argument 'callbacks'
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1920] Parameter combination 1 - Mean F1: nan, Mean Acc: nan
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1932] Using single parameter combination: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1935] ================================================================================
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1936] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1937] ================================================================================
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1950] Final training: Using 5-fold stratified cross-validation on full dataset (3277 rows)
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1958] Final training using best hyperparameters: {'n_estimators': 100, 'max_depth': 5, 'learning_rate': 0.1, 'subsample': 0.8, 'colsample_bytree': 0.8}
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1964] 
Final Training - xgboost_pretrained_inception - Fold 1/5 (full dataset)
2025-12-13 18:49:04 [INFO] [lib.training.pipeline:1973] Deleted existing final training fold 1 directory (clean mode)
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:617] Training XGBoost on features from pretrained_inception...
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:618] Processing 2621 videos...
2025-12-13 18:49:04 [INFO] [lib.training._xgboost_pretrained:522] Loading pretrained model: pretrained_inception (num_frames=400)
2025-12-13 18:49:05 [INFO] [lib.training._xgboost_pretrained:537] Loaded pretrained_inception model to GPU, cleared cache
2025-12-13 18:49:05 [INFO] [lib.training._xgboost_pretrained:585] Extracting features using pretrained_inception (num_frames=400)...
2025-12-13 18:49:05 [INFO] [lib.training._xgboost_pretrained:101] Applied PyTorch memory optimizations for feature extraction
