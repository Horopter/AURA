2025-12-12 22:25:15 [INFO] [__main__:310] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-12 22:25:15 [INFO] [__main__:312] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-12 22:25:15 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:25:15 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 22:25:15 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 22:25:15 [INFO] [__main__:317] Model types: ['slowfast']
2025-12-12 22:25:15 [INFO] [__main__:318] K-fold splits: 5
2025-12-12 22:25:15 [INFO] [__main__:319] Number of frames: 500
2025-12-12 22:25:15 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:25:15 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-12 22:25:15 [INFO] [__main__:324] Delete existing: False
2025-12-12 22:25:15 [INFO] [__main__:325] Resume mode: True
2025-12-12 22:25:15 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765596315.log
2025-12-12 22:25:15 [INFO] [__main__:333] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:334] Checking prerequisites...
2025-12-12 22:25:15 [INFO] [__main__:335] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:25:15 [INFO] [__main__:352] ✓ All model types are valid
2025-12-12 22:25:15 [INFO] [__main__:358] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:359] Initial memory statistics:
2025-12-12 22:25:15 [INFO] [__main__:360] ================================================================================
2025-12-12 22:25:15 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.8046875, 'cpu_memory_gb': 0.7195358276367188, 'cpu_vms_mb': 10218.375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-12 22:25:15 [INFO] [__main__:364] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-12 22:25:15 [INFO] [__main__:366] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-12 22:25:15 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-12 22:25:15 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-12 22:25:15 [INFO] [__main__:370] ================================================================================
2025-12-12 22:25:15 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-12 22:25:15 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:499] Model types: ['slowfast']
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:501] Frames per video: 500
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-12 22:25:15 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:333] ✓ slowfast: CAN RUN
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:346]   ['slowfast']
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-12 22:25:16 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=832286.67GB, used=1667553.33GB (66.7%)
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:705] Enabling adaptive chunked frame loading for slowfast: initial_chunk_size=30, num_frames=500. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:788] 
================================================================================
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:789] Stage 5: Training model: slowfast
2025-12-12 22:25:16 [INFO] [lib.training.pipeline:790] ================================================================================
2025-12-12 22:25:18 [INFO] [lib.training.pipeline:823] Grid search: 32 hyperparameter combinations to try
2025-12-12 22:25:18 [INFO] [lib.training.pipeline:831] ================================================================================
2025-12-12 22:25:18 [INFO] [lib.training.pipeline:832] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-12 22:25:18 [INFO] [lib.training.pipeline:833] ================================================================================
2025-12-12 22:25:18 [INFO] [lib.training.pipeline:842] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:855] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 1/32
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4ceff50a8ca7442d96518fc82dda4cef (experiment: slowfast)
2025-12-12 22:25:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:25:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:29 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4ceff50a8ca7442d96518fc82dda4cef
2025-12-12 22:25:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:25:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a12c27be49ce41d182618d237950ce65 (experiment: slowfast)
2025-12-12 22:25:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:25:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:31 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a12c27be49ce41d182618d237950ce65
2025-12-12 22:25:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:25:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3f128cbe3f434fd184d3610c3d474e46 (experiment: slowfast)
2025-12-12 22:25:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:25:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:33 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3f128cbe3f434fd184d3610c3d474e46
2025-12-12 22:25:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:25:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ffee837393bb41c9a7f9a8a0bd71dc90 (experiment: slowfast)
2025-12-12 22:25:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:25:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:35 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ffee837393bb41c9a7f9a8a0bd71dc90
2025-12-12 22:25:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:25:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 87c60a0e07c0419a8f3b150de8f3dbf7 (experiment: slowfast)
2025-12-12 22:25:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:25:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:37 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 87c60a0e07c0419a8f3b150de8f3dbf7
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 2/32
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dbd547e5d7674fc3a1f93c415b886e2a (experiment: slowfast)
2025-12-12 22:25:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:25:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:39 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dbd547e5d7674fc3a1f93c415b886e2a
2025-12-12 22:25:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:25:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d95e1fff792348b2a2d4ac304c6f3650 (experiment: slowfast)
2025-12-12 22:25:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:25:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:40 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d95e1fff792348b2a2d4ac304c6f3650
2025-12-12 22:25:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:25:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dc7f0789a5c24aa581c5f88f18fd2980 (experiment: slowfast)
2025-12-12 22:25:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:25:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:42 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dc7f0789a5c24aa581c5f88f18fd2980
2025-12-12 22:25:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:25:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0e2108496964457b831fb6276bea97fb (experiment: slowfast)
2025-12-12 22:25:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:25:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:45 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0e2108496964457b831fb6276bea97fb
2025-12-12 22:25:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:25:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a9cb5f23714d4cdd9d2b98b029004caf (experiment: slowfast)
2025-12-12 22:25:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:25:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:47 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a9cb5f23714d4cdd9d2b98b029004caf
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 3/32
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4ab92e672c23420290c9c7d8bef7e98c (experiment: slowfast)
2025-12-12 22:25:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:25:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:49 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4ab92e672c23420290c9c7d8bef7e98c
2025-12-12 22:25:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:25:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b7efcea77444cd48179c1ce7aebf5b8 (experiment: slowfast)
2025-12-12 22:25:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:25:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:50 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b7efcea77444cd48179c1ce7aebf5b8
2025-12-12 22:25:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:25:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c0d63019e71547728f0a2914337f58ec (experiment: slowfast)
2025-12-12 22:25:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:25:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:52 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c0d63019e71547728f0a2914337f58ec
2025-12-12 22:25:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:25:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 69fc0fab53a64084b2ba400693a07f48 (experiment: slowfast)
2025-12-12 22:25:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:25:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:54 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 69fc0fab53a64084b2ba400693a07f48
2025-12-12 22:25:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:25:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:25:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 744ed76735864801be345c8b6a2efd7b (experiment: slowfast)
2025-12-12 22:25:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:25:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:56 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 744ed76735864801be345c8b6a2efd7b
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 4/32
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:25:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:25:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a8caec7629734ca79dbe78a6eb1f20c6 (experiment: slowfast)
2025-12-12 22:25:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:25:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:25:58 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:25:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a8caec7629734ca79dbe78a6eb1f20c6
2025-12-12 22:25:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:25:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:25:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:25:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:25:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 85f108d81db241d4bdaf8e18e1714f6d (experiment: slowfast)
2025-12-12 22:26:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:00 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 85f108d81db241d4bdaf8e18e1714f6d
2025-12-12 22:26:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 22b9d7903f1c4f58853e65563bfe83ab (experiment: slowfast)
2025-12-12 22:26:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:02 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 22b9d7903f1c4f58853e65563bfe83ab
2025-12-12 22:26:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b6ff6762b0e642ca882881b75ec82aa2 (experiment: slowfast)
2025-12-12 22:26:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:04 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b6ff6762b0e642ca882881b75ec82aa2
2025-12-12 22:26:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4cf72a401494419682f9716dbc2f7c09 (experiment: slowfast)
2025-12-12 22:26:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:06 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4cf72a401494419682f9716dbc2f7c09
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 5/32
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: db2a722a0a794f24862569353f050e15 (experiment: slowfast)
2025-12-12 22:26:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: db2a722a0a794f24862569353f050e15
2025-12-12 22:26:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 89f7f2d23d824512bd77eb8315b31f24 (experiment: slowfast)
2025-12-12 22:26:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:09 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 89f7f2d23d824512bd77eb8315b31f24
2025-12-12 22:26:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0beea5c10fc440ffb508863d766e122b (experiment: slowfast)
2025-12-12 22:26:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0beea5c10fc440ffb508863d766e122b
2025-12-12 22:26:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:13 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c27fef61823a456db83a55be048f9340 (experiment: slowfast)
2025-12-12 22:26:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c27fef61823a456db83a55be048f9340
2025-12-12 22:26:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5c6d36b72c6c4019ac16b5161ac6d05f (experiment: slowfast)
2025-12-12 22:26:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5c6d36b72c6c4019ac16b5161ac6d05f
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 6/32
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4168d334db384b3da469b38cba7beac4 (experiment: slowfast)
2025-12-12 22:26:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4168d334db384b3da469b38cba7beac4
2025-12-12 22:26:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7f9e26f55b164d31bafc3fa4cdb16966 (experiment: slowfast)
2025-12-12 22:26:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7f9e26f55b164d31bafc3fa4cdb16966
2025-12-12 22:26:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 52c73afb13054530b4f11cad8a39e603 (experiment: slowfast)
2025-12-12 22:26:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 52c73afb13054530b4f11cad8a39e603
2025-12-12 22:26:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3b20c056762e453985baa57bbb33881c (experiment: slowfast)
2025-12-12 22:26:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:24 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3b20c056762e453985baa57bbb33881c
2025-12-12 22:26:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 60541d2d84fd45d38e89d4448b4326d3 (experiment: slowfast)
2025-12-12 22:26:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:26 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 60541d2d84fd45d38e89d4448b4326d3
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 7/32
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3b570e549f0b4a3e8961fd4ff8c8aace (experiment: slowfast)
2025-12-12 22:26:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:28 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3b570e549f0b4a3e8961fd4ff8c8aace
2025-12-12 22:26:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d4d76072a4e14b509067e1531750e08b (experiment: slowfast)
2025-12-12 22:26:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:29 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d4d76072a4e14b509067e1531750e08b
2025-12-12 22:26:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 78245dc7d944448ba0008b22ad37f988 (experiment: slowfast)
2025-12-12 22:26:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:31 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 78245dc7d944448ba0008b22ad37f988
2025-12-12 22:26:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 329d730b66b440bb9ea606216ef8c79d (experiment: slowfast)
2025-12-12 22:26:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:33 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 329d730b66b440bb9ea606216ef8c79d
2025-12-12 22:26:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 77bfa03f9aa34b30af0447eb73d75f55 (experiment: slowfast)
2025-12-12 22:26:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:35 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 77bfa03f9aa34b30af0447eb73d75f55
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 8/32
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2cde8fd1ae5f4b99a89fc9fc382ee00f (experiment: slowfast)
2025-12-12 22:26:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:37 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2cde8fd1ae5f4b99a89fc9fc382ee00f
2025-12-12 22:26:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 19329a1bf34742c9b5da168767c6991f (experiment: slowfast)
2025-12-12 22:26:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:38 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 19329a1bf34742c9b5da168767c6991f
2025-12-12 22:26:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 077270e202534ba48ad3e44eda2c5294 (experiment: slowfast)
2025-12-12 22:26:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:40 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 077270e202534ba48ad3e44eda2c5294
2025-12-12 22:26:41 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:41 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:42 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4386a384b82a4b8eb211948a916bae97 (experiment: slowfast)
2025-12-12 22:26:42 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:43 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4386a384b82a4b8eb211948a916bae97
2025-12-12 22:26:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b9f6f4cb07c247f4932e93eff563d348 (experiment: slowfast)
2025-12-12 22:26:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:45 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b9f6f4cb07c247f4932e93eff563d348
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 9/32
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 53163c83f6bc4560ad8cf3551791649c (experiment: slowfast)
2025-12-12 22:26:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:47 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 53163c83f6bc4560ad8cf3551791649c
2025-12-12 22:26:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ec1561a668b24833b2b7752f6d9f1d0f (experiment: slowfast)
2025-12-12 22:26:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:48 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ec1561a668b24833b2b7752f6d9f1d0f
2025-12-12 22:26:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fae5daf04a7148a5ac954731870162da (experiment: slowfast)
2025-12-12 22:26:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:50 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fae5daf04a7148a5ac954731870162da
2025-12-12 22:26:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:26:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f30ecf7c36404a76b661ca7a032ca560 (experiment: slowfast)
2025-12-12 22:26:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:26:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:52 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f30ecf7c36404a76b661ca7a032ca560
2025-12-12 22:26:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:26:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:26:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0189400bcffd481bb60e41bda9a10d01 (experiment: slowfast)
2025-12-12 22:26:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:26:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:54 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0189400bcffd481bb60e41bda9a10d01
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 10/32
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:26:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9a823b1548134b559a768d425517b8e5 (experiment: slowfast)
2025-12-12 22:26:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:26:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:56 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9a823b1548134b559a768d425517b8e5
2025-12-12 22:26:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:26:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d81493ad15ec4164afa764f4e2b73148 (experiment: slowfast)
2025-12-12 22:26:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:26:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:58 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:26:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d81493ad15ec4164afa764f4e2b73148
2025-12-12 22:26:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:26:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:26:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:26:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:26:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:26:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:26:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 57cad90264a14d80b6e0360fb1f68f88 (experiment: slowfast)
2025-12-12 22:26:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:26:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:26:59 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 57cad90264a14d80b6e0360fb1f68f88
2025-12-12 22:27:00 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:00 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:01 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:01 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2994d323cadb4d3b9047bb2dee34dde1 (experiment: slowfast)
2025-12-12 22:27:01 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:02 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2994d323cadb4d3b9047bb2dee34dde1
2025-12-12 22:27:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 82f18f07676248528c559e70ef0eeeed (experiment: slowfast)
2025-12-12 22:27:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:04 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 82f18f07676248528c559e70ef0eeeed
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 11/32
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e8626c0d9633410baefeac646cf7cfbe (experiment: slowfast)
2025-12-12 22:27:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:06 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e8626c0d9633410baefeac646cf7cfbe
2025-12-12 22:27:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3e4064a900c34ad4862fe61b30fba6cf (experiment: slowfast)
2025-12-12 22:27:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:07 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3e4064a900c34ad4862fe61b30fba6cf
2025-12-12 22:27:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8b05a2bb96494c56b6039dbcae1e0402 (experiment: slowfast)
2025-12-12 22:27:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:09 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8b05a2bb96494c56b6039dbcae1e0402
2025-12-12 22:27:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8d4f34f7429c4d26999a9b60f130501f (experiment: slowfast)
2025-12-12 22:27:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:11 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8d4f34f7429c4d26999a9b60f130501f
2025-12-12 22:27:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b9535a4bc8174c0881df8559d3a853a8 (experiment: slowfast)
2025-12-12 22:27:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:13 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b9535a4bc8174c0881df8559d3a853a8
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 12/32
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1deb08c6bb8d43d9b18c73f1f102b456 (experiment: slowfast)
2025-12-12 22:27:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:15 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1deb08c6bb8d43d9b18c73f1f102b456
2025-12-12 22:27:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b7e564a5c01c4fb88acf13f1534f94ae (experiment: slowfast)
2025-12-12 22:27:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:16 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b7e564a5c01c4fb88acf13f1534f94ae
2025-12-12 22:27:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8c4e3c855721414c8b200f500359ae35 (experiment: slowfast)
2025-12-12 22:27:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:18 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8c4e3c855721414c8b200f500359ae35
2025-12-12 22:27:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:19 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:19 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 23711e1f8b114fe3bd7b42fd5b013830 (experiment: slowfast)
2025-12-12 22:27:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:21 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 23711e1f8b114fe3bd7b42fd5b013830
2025-12-12 22:27:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 38e3cb8de855409c89bfeb0ae3100e65 (experiment: slowfast)
2025-12-12 22:27:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:23 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 38e3cb8de855409c89bfeb0ae3100e65
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 13/32
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8f5ca628b0694608ac953a87224dd36a (experiment: slowfast)
2025-12-12 22:27:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:25 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8f5ca628b0694608ac953a87224dd36a
2025-12-12 22:27:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 72facc11b6764b5ea082195b65175793 (experiment: slowfast)
2025-12-12 22:27:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:26 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 72facc11b6764b5ea082195b65175793
2025-12-12 22:27:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c93049d924f648e9b4f5cb493e6a92b2 (experiment: slowfast)
2025-12-12 22:27:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:28 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c93049d924f648e9b4f5cb493e6a92b2
2025-12-12 22:27:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9dcb39f1aec544ed97137ec13fa07f50 (experiment: slowfast)
2025-12-12 22:27:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:30 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9dcb39f1aec544ed97137ec13fa07f50
2025-12-12 22:27:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f303db3896c24e86b14936d79787c95b (experiment: slowfast)
2025-12-12 22:27:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:32 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f303db3896c24e86b14936d79787c95b
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 14/32
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 29b2dd2dee744ffc85243c21a3bd0bf4 (experiment: slowfast)
2025-12-12 22:27:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:34 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 29b2dd2dee744ffc85243c21a3bd0bf4
2025-12-12 22:27:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2962b4ec8cba4b11bfe540a406692d14 (experiment: slowfast)
2025-12-12 22:27:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2962b4ec8cba4b11bfe540a406692d14
2025-12-12 22:27:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:37 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 282e4155e9f240378bd7771b0231c021 (experiment: slowfast)
2025-12-12 22:27:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 282e4155e9f240378bd7771b0231c021
2025-12-12 22:27:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:39 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dbc55e31993840eb8f8815b27f74f3c0 (experiment: slowfast)
2025-12-12 22:27:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dbc55e31993840eb8f8815b27f74f3c0
2025-12-12 22:27:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:41 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:41 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:41 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5b21ac5c0090455c8b7ef72607ba38dd (experiment: slowfast)
2025-12-12 22:27:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5b21ac5c0090455c8b7ef72607ba38dd
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 15/32
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 823b3c72659e44f5bb5f9536dc296d58 (experiment: slowfast)
2025-12-12 22:27:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:44 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 823b3c72659e44f5bb5f9536dc296d58
2025-12-12 22:27:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e45366820e8646649f4efb493a24fc0f (experiment: slowfast)
2025-12-12 22:27:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:45 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e45366820e8646649f4efb493a24fc0f
2025-12-12 22:27:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 72814b69e3b340178dee962d9fff4df3 (experiment: slowfast)
2025-12-12 22:27:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:47 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 72814b69e3b340178dee962d9fff4df3
2025-12-12 22:27:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1ad1a537b732445d89bbc9ff3e19ffcf (experiment: slowfast)
2025-12-12 22:27:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:49 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1ad1a537b732445d89bbc9ff3e19ffcf
2025-12-12 22:27:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:27:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:51 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ddf0011d3fbb488dada7ab23ae12bae7 (experiment: slowfast)
2025-12-12 22:27:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:27:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:51 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ddf0011d3fbb488dada7ab23ae12bae7
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 16/32
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7479bc6867c742ba84fd5f180399b18d (experiment: slowfast)
2025-12-12 22:27:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:27:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:53 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7479bc6867c742ba84fd5f180399b18d
2025-12-12 22:27:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:27:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0eac5e4965bf4065b09009685260e255 (experiment: slowfast)
2025-12-12 22:27:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:27:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:55 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0eac5e4965bf4065b09009685260e255
2025-12-12 22:27:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:27:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:56 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 55acbde3b6344eea83df5ee3698aa112 (experiment: slowfast)
2025-12-12 22:27:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:27:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:57 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 55acbde3b6344eea83df5ee3698aa112
2025-12-12 22:27:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:27:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:27:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:27:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:27:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:27:58 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:27:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 97583070263e4ac59ec2482c9247ac6c (experiment: slowfast)
2025-12-12 22:27:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:27:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:27:59 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:27:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 97583070263e4ac59ec2482c9247ac6c
2025-12-12 22:27:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:27:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:00 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:00 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:00 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 332b12790e364c5b8b4c6e2602f8ce04 (experiment: slowfast)
2025-12-12 22:28:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:01 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 332b12790e364c5b8b4c6e2602f8ce04
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 17/32
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ee6911db95c4cebb5c313d5fc5e9e5d (experiment: slowfast)
2025-12-12 22:28:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:03 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ee6911db95c4cebb5c313d5fc5e9e5d
2025-12-12 22:28:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 74638f5d02764e7b91070f850969a04f (experiment: slowfast)
2025-12-12 22:28:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:04 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 74638f5d02764e7b91070f850969a04f
2025-12-12 22:28:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3c003a92d8884eb3963afbd943cd20cf (experiment: slowfast)
2025-12-12 22:28:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:06 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3c003a92d8884eb3963afbd943cd20cf
2025-12-12 22:28:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b3d697464d8d493c893248df2f8e558e (experiment: slowfast)
2025-12-12 22:28:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:08 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b3d697464d8d493c893248df2f8e558e
2025-12-12 22:28:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:10 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 243f3036fb1e484fb801df11e1f31025 (experiment: slowfast)
2025-12-12 22:28:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:10 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 243f3036fb1e484fb801df11e1f31025
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 18/32
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f1f51da828494a47bdaf4f642d366cef (experiment: slowfast)
2025-12-12 22:28:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:12 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f1f51da828494a47bdaf4f642d366cef
2025-12-12 22:28:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 463390cbc98a418bb5f10cb31ac8946a (experiment: slowfast)
2025-12-12 22:28:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:14 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 463390cbc98a418bb5f10cb31ac8946a
2025-12-12 22:28:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:15 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ede48d7093f41e193057e6354c758b6 (experiment: slowfast)
2025-12-12 22:28:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:16 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ede48d7093f41e193057e6354c758b6
2025-12-12 22:28:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:17 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9dd363da563c4cd5856aea6c598e6e83 (experiment: slowfast)
2025-12-12 22:28:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:18 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9dd363da563c4cd5856aea6c598e6e83
2025-12-12 22:28:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ff5772c0456f433c8e4fbd67e3f4f95e (experiment: slowfast)
2025-12-12 22:28:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:20 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ff5772c0456f433c8e4fbd67e3f4f95e
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 19/32
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b5e72d9c66cd4a80870a0c673db64d91 (experiment: slowfast)
2025-12-12 22:28:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:22 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b5e72d9c66cd4a80870a0c673db64d91
2025-12-12 22:28:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b52eb95962ad4da795795e8f0b4a62d1 (experiment: slowfast)
2025-12-12 22:28:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:24 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b52eb95962ad4da795795e8f0b4a62d1
2025-12-12 22:28:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e39706e7bea34d569688b6afb41424ef (experiment: slowfast)
2025-12-12 22:28:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:26 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e39706e7bea34d569688b6afb41424ef
2025-12-12 22:28:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:26 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:26 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:26 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f55d48e641934714b6417f5aec005d44 (experiment: slowfast)
2025-12-12 22:28:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:28 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f55d48e641934714b6417f5aec005d44
2025-12-12 22:28:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 652c0f21849d41e7b8e7a0d3fc3e6a86 (experiment: slowfast)
2025-12-12 22:28:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:30 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 652c0f21849d41e7b8e7a0d3fc3e6a86
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 20/32
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ce236fbcf3a462ba01e27f4658ca7ed (experiment: slowfast)
2025-12-12 22:28:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:32 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ce236fbcf3a462ba01e27f4658ca7ed
2025-12-12 22:28:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c45b82b7ea1045c09db45edfc78828a6 (experiment: slowfast)
2025-12-12 22:28:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:33 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c45b82b7ea1045c09db45edfc78828a6
2025-12-12 22:28:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 50288d5cbba743f48b31202091e79db4 (experiment: slowfast)
2025-12-12 22:28:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:35 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 50288d5cbba743f48b31202091e79db4
2025-12-12 22:28:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 418c41937db94729a1bb3251387a4914 (experiment: slowfast)
2025-12-12 22:28:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:37 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:37 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:37 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 418c41937db94729a1bb3251387a4914
2025-12-12 22:28:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:38 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:38 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9f764a5aa4764d3dbcaf1efbe2b220cf (experiment: slowfast)
2025-12-12 22:28:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:39 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:39 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9f764a5aa4764d3dbcaf1efbe2b220cf
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 21/32
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d51f785ed93046caa5043a9f23e7c56c (experiment: slowfast)
2025-12-12 22:28:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:41 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:41 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:41 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d51f785ed93046caa5043a9f23e7c56c
2025-12-12 22:28:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:42 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8534a3fc6cbc41a884ab242699d8c502 (experiment: slowfast)
2025-12-12 22:28:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:43 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8534a3fc6cbc41a884ab242699d8c502
2025-12-12 22:28:43 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:43 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:43 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:43 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:43 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:44 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 683234e657304187aa35675587db7016 (experiment: slowfast)
2025-12-12 22:28:44 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:45 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 683234e657304187aa35675587db7016
2025-12-12 22:28:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:45 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:45 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:46 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36cc10d36f0f4190b5e01bd2cda215e7 (experiment: slowfast)
2025-12-12 22:28:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:47 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:47 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:47 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36cc10d36f0f4190b5e01bd2cda215e7
2025-12-12 22:28:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:47 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:47 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:48 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 70b2d8277b8349d483a6e3033538fb26 (experiment: slowfast)
2025-12-12 22:28:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:49 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 70b2d8277b8349d483a6e3033538fb26
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 22/32
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:49 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:49 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 67b61e81e2234ebba214df19476b5f64 (experiment: slowfast)
2025-12-12 22:28:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:28:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:51 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 67b61e81e2234ebba214df19476b5f64
2025-12-12 22:28:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:28:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:51 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:51 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:52 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5bee83396cd04b4a9f83d2b4f31099d8 (experiment: slowfast)
2025-12-12 22:28:52 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:28:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:52 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5bee83396cd04b4a9f83d2b4f31099d8
2025-12-12 22:28:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:28:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:53 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:53 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:53 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b00773dee534fe1b3ea24c8cfe0a785 (experiment: slowfast)
2025-12-12 22:28:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:28:54 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:54 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:54 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b00773dee534fe1b3ea24c8cfe0a785
2025-12-12 22:28:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:28:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:55 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:55 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26847e5607144e6bb8f157b3f3b3e9d8 (experiment: slowfast)
2025-12-12 22:28:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:28:56 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:56 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:56 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26847e5607144e6bb8f157b3f3b3e9d8
2025-12-12 22:28:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:28:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:28:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:57 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:57 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:28:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4a3bdf40ff724c3f9c36399520cacdcf (experiment: slowfast)
2025-12-12 22:28:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:28:58 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:28:58 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:28:58 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4a3bdf40ff724c3f9c36399520cacdcf
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 23/32
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:28:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:28:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:28:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:28:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 12893276c68945188b5439cddc244ab3 (experiment: slowfast)
2025-12-12 22:29:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:00 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 12893276c68945188b5439cddc244ab3
2025-12-12 22:29:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: da1b18865b544df9ac14beb275e50498 (experiment: slowfast)
2025-12-12 22:29:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:02 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: da1b18865b544df9ac14beb275e50498
2025-12-12 22:29:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:02 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:02 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:03 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8773dc35d8ed49e0854075f23e0b1d79 (experiment: slowfast)
2025-12-12 22:29:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:04 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8773dc35d8ed49e0854075f23e0b1d79
2025-12-12 22:29:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:04 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:04 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:05 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36f655b6ab434be1a0c62066fcb4cf24 (experiment: slowfast)
2025-12-12 22:29:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:06 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:06 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:06 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36f655b6ab434be1a0c62066fcb4cf24
2025-12-12 22:29:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:06 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:06 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:07 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5407159350a548bf829ada4872a09e61 (experiment: slowfast)
2025-12-12 22:29:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:08 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5407159350a548bf829ada4872a09e61
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 24/32
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:08 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:08 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:09 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 137f2b43fec24e1086e7803c87c4359d (experiment: slowfast)
2025-12-12 22:29:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:10 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 137f2b43fec24e1086e7803c87c4359d
2025-12-12 22:29:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:10 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:10 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 76030b2f3ec14a838c797b42b2c10385 (experiment: slowfast)
2025-12-12 22:29:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:11 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:11 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 76030b2f3ec14a838c797b42b2c10385
2025-12-12 22:29:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:12 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:12 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:12 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:12 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 57e27143f51448069fb56346fb64bdd7 (experiment: slowfast)
2025-12-12 22:29:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:13 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 57e27143f51448069fb56346fb64bdd7
2025-12-12 22:29:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:14 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:14 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 48feeb00e62b4080a17244896e235430 (experiment: slowfast)
2025-12-12 22:29:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:15 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 48feeb00e62b4080a17244896e235430
2025-12-12 22:29:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:16 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:16 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 31ffddc82d904c99ad01e48f82fdc0d3 (experiment: slowfast)
2025-12-12 22:29:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:17 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 31ffddc82d904c99ad01e48f82fdc0d3
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 25/32
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1a7576c6468444228d0c54abc2d0410a (experiment: slowfast)
2025-12-12 22:29:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:19 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1a7576c6468444228d0c54abc2d0410a
2025-12-12 22:29:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:20 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 48ac149d02754e5f93d3d309c1cafad5 (experiment: slowfast)
2025-12-12 22:29:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:20 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 48ac149d02754e5f93d3d309c1cafad5
2025-12-12 22:29:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:21 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:21 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:22 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3d159d6ba9174869b8b0b7683eec4c08 (experiment: slowfast)
2025-12-12 22:29:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:22 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3d159d6ba9174869b8b0b7683eec4c08
2025-12-12 22:29:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:23 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:23 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:24 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 686102e421db46c486b981325cb084ed (experiment: slowfast)
2025-12-12 22:29:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:25 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:25 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:25 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 686102e421db46c486b981325cb084ed
2025-12-12 22:29:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:25 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:25 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:26 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6f73101ee65a402b8d6b539df2450297 (experiment: slowfast)
2025-12-12 22:29:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:27 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6f73101ee65a402b8d6b539df2450297
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 26/32
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:28 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 22bf6903abea49299baa4c597bd797f2 (experiment: slowfast)
2025-12-12 22:29:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:29 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 22bf6903abea49299baa4c597bd797f2
2025-12-12 22:29:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:29 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:29 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:29 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:30 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ec4a7ba7373c46d298f034985dcf7125 (experiment: slowfast)
2025-12-12 22:29:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:30 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ec4a7ba7373c46d298f034985dcf7125
2025-12-12 22:29:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:31 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:31 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:31 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:32 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 744f409771de4370bafa57354aa7c94e (experiment: slowfast)
2025-12-12 22:29:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:32 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 744f409771de4370bafa57354aa7c94e
2025-12-12 22:29:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:33 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:33 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:34 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d293e95c38ae491abee901e23b2ed9f9 (experiment: slowfast)
2025-12-12 22:29:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:34 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d293e95c38ae491abee901e23b2ed9f9
2025-12-12 22:29:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:35 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:35 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ae5eefbcd7b3485595a69f45f5093c72 (experiment: slowfast)
2025-12-12 22:29:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:36 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ae5eefbcd7b3485595a69f45f5093c72
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 27/32
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ac010e90c0fe4126948bb4e19e410525 (experiment: slowfast)
2025-12-12 22:29:38 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:38 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:39 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ac010e90c0fe4126948bb4e19e410525
2025-12-12 22:29:39 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:39 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:39 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:39 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1bc17a50ebd24b0296756fc4822e5511 (experiment: slowfast)
2025-12-12 22:29:40 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:40 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1bc17a50ebd24b0296756fc4822e5511
2025-12-12 22:29:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:41 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ef1b62e212914a1397fc0875e1bb3d9b (experiment: slowfast)
2025-12-12 22:29:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:42 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ef1b62e212914a1397fc0875e1bb3d9b
2025-12-12 22:29:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:42 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:42 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:43 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f63a22350f4440e998d3b001c71c4c20 (experiment: slowfast)
2025-12-12 22:29:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:44 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:44 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:44 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f63a22350f4440e998d3b001c71c4c20
2025-12-12 22:29:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c1e18cdadf31470b9f9a389e4332a2ab (experiment: slowfast)
2025-12-12 22:29:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:46 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c1e18cdadf31470b9f9a389e4332a2ab
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 28/32
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0001, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:46 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:46 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:46 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:47 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 10170a460da44b58bacf1f255c9340dc (experiment: slowfast)
2025-12-12 22:29:47 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:48 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 10170a460da44b58bacf1f255c9340dc
2025-12-12 22:29:48 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:48 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:48 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:48 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:48 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:49 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2e48f40fe68d415cbcebd0e1f81b6abd (experiment: slowfast)
2025-12-12 22:29:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:49 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:49 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:49 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2e48f40fe68d415cbcebd0e1f81b6abd
2025-12-12 22:29:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:50 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:50 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:50 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:50 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1c8afa528ad8452eaa9b53b644573665 (experiment: slowfast)
2025-12-12 22:29:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:29:51 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:51 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:51 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1c8afa528ad8452eaa9b53b644573665
2025-12-12 22:29:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:29:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:52 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:52 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:52 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7e0f6069ae5641638bde90e0f4658c52 (experiment: slowfast)
2025-12-12 22:29:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:29:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:53 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7e0f6069ae5641638bde90e0f4658c52
2025-12-12 22:29:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:29:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:29:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:54 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:54 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:55 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:55 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 26934351fbef467b83cf558b762cb233 (experiment: slowfast)
2025-12-12 22:29:55 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:29:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:55 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 26934351fbef467b83cf558b762cb233
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 29/32
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:56 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:56 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:57 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:57 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2f1a3f4597894934b5d4be2378ea17b6 (experiment: slowfast)
2025-12-12 22:29:57 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:29:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:57 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2f1a3f4597894934b5d4be2378ea17b6
2025-12-12 22:29:58 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:29:58 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:58 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:58 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:29:59 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:29:59 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: da96d138922b4615ba435931ddf9cb41 (experiment: slowfast)
2025-12-12 22:29:59 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:29:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:29:59 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:29:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: da96d138922b4615ba435931ddf9cb41
2025-12-12 22:29:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:29:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:29:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:29:59 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:29:59 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:00 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7667a15c29d1467e9e7c136e2c9d0a47 (experiment: slowfast)
2025-12-12 22:30:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:30:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:01 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7667a15c29d1467e9e7c136e2c9d0a47
2025-12-12 22:30:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:30:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:01 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:01 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:02 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e8eec6941d67426781b8ce802e4bfd0e (experiment: slowfast)
2025-12-12 22:30:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:30:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:03 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e8eec6941d67426781b8ce802e4bfd0e
2025-12-12 22:30:03 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:30:03 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:03 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:03 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:03 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:04 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:04 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d692b3473a124706be7dd4bd08b3b446 (experiment: slowfast)
2025-12-12 22:30:04 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:30:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:05 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d692b3473a124706be7dd4bd08b3b446
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 30/32
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 4}
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:05 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:05 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:05 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:06 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f2c02271d9004c21aea3a18508a7e2a5 (experiment: slowfast)
2025-12-12 22:30:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:30:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:07 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f2c02271d9004c21aea3a18508a7e2a5
2025-12-12 22:30:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:30:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:07 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:07 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:07 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:08 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6ce05d9377d44d429e2cd4c3eb6901d0 (experiment: slowfast)
2025-12-12 22:30:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:30:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:08 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6ce05d9377d44d429e2cd4c3eb6901d0
2025-12-12 22:30:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:30:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:09 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:09 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:09 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bc3e37566fd04d1286a05e83a2cd7b3e (experiment: slowfast)
2025-12-12 22:30:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:30:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:10 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bc3e37566fd04d1286a05e83a2cd7b3e
2025-12-12 22:30:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:30:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:11 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:11 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:11 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d84580f92f24437495f96e00f3dc4765 (experiment: slowfast)
2025-12-12 22:30:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:30:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:12 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d84580f92f24437495f96e00f3dc4765
2025-12-12 22:30:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:30:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:13 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:13 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:14 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:14 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a91586ea51d34232bb52f18367495193 (experiment: slowfast)
2025-12-12 22:30:14 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:30:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:14 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a91586ea51d34232bb52f18367495193
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 31/32
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 2}
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:15 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:15 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:16 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d2f595b5f0be475a8388569d997489d7 (experiment: slowfast)
2025-12-12 22:30:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:30:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:16 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d2f595b5f0be475a8388569d997489d7
2025-12-12 22:30:17 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:30:17 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:17 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:17 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:18 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 36b6798b6fc5418cb792a9b1dd2e40a1 (experiment: slowfast)
2025-12-12 22:30:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:30:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:18 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 36b6798b6fc5418cb792a9b1dd2e40a1
2025-12-12 22:30:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:30:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:18 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:18 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:19 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eeb18880cbc74a639c5c3d1e0007442e (experiment: slowfast)
2025-12-12 22:30:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:30:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:20 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eeb18880cbc74a639c5c3d1e0007442e
2025-12-12 22:30:20 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:30:20 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:20 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:20 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:21 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b8275f155640440fadc39c436bae4fde (experiment: slowfast)
2025-12-12 22:30:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:30:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:22 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b8275f155640440fadc39c436bae4fde
2025-12-12 22:30:22 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:30:22 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 32, Effective batch size: 64
2025-12-12 22:30:22 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:22 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:22 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:23 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8c55609a35f9423b8ff5f7a5769f1d78 (experiment: slowfast)
2025-12-12 22:30:23 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:30:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8c55609a35f9423b8ff5f7a5769f1d78
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 32/32
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.001, 'batch_size': 4}
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 1/5 (20% sample)
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:24 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:24 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:24 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:25 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2320bd9b94d3495ab7a9f00d6127cb18 (experiment: slowfast)
2025-12-12 22:30:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 1...
2025-12-12 22:30:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2320bd9b94d3495ab7a9f00d6127cb18
2025-12-12 22:30:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 2/5 (20% sample)
2025-12-12 22:30:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:27 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:27 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:27 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 30ed35756a664b43bf3bca8163509e54 (experiment: slowfast)
2025-12-12 22:30:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 2...
2025-12-12 22:30:28 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:28 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:28 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 30ed35756a664b43bf3bca8163509e54
2025-12-12 22:30:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 3/5 (20% sample)
2025-12-12 22:30:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:28 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:28 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:29 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d5e039e075b549fbac33b59fb3230b27 (experiment: slowfast)
2025-12-12 22:30:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 3...
2025-12-12 22:30:30 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:30 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:30 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d5e039e075b549fbac33b59fb3230b27
2025-12-12 22:30:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 4/5 (20% sample)
2025-12-12 22:30:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:30 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:30 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:31 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:31 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fd62f6ee549e416a96b71737adff1e9f (experiment: slowfast)
2025-12-12 22:30:31 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 4...
2025-12-12 22:30:32 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:32 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:32 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fd62f6ee549e416a96b71737adff1e9f
2025-12-12 22:30:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - slowfast - Fold 5/5 (20% sample)
2025-12-12 22:30:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 4, Gradient accumulation steps: 32, Effective batch size: 128
2025-12-12 22:30:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:32 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:32 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:33 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:33 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8712ff591d484bc5963d47082666fc84 (experiment: slowfast)
2025-12-12 22:30:33 [INFO] [lib.training.pipeline:1143] Training PyTorch model slowfast on fold 5...
2025-12-12 22:30:34 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:34 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-12 22:30:34 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8712ff591d484bc5963d47082666fc84
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1823] ================================================================================
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1824] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1825] ================================================================================
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1838] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1848] Final training using default hyperparameters (no grid search)
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 1/5 (full dataset)
2025-12-12 22:30:34 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:34 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:34 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:35 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:35 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f25cc4b46a554586a7dbd89b548bdc6a (experiment: slowfast)
2025-12-12 22:30:35 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 1 (full dataset)...
2025-12-12 22:30:35 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:30:35 [ERROR] [lib.training.pipeline:2226] Error training final fold 1: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:35 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 2/5 (full dataset)
2025-12-12 22:30:36 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:36 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:36 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:36 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 32355bb584144881a0de9417e8191d24 (experiment: slowfast)
2025-12-12 22:30:36 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 2 (full dataset)...
2025-12-12 22:30:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:30:37 [ERROR] [lib.training.pipeline:2226] Error training final fold 2: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:37 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 3/5 (full dataset)
2025-12-12 22:30:37 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:37 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:37 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:38 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:38 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bd24eef529cb421f953aa6d976597a26 (experiment: slowfast)
2025-12-12 22:30:38 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 3 (full dataset)...
2025-12-12 22:30:38 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:30:39 [ERROR] [lib.training.pipeline:2226] Error training final fold 3: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:39 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 4/5 (full dataset)
2025-12-12 22:30:40 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:40 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:40 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:40 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:40 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f67d8262ef6d4094a513ad85915f261d (experiment: slowfast)
2025-12-12 22:30:40 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 4 (full dataset)...
2025-12-12 22:30:40 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:30:43 [ERROR] [lib.training.pipeline:2226] Error training final fold 4: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:44 [INFO] [lib.training.pipeline:1852] 
Final Training - slowfast - Fold 5/5 (full dataset)
2025-12-12 22:30:44 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-12 22:30:44 [INFO] [lib.training.slowfast:70] torchvision SlowFast not available. Trying PyTorch Hub (pytorchvideo)...
2025-12-12 22:30:44 [INFO] [lib.training.slowfast:76] Loading SlowFast R50 from PyTorch Hub (facebookresearch/pytorchvideo)...
2025-12-12 22:30:45 [INFO] [lib.training.slowfast:101] ✓ Loaded SlowFast from PyTorch Hub (pytorchvideo)
2025-12-12 22:30:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0247fa0eace048619b27eb9bf2bdb1df (experiment: slowfast)
2025-12-12 22:30:45 [INFO] [lib.training.pipeline:2026] Training PyTorch model slowfast on fold 5 (full dataset)...
2025-12-12 22:30:45 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-12 22:30:45 [ERROR] [lib.training.pipeline:2226] Error training final fold 5: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-12 22:30:45 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/fold_1 to copy
2025-12-12 22:30:45 [INFO] [lib.training.pipeline:2299] 
slowfast - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-12 22:30:47 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots/cv_fold_comparison.png
2025-12-12 22:30:47 [INFO] [lib.training.pipeline:2327] Generated plots for slowfast in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/slowfast/plots
2025-12-12 22:30:47 [INFO] [lib.training.pipeline:2364] ================================================================================
2025-12-12 22:30:47 [INFO] [lib.training.pipeline:2365] Stage 5: Model Training Pipeline Completed
2025-12-12 22:30:47 [INFO] [lib.training.pipeline:2366] ================================================================================
2025-12-12 22:30:47 [INFO] [__main__:401] ================================================================================
2025-12-12 22:30:47 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-12 22:30:47 [INFO] [__main__:403] ================================================================================
2025-12-12 22:30:47 [INFO] [__main__:404] Execution time: 331.98 seconds (5.53 minutes)
2025-12-12 22:30:47 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:30:47 [INFO] [__main__:407] Models trained: ['slowfast']
2025-12-12 22:30:47 [INFO] [__main__:408] K-fold splits: 5
2025-12-12 22:30:47 [INFO] [__main__:414] ================================================================================
2025-12-12 22:30:47 [INFO] [__main__:415] Final memory statistics:
2025-12-12 22:30:47 [INFO] [__main__:416] ================================================================================
2025-12-12 22:30:47 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 2612.13671875, 'cpu_memory_gb': 2.550914764404297, 'cpu_vms_mb': 48931.70703125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.285212672, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.643129344}
2025-12-12 22:30:47 [INFO] [__main__:419] ================================================================================
2025-12-12 22:30:47 [INFO] [__main__:420] Training complete!
2025-12-12 22:30:47 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-12 22:30:47 [INFO] [__main__:422] ================================================================================
