2025-12-07 05:44:50 [INFO] [__main__:151] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:152] STAGE 3: VIDEO SCALING
2025-12-07 05:44:50 [INFO] [__main__:153] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:154] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-07 05:44:50 [INFO] [__main__:155] Augmented metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/augmented_videos/augmented_metadata.csv
2025-12-07 05:44:50 [INFO] [__main__:156] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos
2025-12-07 05:44:50 [INFO] [__main__:157] Scaling method: autoencoder
2025-12-07 05:44:50 [INFO] [__main__:158] Target max dimension: 256 pixels
2025-12-07 05:44:50 [INFO] [__main__:160] Video range: [1218, 1624)
2025-12-07 05:44:50 [INFO] [__main__:163] Delete existing: False
2025-12-07 05:44:50 [INFO] [__main__:164] Resume mode: True
2025-12-07 05:44:50 [INFO] [__main__:165] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage3_scaling_1765104290.log
2025-12-07 05:44:50 [DEBUG] [__main__:166] Python version: 3.11.7 (main, Dec 15 2023, 18:12:31) [GCC 11.2.0]
2025-12-07 05:44:50 [DEBUG] [__main__:167] Python executable: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/bin/python
2025-12-07 05:44:50 [DEBUG] [__main__:168] Working directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-07 05:44:50 [DEBUG] [__main__:169] Command line arguments: ['/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage3_scaling.py', '--project-root', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc', '--augmented-metadata', '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/augmented_videos/augmented_metadata.csv', '--method', 'autoencoder', '--target-size', '256', '--chunk-size', '400', '--output-dir', 'data/scaled_videos', '--start-idx', '1218', '--end-idx', '1624', '--resume']
2025-12-07 05:44:50 [INFO] [__main__:172] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:173] Checking prerequisites...
2025-12-07 05:44:50 [INFO] [__main__:174] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:180] ✓ Augmented metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/augmented_videos/augmented_metadata.csv
2025-12-07 05:44:50 [DEBUG] [__main__:185] System information:
2025-12-07 05:44:50 [DEBUG] [__main__:186]   CPU count: 40
2025-12-07 05:44:50 [DEBUG] [__main__:187]   Total memory: 200.81 GB
2025-12-07 05:44:50 [DEBUG] [__main__:188]   Available memory: 191.44 GB
2025-12-07 05:44:50 [INFO] [__main__:193] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:194] Initial memory statistics:
2025-12-07 05:44:50 [INFO] [__main__:195] ================================================================================
2025-12-07 05:44:50 [INFO] [lib.utils.memory:89] Memory stats (Stage 3: before scaling): {'cpu_memory_mb': 700.7578125, 'cpu_memory_gb': 0.6843338012695312, 'cpu_vms_mb': 5653.01953125, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-07 05:44:50 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-07 05:44:50 [DEBUG] [lib.utils.memory:96] Num threads: 4
2025-12-07 05:44:50 [INFO] [__main__:199] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:200] Starting Stage 3: Video Scaling
2025-12-07 05:44:50 [INFO] [__main__:201] ================================================================================
2025-12-07 05:44:50 [INFO] [__main__:202] This may take a while depending on dataset size...
2025-12-07 05:44:50 [INFO] [__main__:203] Progress will be logged in real-time
2025-12-07 05:44:50 [INFO] [__main__:204] ================================================================================
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:297] Stage 3: Loading augmented metadata...
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:329] Stage 3: Processing video range [1218, 1624) of 3244 total videos
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:338] Stage 3: Processing 406 videos in this range
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:339] Stage 3: Target max dimension: 256 pixels
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:345] Stage 3: Method: autoencoder
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:346] Stage 3: Chunk size: 400 frames
2025-12-07 05:44:50 [INFO] [lib.scaling.pipeline:353] Stage 3: Loading Hugging Face autoencoder: stabilityai/sd-vae-ft-mse
2025-12-07 05:44:50 [INFO] [lib.scaling.methods:111] Loading Hugging Face autoencoder: stabilityai/sd-vae-ft-mse on cuda
2025-12-07 05:44:50 [DEBUG] [lib.scaling.methods:128] Attempting to load as standalone VAE (no subfolder)
2025-12-07 05:44:50 [DEBUG] [urllib3.connectionpool:1049] Starting new HTTPS connection (1): huggingface.co:443
2025-12-07 05:44:50 [DEBUG] [urllib3.connectionpool:544] https://huggingface.co:443 "HEAD /stabilityai/sd-vae-ft-mse/resolve/main/config.json HTTP/1.1" 307 0
2025-12-07 05:44:50 [DEBUG] [urllib3.connectionpool:544] https://huggingface.co:443 "HEAD /api/resolve-cache/models/stabilityai/sd-vae-ft-mse/31f26fdeee1355a5c34592e401dd41e45d25a493/config.json HTTP/1.1" 200 0
2025-12-07 05:44:50 [DEBUG] [urllib3.connectionpool:544] https://huggingface.co:443 "HEAD /stabilityai/sd-vae-ft-mse/resolve/31f26fdeee1355a5c34592e401dd41e45d25a493/diffusion_pytorch_model.safetensors.index.json HTTP/1.1" 404 0
2025-12-07 05:44:51 [INFO] [lib.scaling.methods:163] ✓ Loaded autoencoder: stabilityai/sd-vae-ft-mse
2025-12-07 05:44:51 [INFO] [lib.scaling.pipeline:355] ✓ Autoencoder loaded successfully
2025-12-07 05:44:52 [ERROR] [lib.utils.paths:160] Failed to load metadata from /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow: Invalid argument (os error 22)
2025-12-07 05:44:52 [ERROR] [__main__:266] ================================================================================
2025-12-07 05:44:52 [ERROR] [__main__:267] STAGE 3 FAILED
2025-12-07 05:44:52 [ERROR] [__main__:268] ================================================================================
2025-12-07 05:44:52 [ERROR] [__main__:269] Error: Invalid argument (os error 22)
2025-12-07 05:44:52 [ERROR] [__main__:270] Exception type: OSError
2025-12-07 05:44:52 [ERROR] [__main__:271] Full traceback:
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/src/scripts/run_stage3_scaling.py", line 209, in main
    result_df = stage3_scale_videos(
                ^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/scaling/pipeline.py", line 369, in stage3_scale_videos
    existing_metadata = load_metadata_flexible(str(existing_metadata_path))
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/paths.py", line 152, in load_metadata_flexible
    return pl.read_ipc(path_obj)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/polars/_utils/deprecation.py", line 128, in wrapper
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/polars/_utils/deprecation.py", line 128, in wrapper
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/polars/io/ipc/functions.py", line 176, in read_ipc
    return _read_ipc_impl(
           ^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/polars/io/ipc/functions.py", line 223, in _read_ipc_impl
    pydf = PyDataFrame.read_ipc(
           ^^^^^^^^^^^^^^^^^^^^^
OSError: Invalid argument (os error 22)
2025-12-07 05:44:52 [ERROR] [__main__:272] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos
2025-12-07 05:44:52 [ERROR] [__main__:273] Partial results may be available
2025-12-07 05:44:52 [ERROR] [__main__:274] ================================================================================
