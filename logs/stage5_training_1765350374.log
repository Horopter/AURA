2025-12-10 02:06:14 [INFO] [lib.utils.memory:89] Memory stats (Stage 5: before training): {'cpu_memory_mb': 752.38671875, 'cpu_memory_gb': 0.7347526550292969, 'cpu_vms_mb': 10239.87109375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-10 02:06:14 [DEBUG] [lib.utils.memory:95] CPU percent: 0.0%
2025-12-10 02:06:14 [DEBUG] [lib.utils.memory:96] Num threads: 5
2025-12-10 02:06:14 [INFO] [lib.training.pipeline:79] Stage 5: Loading metadata...
2025-12-10 02:06:16 [WARNING] [lib.utils.paths:169] Metadata file is empty: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow, trying other formats...
2025-12-10 02:06:16 [WARNING] [lib.utils.paths:178] No valid metadata file found for /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-10 02:06:16 [INFO] [lib.training.pipeline:90] Stage 5: Found 3244 scaled videos
2025-12-10 02:06:16 [WARNING] [lib.training.pipeline:151] Could not import VideoConfig from lib.models. Using minimal fallback. This is OK for non-PyTorch models (logistic_regression, svm), but PyTorch models will fail if lib/models is missing. Please ensure lib/models directory exists on the server.
2025-12-10 02:06:16 [INFO] [lib.training.pipeline:185] 
================================================================================
2025-12-10 02:06:16 [INFO] [lib.training.pipeline:186] Stage 5: Training model: logistic_regression
2025-12-10 02:06:16 [INFO] [lib.training.pipeline:187] ================================================================================
2025-12-10 02:06:20 [INFO] [lib.training.pipeline:224] Using 5-fold stratified cross-validation
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:233] Grid search: 40 hyperparameter combinations to try
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:245] 
================================================================================
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:246] Grid Search: Hyperparameter combination 1/40
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:247] Parameters: {'C': 0.01, 'penalty': 'l1', 'solver': 'liblinear', 'max_iter': 1000}
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:248] ================================================================================
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:259] 
Training logistic_regression - Fold 1/5
2025-12-10 02:06:28 [INFO] [lib.training.pipeline:711] Training baseline model logistic_regression on fold 1...
2025-12-10 02:06:28 [INFO] [lib.training._linear:50] Extracting handcrafted features for 2594 videos...
2025-12-10 02:06:30 [DEBUG] [lib.features.handcrafted:33] ffprobe not found in PATH - codec cue extraction will be disabled
2025-12-10 02:10:22 [ERROR] [libav.mov,mp4,m4a,3gp,3g2,mj2:369] moov atom not found
2025-12-10 02:10:22 [WARNING] [lib.features.handcrafted:407] Failed to extract features from data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: [Errno 1094995529] Invalid data found when processing input: '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4'; last error log: [mov,mp4,m4a,3gp,3g2,mj2] moov atom not found
2025-12-10 02:12:04 [ERROR] [lib.training._linear:69] Failed to extract features: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
2025-12-10 02:12:04 [ERROR] [lib.training.pipeline:782] Error training baseline fold 1: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 723, in stage5_train_models
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
2025-12-10 02:12:05 [INFO] [lib.training.pipeline:259] 
Training logistic_regression - Fold 2/5
2025-12-10 02:12:05 [INFO] [lib.training.pipeline:711] Training baseline model logistic_regression on fold 2...
2025-12-10 02:12:05 [INFO] [lib.training._linear:50] Extracting handcrafted features for 2594 videos...
2025-12-10 02:14:59 [WARNING] [lib.features.handcrafted:407] Failed to extract features from data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: [Errno 1094995529] Invalid data found when processing input: '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4'; last error log: [mov,mp4,m4a,3gp,3g2,mj2] moov atom not found
2025-12-10 02:16:46 [ERROR] [lib.training._linear:69] Failed to extract features: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
2025-12-10 02:16:46 [ERROR] [lib.training.pipeline:782] Error training baseline fold 2: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 723, in stage5_train_models
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2594,) + inhomogeneous part.
2025-12-10 02:16:46 [INFO] [lib.training.pipeline:259] 
Training logistic_regression - Fold 3/5
2025-12-10 02:16:46 [INFO] [lib.training.pipeline:711] Training baseline model logistic_regression on fold 3...
2025-12-10 02:16:46 [INFO] [lib.training._linear:50] Extracting handcrafted features for 2596 videos...
2025-12-10 02:19:46 [WARNING] [lib.features.handcrafted:407] Failed to extract features from data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: [Errno 1094995529] Invalid data found when processing input: '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4'; last error log: [mov,mp4,m4a,3gp,3g2,mj2] moov atom not found
2025-12-10 02:21:11 [ERROR] [lib.training._linear:69] Failed to extract features: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2596,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2596,) + inhomogeneous part.
2025-12-10 02:21:11 [ERROR] [lib.training.pipeline:782] Error training baseline fold 3: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2596,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 723, in stage5_train_models
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 59, in fit
    features = safe_execute(
               ^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/utils/memory.py", line 161, in safe_execute
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (2596,) + inhomogeneous part.
2025-12-10 02:21:11 [INFO] [lib.training.pipeline:259] 
Training logistic_regression - Fold 4/5
2025-12-10 02:21:11 [INFO] [lib.training.pipeline:711] Training baseline model logistic_regression on fold 4...
2025-12-10 02:21:11 [INFO] [lib.training._linear:50] Extracting handcrafted features for 2596 videos...
2025-12-10 02:25:01 [INFO] [lib.training._linear:89] Removing collinear features...
2025-12-10 02:25:01 [INFO] [lib.training.feature_preprocessing:75] Removed 3 features with zero variance
2025-12-10 02:25:01 [DEBUG] [lib.training.feature_preprocessing:111] Removing collinear feature: feature_0 (correlation=0.983)
2025-12-10 02:25:01 [DEBUG] [lib.training.feature_preprocessing:111] Removing collinear feature: feature_0 (correlation=0.974)
2025-12-10 02:25:01 [DEBUG] [lib.training.feature_preprocessing:111] Removing collinear feature: feature_4 (correlation=0.952)
2025-12-10 02:25:01 [DEBUG] [lib.training.feature_preprocessing:111] Removing collinear feature: feature_10 (correlation=0.966)
2025-12-10 02:25:01 [INFO] [lib.training.feature_preprocessing:121] Removed 4 collinear features (correlation >= 0.95)
2025-12-10 02:25:01 [INFO] [lib.training.feature_preprocessing:142] Final feature count: 8/15 (53.3% retained)
2025-12-10 02:25:01 [INFO] [lib.training._linear:104] Using 8 features after collinearity removal
2025-12-10 02:25:01 [INFO] [lib.training._linear:123] Scaling features...
2025-12-10 02:25:01 [INFO] [lib.training._linear:136] Training Logistic Regression...
2025-12-10 02:25:02 [INFO] [lib.training._linear:144] âœ“ Logistic Regression trained
2025-12-10 02:25:36 [WARNING] [lib.features.handcrafted:407] Failed to extract features from data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4: [Errno 1094995529] Invalid data found when processing input: '/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/FX5aeuJFQ64_aug1_scaled_aug1.mp4'; last error log: [mov,mp4,m4a,3gp,3g2,mj2] moov atom not found
2025-12-10 02:26:16 [ERROR] [lib.training.pipeline:782] Error training baseline fold 4: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (648,) + inhomogeneous part.
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 726, in stage5_train_models
    xgb_config = model_config.copy()
                ^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/_linear.py", line 164, in predict
    features = self.feature_extractor.extract_batch(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/features/handcrafted.py", line 416, in extract_batch
    return np.array(all_features)
           ^^^^^^^^^^^^^^^^^^^^^^
ValueError: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (648,) + inhomogeneous part.
2025-12-10 02:26:16 [INFO] [lib.training.pipeline:259] 
Training logistic_regression - Fold 5/5
2025-12-10 02:26:16 [INFO] [lib.training.pipeline:711] Training baseline model logistic_regression on fold 5...
2025-12-10 02:26:16 [INFO] [lib.training._linear:50] Extracting handcrafted features for 2596 videos...
