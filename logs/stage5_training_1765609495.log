2025-12-13 02:04:55 [INFO] [__main__:310] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:311] STAGE 5: MODEL TRAINING
2025-12-13 02:04:55 [INFO] [__main__:312] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:313] Project root: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc
2025-12-13 02:04:55 [INFO] [__main__:314] Scaled metadata: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:04:55 [INFO] [__main__:315] Features Stage 2: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:04:55 [INFO] [__main__:316] Features Stage 4: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:04:55 [INFO] [__main__:317] Model types: ['pretrained_inception']
2025-12-13 02:04:55 [INFO] [__main__:318] K-fold splits: 5
2025-12-13 02:04:55 [INFO] [__main__:319] Number of frames: 1000
2025-12-13 02:04:55 [INFO] [__main__:320] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:04:55 [INFO] [__main__:321] Experiment tracking: Enabled
2025-12-13 02:04:55 [INFO] [__main__:324] Delete existing: True
2025-12-13 02:04:55 [INFO] [__main__:325] Resume mode: True
2025-12-13 02:04:55 [INFO] [__main__:326] Log file: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/logs/stage5_training_1765609495.log
2025-12-13 02:04:55 [INFO] [__main__:333] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:334] Checking prerequisites...
2025-12-13 02:04:55 [INFO] [__main__:335] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:342] ✓ Scaled metadata file found: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:04:55 [INFO] [__main__:352] ✓ All model types are valid
2025-12-13 02:04:55 [INFO] [__main__:358] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:359] Initial memory statistics:
2025-12-13 02:04:55 [INFO] [__main__:360] ================================================================================
2025-12-13 02:04:55 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: before training): {'cpu_memory_mb': 736.02734375, 'cpu_memory_gb': 0.7187767028808594, 'cpu_vms_mb': 10218.72265625, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.0, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.928342016}
2025-12-13 02:04:55 [INFO] [__main__:364] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:365] Starting Stage 5: Model Training
2025-12-13 02:04:55 [INFO] [__main__:366] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:367] Training 1 model(s) with 5-fold cross-validation
2025-12-13 02:04:55 [INFO] [__main__:368] This may take a while depending on dataset size and model complexity...
2025-12-13 02:04:55 [INFO] [__main__:369] Progress will be logged in real-time
2025-12-13 02:04:55 [INFO] [__main__:370] ================================================================================
2025-12-13 02:04:55 [INFO] [__main__:375] Calling Stage 5 training pipeline...
2025-12-13 02:04:55 [INFO] [__main__:376] This may take a while - progress will be logged in real-time
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:496] ================================================================================
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:497] Stage 5: Model Training Pipeline Started
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:498] ================================================================================
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:499] Model types: ['pretrained_inception']
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:500] K-fold splits: 5
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:501] Frames per video: 1000
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:502] Output directory: data/stage5
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:503] Initializing pipeline...
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:265] ================================================================================
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:266] STAGE 5 PREREQUISITE VALIDATION
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:267] ================================================================================
2025-12-13 02:04:55 [INFO] [lib.training.pipeline:270] 
[1/3] Checking Stage 3 (scaled videos) - REQUIRED for all models...
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:279] ✓ Stage 3 metadata found: 3278 scaled videos
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:280]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/scaled_videos/scaled_metadata.arrow
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:283] 
[2/3] Checking Stage 2 (features) - REQUIRED for *_stage2 models...
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:291] ✓ Stage 2 metadata found: 3278 feature rows
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:292]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage2/features_metadata.arrow
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:295] 
[3/3] Checking Stage 4 (scaled features) - REQUIRED for *_stage2_stage4 models...
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:303] ✓ Stage 4 metadata found: 3277 feature rows
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:304]   Path: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/features_stage4/features_scaled_metadata.arrow
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:307] 
================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:308] MODEL REQUIREMENTS CHECK
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:309] ================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:333] ✓ pretrained_inception: CAN RUN
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:336] 
================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:337] VALIDATION SUMMARY
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:338] ================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:339] Stage 3 (scaled videos): ✓ Available
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:340]   Count: 3278 videos
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:341] Stage 2 (features): ✓ Available
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:342]   Count: 3278 feature rows
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:343] Stage 4 (scaled features): ✓ Available
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:344]   Count: 3277 feature rows
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:345] 
Runnable models: 1/1
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:346]   ['pretrained_inception']
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:353] ================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:589] 
Stage 5: Loading metadata...
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:615] Loaded metadata: 3278 rows
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:625] ✓ Data validation passed: 3278 rows (> 3000 required)
2025-12-13 02:04:57 [WARNING] [lib.utils.guardrails:171] Disk usage high: free=829585.28GB, used=1670254.72GB (66.8%)
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:657] Stage 5: Found 3278 scaled videos
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:705] Enabling adaptive chunked frame loading for pretrained_inception: initial_chunk_size=10, num_frames=1000. Chunk size will adapt automatically based on OOM events (AIMD algorithm).
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:738] Overriding num_frames to 500 for pretrained_inception (small-chunk model) to prevent OOM. Original num_frames was 1000.
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:771] Stage 5: Deleting existing model results (clean mode)...
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:780] Deleted existing results for pretrained_inception
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:783] Stage 5: Deleted 1 existing model directories
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:788] 
================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:789] Stage 5: Training model: pretrained_inception
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:790] ================================================================================
2025-12-13 02:04:57 [INFO] [lib.training.pipeline:803] Overriding model_config num_frames to 500 for pretrained_inception (small-chunk model) to match video_config.
2025-12-13 02:04:59 [INFO] [lib.training.pipeline:823] Grid search: 24 hyperparameter combinations to try
2025-12-13 02:04:59 [INFO] [lib.training.pipeline:831] ================================================================================
2025-12-13 02:04:59 [INFO] [lib.training.pipeline:832] HYPERPARAMETER SEARCH: Using 20% stratified sample for efficiency
2025-12-13 02:04:59 [INFO] [lib.training.pipeline:833] ================================================================================
2025-12-13 02:04:59 [INFO] [lib.training.pipeline:842] Hyperparameter search sample: 655 rows (20.0% of 3278 total)
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:855] Using 5-fold stratified cross-validation on 20% sample for hyperparameter search
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 1/24
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b3a8bf23024848edb9fcd353ede490d8 (experiment: pretrained_inception)
2025-12-13 02:05:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:08 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:08 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:08 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b3a8bf23024848edb9fcd353ede490d8
2025-12-13 02:05:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: abab2d9f272e4fcdb281f9db70c00bf6 (experiment: pretrained_inception)
2025-12-13 02:05:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:10 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: abab2d9f272e4fcdb281f9db70c00bf6
2025-12-13 02:05:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e6ec03fbbeb24111baa54d972975539f (experiment: pretrained_inception)
2025-12-13 02:05:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:11 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:11 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e6ec03fbbeb24111baa54d972975539f
2025-12-13 02:05:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dba5c869d0d449b5b26a36038d9044d3 (experiment: pretrained_inception)
2025-12-13 02:05:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:13 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:13 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:13 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dba5c869d0d449b5b26a36038d9044d3
2025-12-13 02:05:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aab128fbad2f4f7babb9e54e0d949ea4 (experiment: pretrained_inception)
2025-12-13 02:05:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:15 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:15 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:15 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aab128fbad2f4f7babb9e54e0d949ea4
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 2/24
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:16 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a2770a705ab1415ea0ceafaf385b3822 (experiment: pretrained_inception)
2025-12-13 02:05:16 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:17 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:17 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:17 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a2770a705ab1415ea0ceafaf385b3822
2025-12-13 02:05:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:18 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:05:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:18 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c22296b6fc274d5baa483572adbd6dce (experiment: pretrained_inception)
2025-12-13 02:05:18 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:18 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c22296b6fc274d5baa483572adbd6dce
2025-12-13 02:05:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:19 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:05:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 211ffa232132474e8696dcdf6660486d (experiment: pretrained_inception)
2025-12-13 02:05:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:20 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:20 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:20 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 211ffa232132474e8696dcdf6660486d
2025-12-13 02:05:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:21 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:05:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:21 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7b06bbf3de974628bd938175683df048 (experiment: pretrained_inception)
2025-12-13 02:05:21 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:22 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7b06bbf3de974628bd938175683df048
2025-12-13 02:05:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:23 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:05:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 82a5a1265a21418b9edbd94b4d141c48 (experiment: pretrained_inception)
2025-12-13 02:05:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 82a5a1265a21418b9edbd94b4d141c48
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 3/24
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ce2fe09058bf4711b50bb8c4b9f419f1 (experiment: pretrained_inception)
2025-12-13 02:05:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ce2fe09058bf4711b50bb8c4b9f419f1
2025-12-13 02:05:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:26 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:05:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 55d51161079746f79fc749da02e40510 (experiment: pretrained_inception)
2025-12-13 02:05:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:27 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 55d51161079746f79fc749da02e40510
2025-12-13 02:05:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:28 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:05:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8aa8c4d23f7c49a2a469d488f231fe42 (experiment: pretrained_inception)
2025-12-13 02:05:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:29 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8aa8c4d23f7c49a2a469d488f231fe42
2025-12-13 02:05:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:30 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:05:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d24dbfe7695943d69bd9b43fc5055026 (experiment: pretrained_inception)
2025-12-13 02:05:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:31 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d24dbfe7695943d69bd9b43fc5055026
2025-12-13 02:05:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:31 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:05:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e8414acf58804dbb983b20b4c66b9fb5 (experiment: pretrained_inception)
2025-12-13 02:05:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:33 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e8414acf58804dbb983b20b4c66b9fb5
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 4/24
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: d3042053607a4873875c99bec9cf9d5c (experiment: pretrained_inception)
2025-12-13 02:05:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:35 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: d3042053607a4873875c99bec9cf9d5c
2025-12-13 02:05:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:35 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:05:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2b28a231d6fa43da990972275efdcd5f (experiment: pretrained_inception)
2025-12-13 02:05:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2b28a231d6fa43da990972275efdcd5f
2025-12-13 02:05:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:36 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:05:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6096ba4210b34f8b8dceb54dae1e8e50 (experiment: pretrained_inception)
2025-12-13 02:05:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6096ba4210b34f8b8dceb54dae1e8e50
2025-12-13 02:05:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:38 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:05:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a13dc3b695b94eba850341137e318aaa (experiment: pretrained_inception)
2025-12-13 02:05:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a13dc3b695b94eba850341137e318aaa
2025-12-13 02:05:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:40 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:05:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 61fde12912054ae994409c0b2df30ba4 (experiment: pretrained_inception)
2025-12-13 02:05:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 61fde12912054ae994409c0b2df30ba4
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 5/24
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eccbb9517f0d4f5d8223a81c634e5499 (experiment: pretrained_inception)
2025-12-13 02:05:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:43 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: eccbb9517f0d4f5d8223a81c634e5499
2025-12-13 02:05:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:44 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:05:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ae78fa6bd55a4dcf9984b573c3f03eb4 (experiment: pretrained_inception)
2025-12-13 02:05:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:45 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ae78fa6bd55a4dcf9984b573c3f03eb4
2025-12-13 02:05:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:45 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:05:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2fbf174d72aa491bbcfef356cd3ef775 (experiment: pretrained_inception)
2025-12-13 02:05:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:46 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2fbf174d72aa491bbcfef356cd3ef775
2025-12-13 02:05:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:47 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:05:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4df60cfa4a9744b084501968e757897d (experiment: pretrained_inception)
2025-12-13 02:05:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:48 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4df60cfa4a9744b084501968e757897d
2025-12-13 02:05:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:49 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:05:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8bd43af8e9604c659e290bd603928d4f (experiment: pretrained_inception)
2025-12-13 02:05:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:50 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8bd43af8e9604c659e290bd603928d4f
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 6/24
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f3fd3ac1cbde424f99a5c155ade4e1ac (experiment: pretrained_inception)
2025-12-13 02:05:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:05:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:52 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f3fd3ac1cbde424f99a5c155ade4e1ac
2025-12-13 02:05:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:05:52 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:05:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3748ecfcebe4484bbeddbe7a3a34e493 (experiment: pretrained_inception)
2025-12-13 02:05:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:05:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:53 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3748ecfcebe4484bbeddbe7a3a34e493
2025-12-13 02:05:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:05:53 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:05:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1ab5c7c10054477bb54e992c377f9fbd (experiment: pretrained_inception)
2025-12-13 02:05:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:05:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:55 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1ab5c7c10054477bb54e992c377f9fbd
2025-12-13 02:05:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:05:55 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:05:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e62d8ee7d7dd483686986c43db122096 (experiment: pretrained_inception)
2025-12-13 02:05:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:05:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:57 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e62d8ee7d7dd483686986c43db122096
2025-12-13 02:05:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:05:57 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:05:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:58 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:05:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fffba7f7bb544e2884992f44ab0a3ed1 (experiment: pretrained_inception)
2025-12-13 02:05:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:05:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:05:59 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:05:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fffba7f7bb544e2884992f44ab0a3ed1
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 7/24
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:05:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5ce07146e72f4711978e7b3eab0b07dc (experiment: pretrained_inception)
2025-12-13 02:06:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:01 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:01 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5ce07146e72f4711978e7b3eab0b07dc
2025-12-13 02:06:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:01 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7e8728e8759647e991ed7382c78cea91 (experiment: pretrained_inception)
2025-12-13 02:06:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:02 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7e8728e8759647e991ed7382c78cea91
2025-12-13 02:06:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:02 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a09016f265214105a06bedeaee6cb4fa (experiment: pretrained_inception)
2025-12-13 02:06:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:04 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:04 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:04 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a09016f265214105a06bedeaee6cb4fa
2025-12-13 02:06:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:04 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 97a51ebb60e6457383231d7ad30f213c (experiment: pretrained_inception)
2025-12-13 02:06:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:05 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 97a51ebb60e6457383231d7ad30f213c
2025-12-13 02:06:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:06 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 83c5fc83a3df447a9dec514949a9d6b3 (experiment: pretrained_inception)
2025-12-13 02:06:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:07 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 83c5fc83a3df447a9dec514949a9d6b3
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 8/24
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 5e-05, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: dc5d21c177654d789d6a6c7775a3618e (experiment: pretrained_inception)
2025-12-13 02:06:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:09 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: dc5d21c177654d789d6a6c7775a3618e
2025-12-13 02:06:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:09 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 84e570e194534374935a6406a37425aa (experiment: pretrained_inception)
2025-12-13 02:06:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:10 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 84e570e194534374935a6406a37425aa
2025-12-13 02:06:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:11 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 93aeb5dcedd0421a82ec4683a21f90c0 (experiment: pretrained_inception)
2025-12-13 02:06:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:12 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 93aeb5dcedd0421a82ec4683a21f90c0
2025-12-13 02:06:13 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:13 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:13 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 23d89c4f57454bbdb2a7cfbd04c96258 (experiment: pretrained_inception)
2025-12-13 02:06:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:14 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 23d89c4f57454bbdb2a7cfbd04c96258
2025-12-13 02:06:15 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:15 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:15 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c270276033f94e9bbe40c8b092b716fa (experiment: pretrained_inception)
2025-12-13 02:06:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:16 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c270276033f94e9bbe40c8b092b716fa
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 9/24
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:17 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 939e7bbefbd9471392732a4e06b528eb (experiment: pretrained_inception)
2025-12-13 02:06:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:18 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 939e7bbefbd9471392732a4e06b528eb
2025-12-13 02:06:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:18 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 1cdcaaa510524053ac56679449a3421d (experiment: pretrained_inception)
2025-12-13 02:06:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 1cdcaaa510524053ac56679449a3421d
2025-12-13 02:06:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:19 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:20 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 88ee0eab8be5413ba3b4e8e16605b833 (experiment: pretrained_inception)
2025-12-13 02:06:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 88ee0eab8be5413ba3b4e8e16605b833
2025-12-13 02:06:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:21 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0b333e715c0a406c955d572c365bb170 (experiment: pretrained_inception)
2025-12-13 02:06:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:23 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0b333e715c0a406c955d572c365bb170
2025-12-13 02:06:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:23 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 34726ee8f1cb4e99b78b766196caadde (experiment: pretrained_inception)
2025-12-13 02:06:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 34726ee8f1cb4e99b78b766196caadde
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 10/24
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b14b950d71764ce8977f0a039fc81d79 (experiment: pretrained_inception)
2025-12-13 02:06:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b14b950d71764ce8977f0a039fc81d79
2025-12-13 02:06:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:27 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7632284cdc9f487b9c6427752ebcc000 (experiment: pretrained_inception)
2025-12-13 02:06:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:27 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7632284cdc9f487b9c6427752ebcc000
2025-12-13 02:06:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:28 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 7e600f83336d45b1957bd8c573e325e9 (experiment: pretrained_inception)
2025-12-13 02:06:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:29 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 7e600f83336d45b1957bd8c573e325e9
2025-12-13 02:06:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:30 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6093c9e328ca44cca5353aea6e283b05 (experiment: pretrained_inception)
2025-12-13 02:06:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:31 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6093c9e328ca44cca5353aea6e283b05
2025-12-13 02:06:32 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:32 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:32 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2a27d7fee45c447283719a4bc40678eb (experiment: pretrained_inception)
2025-12-13 02:06:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:33 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2a27d7fee45c447283719a4bc40678eb
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 11/24
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 74c54da00f9347d4b61139a9a2056254 (experiment: pretrained_inception)
2025-12-13 02:06:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:35 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 74c54da00f9347d4b61139a9a2056254
2025-12-13 02:06:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:35 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4e2e80a50f324fbaade2c9b702be13db (experiment: pretrained_inception)
2025-12-13 02:06:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4e2e80a50f324fbaade2c9b702be13db
2025-12-13 02:06:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:36 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:37 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 55c932046b7b43c3ba49a804607c57fc (experiment: pretrained_inception)
2025-12-13 02:06:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 55c932046b7b43c3ba49a804607c57fc
2025-12-13 02:06:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:38 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:39 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 79b02fb1882949c7a2809c32bef3b8b1 (experiment: pretrained_inception)
2025-12-13 02:06:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 79b02fb1882949c7a2809c32bef3b8b1
2025-12-13 02:06:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:40 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 209d25987bc9453e91729542a7d93ad1 (experiment: pretrained_inception)
2025-12-13 02:06:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 209d25987bc9453e91729542a7d93ad1
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 12/24
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: bccd0ce48e0a460283540915005a63e4 (experiment: pretrained_inception)
2025-12-13 02:06:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:43 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: bccd0ce48e0a460283540915005a63e4
2025-12-13 02:06:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:44 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:45 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4d486a49767c496ca57d0720434f2cec (experiment: pretrained_inception)
2025-12-13 02:06:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:45 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4d486a49767c496ca57d0720434f2cec
2025-12-13 02:06:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:45 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8897966abd06497bac4cf625135fcd1b (experiment: pretrained_inception)
2025-12-13 02:06:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:46 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8897966abd06497bac4cf625135fcd1b
2025-12-13 02:06:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:47 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c88d70301fe24298ab97415c3df483da (experiment: pretrained_inception)
2025-12-13 02:06:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:48 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c88d70301fe24298ab97415c3df483da
2025-12-13 02:06:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:49 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:50 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8c06e2cc5d28433ba232388ed21bbf30 (experiment: pretrained_inception)
2025-12-13 02:06:50 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:50 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8c06e2cc5d28433ba232388ed21bbf30
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 13/24
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 90e5e911450947c087112f6d9647f291 (experiment: pretrained_inception)
2025-12-13 02:06:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:06:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:52 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 90e5e911450947c087112f6d9647f291
2025-12-13 02:06:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:06:52 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:06:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:53 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c8794a4328d34a2dbab3da57e7dc9074 (experiment: pretrained_inception)
2025-12-13 02:06:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:06:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:53 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c8794a4328d34a2dbab3da57e7dc9074
2025-12-13 02:06:54 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:06:54 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:06:54 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 54bef70ffa454e1c8adcd0c8af7c6fd5 (experiment: pretrained_inception)
2025-12-13 02:06:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:06:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:55 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 54bef70ffa454e1c8adcd0c8af7c6fd5
2025-12-13 02:06:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:06:55 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:06:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:56 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 070dd0242ef64ea1a15466e74da5c943 (experiment: pretrained_inception)
2025-12-13 02:06:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:06:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:57 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 070dd0242ef64ea1a15466e74da5c943
2025-12-13 02:06:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:06:57 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:06:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:06:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b30fc6254aad48c3836a161906f8c4f7 (experiment: pretrained_inception)
2025-12-13 02:06:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:06:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:06:59 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:06:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b30fc6254aad48c3836a161906f8c4f7
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 14/24
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:06:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: be2b71e814a140c8a0bbeabcd0d5ded9 (experiment: pretrained_inception)
2025-12-13 02:07:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:00 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:01 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: be2b71e814a140c8a0bbeabcd0d5ded9
2025-12-13 02:07:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:01 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3ddbc46ea4114ebc9ed3f584660f1d37 (experiment: pretrained_inception)
2025-12-13 02:07:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:02 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3ddbc46ea4114ebc9ed3f584660f1d37
2025-12-13 02:07:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:02 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 65c2026e78d34a4bacb8ce231dc350eb (experiment: pretrained_inception)
2025-12-13 02:07:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:03 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 65c2026e78d34a4bacb8ce231dc350eb
2025-12-13 02:07:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:04 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f59cafd58b1e4bcc86fa2231fbd16d3c (experiment: pretrained_inception)
2025-12-13 02:07:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:05 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f59cafd58b1e4bcc86fa2231fbd16d3c
2025-12-13 02:07:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:06 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:07 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6e45af64f9a740d4993fc68b3d2619e9 (experiment: pretrained_inception)
2025-12-13 02:07:07 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:07 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 6e45af64f9a740d4993fc68b3d2619e9
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 15/24
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: afc5a545023e49209dfc1e68e95493d7 (experiment: pretrained_inception)
2025-12-13 02:07:09 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:09 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: afc5a545023e49209dfc1e68e95493d7
2025-12-13 02:07:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:10 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:10 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f82840910fbb4790ab1d864f112ef989 (experiment: pretrained_inception)
2025-12-13 02:07:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:10 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f82840910fbb4790ab1d864f112ef989
2025-12-13 02:07:11 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:11 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:11 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2d2332e7275d44e9be96b7f6f056cd47 (experiment: pretrained_inception)
2025-12-13 02:07:12 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:12 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2d2332e7275d44e9be96b7f6f056cd47
2025-12-13 02:07:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:12 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:13 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5fc61c7f37a64e8da3cc2e7b17f6a476 (experiment: pretrained_inception)
2025-12-13 02:07:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:14 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5fc61c7f37a64e8da3cc2e7b17f6a476
2025-12-13 02:07:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:14 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:15 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 69f63fd9ad0341249d26cdd757e60cb0 (experiment: pretrained_inception)
2025-12-13 02:07:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:16 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 69f63fd9ad0341249d26cdd757e60cb0
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 16/24
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0001, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c9eabeac5c7f458db440cfd316cc52c5 (experiment: pretrained_inception)
2025-12-13 02:07:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:18 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c9eabeac5c7f458db440cfd316cc52c5
2025-12-13 02:07:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:18 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4853cee53d35449aad904d9679ec67bf (experiment: pretrained_inception)
2025-12-13 02:07:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4853cee53d35449aad904d9679ec67bf
2025-12-13 02:07:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:19 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 812a5bc739344604b6512ead71481414 (experiment: pretrained_inception)
2025-12-13 02:07:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 812a5bc739344604b6512ead71481414
2025-12-13 02:07:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:21 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 66086994e14949db8e7841cfcbfc9582 (experiment: pretrained_inception)
2025-12-13 02:07:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:23 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:23 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:23 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 66086994e14949db8e7841cfcbfc9582
2025-12-13 02:07:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:23 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:24 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3d4c39260b3741a8bd2975dcec309c22 (experiment: pretrained_inception)
2025-12-13 02:07:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3d4c39260b3741a8bd2975dcec309c22
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 17/24
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:26 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 463c69c813d242f8a5dd5c33dda7e701 (experiment: pretrained_inception)
2025-12-13 02:07:26 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 463c69c813d242f8a5dd5c33dda7e701
2025-12-13 02:07:27 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:27 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:27 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 81cf43e02a17453da1fa4a027989cacf (experiment: pretrained_inception)
2025-12-13 02:07:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:27 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 81cf43e02a17453da1fa4a027989cacf
2025-12-13 02:07:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:28 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:29 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ab4a1bb99f2a42428558e73283affca3 (experiment: pretrained_inception)
2025-12-13 02:07:29 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:29 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ab4a1bb99f2a42428558e73283affca3
2025-12-13 02:07:30 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:30 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:30 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f0dee664b1c44bed81887b8efad8f17a (experiment: pretrained_inception)
2025-12-13 02:07:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:31 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f0dee664b1c44bed81887b8efad8f17a
2025-12-13 02:07:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:31 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9d3d86264a0d459299d62a7e5d5dadf6 (experiment: pretrained_inception)
2025-12-13 02:07:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:33 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9d3d86264a0d459299d62a7e5d5dadf6
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 18/24
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 5e-06, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:33 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f0a82f1603b54a8dbe3ad6c8532cd4d4 (experiment: pretrained_inception)
2025-12-13 02:07:34 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:35 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:35 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:35 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f0a82f1603b54a8dbe3ad6c8532cd4d4
2025-12-13 02:07:35 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:35 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:35 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:35 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2ff49e15f98e4c2095895b792b20b3aa (experiment: pretrained_inception)
2025-12-13 02:07:36 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:36 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:36 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:36 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2ff49e15f98e4c2095895b792b20b3aa
2025-12-13 02:07:36 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:36 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:36 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:36 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:37 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 0a38aa3a42f041a6bb690d8a11d32633 (experiment: pretrained_inception)
2025-12-13 02:07:37 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:38 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:38 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:38 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 0a38aa3a42f041a6bb690d8a11d32633
2025-12-13 02:07:38 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:38 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:38 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:38 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:39 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2be60ef380a944b8a40262ebb77ae6a0 (experiment: pretrained_inception)
2025-12-13 02:07:39 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:40 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:40 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:40 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2be60ef380a944b8a40262ebb77ae6a0
2025-12-13 02:07:40 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:40 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:40 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:40 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:41 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2bad330e6b4349b48b6a362702e9a17b (experiment: pretrained_inception)
2025-12-13 02:07:41 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:42 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:42 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:42 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2bad330e6b4349b48b6a362702e9a17b
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 19/24
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:42 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:43 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 322dec10b68c4b5c84c87c47aa567a14 (experiment: pretrained_inception)
2025-12-13 02:07:43 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:43 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:43 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:43 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 322dec10b68c4b5c84c87c47aa567a14
2025-12-13 02:07:44 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:44 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:44 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:44 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ce736c7ad43d4577af252c1622f74bb2 (experiment: pretrained_inception)
2025-12-13 02:07:45 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:45 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:45 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:45 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ce736c7ad43d4577af252c1622f74bb2
2025-12-13 02:07:45 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:45 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:45 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:45 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9f53bc729fa24499b57ca8db65cfac40 (experiment: pretrained_inception)
2025-12-13 02:07:46 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:46 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:46 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:46 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 9f53bc729fa24499b57ca8db65cfac40
2025-12-13 02:07:47 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:47 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:47 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:47 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:47 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 435bed079c7b4d40b0169c31f2d2bd25 (experiment: pretrained_inception)
2025-12-13 02:07:48 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:48 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:48 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:48 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 435bed079c7b4d40b0169c31f2d2bd25
2025-12-13 02:07:49 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:49 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:49 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:49 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:49 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: da24de1f479f48e4b95ce05a74d1f738 (experiment: pretrained_inception)
2025-12-13 02:07:49 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:50 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:50 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:50 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: da24de1f479f48e4b95ce05a74d1f738
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 20/24
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 5e-06, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:50 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:51 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:51 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: ca95ceccc38841cebf732a07f31206c9 (experiment: pretrained_inception)
2025-12-13 02:07:51 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:07:52 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:52 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:52 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: ca95ceccc38841cebf732a07f31206c9
2025-12-13 02:07:52 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:07:52 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:07:52 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:52 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:53 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 690049a31fe549dd9573f07b00084f8a (experiment: pretrained_inception)
2025-12-13 02:07:53 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:07:53 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:53 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:53 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 690049a31fe549dd9573f07b00084f8a
2025-12-13 02:07:53 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:07:53 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:07:53 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:54 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:54 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f3ffa9a37f6d4c20956806d7b05664dc (experiment: pretrained_inception)
2025-12-13 02:07:54 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:07:55 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:55 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:55 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f3ffa9a37f6d4c20956806d7b05664dc
2025-12-13 02:07:55 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:07:55 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:07:55 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:55 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:56 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 724cbeb50c6248f5a64b26995e77a805 (experiment: pretrained_inception)
2025-12-13 02:07:56 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:07:57 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:57 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:57 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 724cbeb50c6248f5a64b26995e77a805
2025-12-13 02:07:57 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:07:57 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:07:57 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:57 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:07:58 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8cac757169844f1c8c374a68ff4b04be (experiment: pretrained_inception)
2025-12-13 02:07:58 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:07:59 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:07:59 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:07:59 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8cac757169844f1c8c374a68ff4b04be
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 21/24
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:07:59 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:00 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5b3af7370393401e9d7396781ed28627 (experiment: pretrained_inception)
2025-12-13 02:08:00 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:08:00 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:00 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:00 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5b3af7370393401e9d7396781ed28627
2025-12-13 02:08:01 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:08:01 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:08:01 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:01 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:02 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 14a74a04e1b34e9d81896e3d6317bed0 (experiment: pretrained_inception)
2025-12-13 02:08:02 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:08:02 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:02 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:02 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 14a74a04e1b34e9d81896e3d6317bed0
2025-12-13 02:08:02 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:08:02 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:08:02 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:02 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:03 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 766b01db2cc94ce692e7c0017a2c5a8f (experiment: pretrained_inception)
2025-12-13 02:08:03 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:08:03 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:03 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:03 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 766b01db2cc94ce692e7c0017a2c5a8f
2025-12-13 02:08:04 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:08:04 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:08:04 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:04 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:05 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5d2d0f5aab144c20b4a140057f77c38f (experiment: pretrained_inception)
2025-12-13 02:08:05 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:08:05 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:05 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:05 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 5d2d0f5aab144c20b4a140057f77c38f
2025-12-13 02:08:06 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:08:06 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:08:06 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:06 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:06 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 17c7467507e947a6adc0e9aefae942f7 (experiment: pretrained_inception)
2025-12-13 02:08:06 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:08:07 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:07 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:07 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 17c7467507e947a6adc0e9aefae942f7
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 22/24
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 1e-05, 'head_lr': 0.0005, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:08:07 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:08 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:08 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 3bab562b972e48c981f6c1758143fffb (experiment: pretrained_inception)
2025-12-13 02:08:08 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:08:09 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:09 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:09 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 3bab562b972e48c981f6c1758143fffb
2025-12-13 02:08:09 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:08:09 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:08:09 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:09 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:10 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 63423a80575542f19ec03d8d5197b5ab (experiment: pretrained_inception)
2025-12-13 02:08:10 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:08:10 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:10 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:10 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 63423a80575542f19ec03d8d5197b5ab
2025-12-13 02:08:10 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:08:10 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:08:10 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:11 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:11 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 225bd48e08374b72b9c5913891adb064 (experiment: pretrained_inception)
2025-12-13 02:08:11 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:08:12 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:12 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:12 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 225bd48e08374b72b9c5913891adb064
2025-12-13 02:08:12 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:08:12 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:08:12 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:12 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:13 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: b4128282ee7e4c6cb38555916fec2411 (experiment: pretrained_inception)
2025-12-13 02:08:13 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:08:14 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:14 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:14 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: b4128282ee7e4c6cb38555916fec2411
2025-12-13 02:08:14 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:08:14 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:08:14 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:14 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:15 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: c17bd23115694377afb7618b484db7ae (experiment: pretrained_inception)
2025-12-13 02:08:15 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:08:16 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:16 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:16 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: c17bd23115694377afb7618b484db7ae
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 23/24
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 1e-05, 'batch_size': 2}
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:16 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:17 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: fcc385b9118e4b16a082f9dc746a5445 (experiment: pretrained_inception)
2025-12-13 02:08:17 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:08:18 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:18 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:18 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: fcc385b9118e4b16a082f9dc746a5445
2025-12-13 02:08:18 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:08:18 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:08:18 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:18 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:19 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 4c044e1b53e54a19b118bdbd7dd6cae2 (experiment: pretrained_inception)
2025-12-13 02:08:19 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:08:19 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:19 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:19 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 4c044e1b53e54a19b118bdbd7dd6cae2
2025-12-13 02:08:19 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:08:19 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:08:19 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:19 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:20 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 79c8d7b6a36a41d6b4e44f7ad11a0332 (experiment: pretrained_inception)
2025-12-13 02:08:20 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:08:21 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:21 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:21 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 79c8d7b6a36a41d6b4e44f7ad11a0332
2025-12-13 02:08:21 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:08:21 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:08:21 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:21 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:22 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 8f76fa0baf3c4b5094afb021aacb1b76 (experiment: pretrained_inception)
2025-12-13 02:08:22 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:08:22 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:22 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:22 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 8f76fa0baf3c4b5094afb021aacb1b76
2025-12-13 02:08:23 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:08:23 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:08:23 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:23 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:23 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 39517a9ac17c4697b9b661bf5d1c4fd2 (experiment: pretrained_inception)
2025-12-13 02:08:24 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:08:24 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:24 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:24 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 39517a9ac17c4697b9b661bf5d1c4fd2
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:868] 
================================================================================
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:869] Grid Search: Hyperparameter combination 24/24
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:870] Parameters: {'learning_rate': 0.0005, 'backbone_lr': 1e-05, 'head_lr': 0.001, 'weight_decay': 0.0001, 'batch_size': 2}
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:871] ================================================================================
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 1/5 (20% sample)
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 1 directory (clean mode)
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:25 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: f378463749c1435496acab5ad5ec0e0a (experiment: pretrained_inception)
2025-12-13 02:08:25 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 1...
2025-12-13 02:08:26 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:26 [ERROR] [lib.training.pipeline:1764] Error training fold 1: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:26 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: f378463749c1435496acab5ad5ec0e0a
2025-12-13 02:08:26 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 2/5 (20% sample)
2025-12-13 02:08:26 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 2 directory (clean mode)
2025-12-13 02:08:26 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:27 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:27 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: a4705d9500d340b7ae9863bbf0724cfe (experiment: pretrained_inception)
2025-12-13 02:08:27 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 2...
2025-12-13 02:08:27 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:27 [ERROR] [lib.training.pipeline:1764] Error training fold 2: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:27 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: a4705d9500d340b7ae9863bbf0724cfe
2025-12-13 02:08:28 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 3/5 (20% sample)
2025-12-13 02:08:28 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 3 directory (clean mode)
2025-12-13 02:08:28 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:28 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:28 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: e7a5d0ca3f1a417a9381fbbaf1ae8022 (experiment: pretrained_inception)
2025-12-13 02:08:28 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 3...
2025-12-13 02:08:29 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:29 [ERROR] [lib.training.pipeline:1764] Error training fold 3: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:29 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: e7a5d0ca3f1a417a9381fbbaf1ae8022
2025-12-13 02:08:29 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 4/5 (20% sample)
2025-12-13 02:08:29 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 4 directory (clean mode)
2025-12-13 02:08:29 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:30 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:30 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 2280547e6b0c4c9489b2bb847a2688a6 (experiment: pretrained_inception)
2025-12-13 02:08:30 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 4...
2025-12-13 02:08:31 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:31 [ERROR] [lib.training.pipeline:1764] Error training fold 4: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:31 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: 2280547e6b0c4c9489b2bb847a2688a6
2025-12-13 02:08:31 [INFO] [lib.training.pipeline:900] 
Hyperparameter Search - pretrained_inception - Fold 5/5 (20% sample)
2025-12-13 02:08:31 [INFO] [lib.training.pipeline:909] Deleted existing hyperparameter search fold 5 directory (clean mode)
2025-12-13 02:08:31 [INFO] [lib.training.pipeline:1004] Training configuration - Batch size: 2, Gradient accumulation steps: 16, Effective batch size: 32
2025-12-13 02:08:32 [INFO] [lib.training.pipeline:1050] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:32 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: aaf3d534f53d4768b3c7429eb924dcbc (experiment: pretrained_inception)
2025-12-13 02:08:32 [INFO] [lib.training.pipeline:1143] Training PyTorch model pretrained_inception on fold 5...
2025-12-13 02:08:33 [ERROR] [lib.training.pipeline:1271] Model forward pass test failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:33 [ERROR] [lib.training.pipeline:1764] Error training fold 5: Model initialization failed: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1176, in stage5_train_models
    sample_batch = next(iter(test_loader))
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 1272, in stage5_train_models
    raise ValueError(f"Model initialization failed: {e}") from e
ValueError: Model initialization failed: name 'use_scaled_videos' is not defined
2025-12-13 02:08:33 [INFO] [lib.mlops.mlflow_tracker:142] MLflow run ended: aaf3d534f53d4768b3c7429eb924dcbc
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1823] ================================================================================
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1824] FINAL TRAINING: Using full dataset with best hyperparameters
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1825] ================================================================================
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1838] Final training: Using 5-fold stratified cross-validation on full dataset (3278 rows)
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1848] Final training using default hyperparameters (no grid search)
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1852] 
Final Training - pretrained_inception - Fold 1/5 (full dataset)
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1861] Deleted existing final training fold 1 directory (clean mode)
2025-12-13 02:08:33 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:34 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 5c20d068713643b3baddf70c37df8e0c (experiment: pretrained_inception)
2025-12-13 02:08:34 [INFO] [lib.training.pipeline:2026] Training PyTorch model pretrained_inception on fold 1 (full dataset)...
2025-12-13 02:08:34 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 02:08:35 [ERROR] [lib.training.pipeline:2226] Error training final fold 1: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:35 [INFO] [lib.training.pipeline:1852] 
Final Training - pretrained_inception - Fold 2/5 (full dataset)
2025-12-13 02:08:35 [INFO] [lib.training.pipeline:1861] Deleted existing final training fold 2 directory (clean mode)
2025-12-13 02:08:36 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:36 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 9dc5f77bece146a5a043792e5ae77702 (experiment: pretrained_inception)
2025-12-13 02:08:36 [INFO] [lib.training.pipeline:2026] Training PyTorch model pretrained_inception on fold 2 (full dataset)...
2025-12-13 02:08:36 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 02:08:43 [ERROR] [lib.training.pipeline:2226] Error training final fold 2: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:43 [INFO] [lib.training.pipeline:1852] 
Final Training - pretrained_inception - Fold 3/5 (full dataset)
2025-12-13 02:08:43 [INFO] [lib.training.pipeline:1861] Deleted existing final training fold 3 directory (clean mode)
2025-12-13 02:08:44 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:44 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 62421df38375495cbc2d72ed48bf7450 (experiment: pretrained_inception)
2025-12-13 02:08:44 [INFO] [lib.training.pipeline:2026] Training PyTorch model pretrained_inception on fold 3 (full dataset)...
2025-12-13 02:08:44 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 02:08:45 [ERROR] [lib.training.pipeline:2226] Error training final fold 3: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:45 [INFO] [lib.training.pipeline:1852] 
Final Training - pretrained_inception - Fold 4/5 (full dataset)
2025-12-13 02:08:45 [INFO] [lib.training.pipeline:1861] Deleted existing final training fold 4 directory (clean mode)
2025-12-13 02:08:45 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:46 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: eab017cce62444458b70bb08d43c1c3f (experiment: pretrained_inception)
2025-12-13 02:08:46 [INFO] [lib.training.pipeline:2026] Training PyTorch model pretrained_inception on fold 4 (full dataset)...
2025-12-13 02:08:46 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 02:08:47 [ERROR] [lib.training.pipeline:2226] Error training final fold 4: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:47 [INFO] [lib.training.pipeline:1852] 
Final Training - pretrained_inception - Fold 5/5 (full dataset)
2025-12-13 02:08:47 [INFO] [lib.training.pipeline:1861] Deleted existing final training fold 5 directory (clean mode)
2025-12-13 02:08:47 [INFO] [lib.training.pipeline:1961] Applied PyTorch memory optimizations: expandable_segments, cudnn.benchmark=False
2025-12-13 02:08:48 [INFO] [lib.mlops.mlflow_tracker:89] MLflow run started: 6cff22235748412fbb4f708e3b94fbca (experiment: pretrained_inception)
2025-12-13 02:08:48 [INFO] [lib.training.pipeline:2026] Training PyTorch model pretrained_inception on fold 5 (full dataset)...
2025-12-13 02:08:48 [INFO] [lib.training.trainer:260] Warmup will be handled in training loop (2 epochs)
2025-12-13 02:08:48 [ERROR] [lib.training.pipeline:2226] Error training final fold 5: name 'use_scaled_videos' is not defined
Traceback (most recent call last):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/pipeline.py", line 2032, in stage5_train_models
    model = fit(model, train_loader, val_loader, optim_cfg, train_cfg, use_differential_lr=use_differential_lr)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 684, in fit
    train_loss = train_one_epoch(
                 ^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/training/trainer.py", line 308, in train_one_epoch
    for batch_idx, (clips, labels) in enumerate(loader):
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 732, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 788, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/venv/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 848, in __getitem__
    frames = self._load_frames_chunked(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/lib/models/video.py", line 637, in _load_frames_chunked
    if use_scaled_videos and (H_frame < 32 or W_frame < 32):
       ^^^^^^^^^^^^^^^^^
NameError: name 'use_scaled_videos' is not defined
2025-12-13 02:08:48 [WARNING] [lib.training.pipeline:118] No model files found in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/pretrained_inception/fold_1 to copy
2025-12-13 02:08:48 [INFO] [lib.training.pipeline:2299] 
pretrained_inception - Avg Val Loss: nan, Avg Val Acc: nan, Avg Val F1: nan
2025-12-13 02:08:50 [INFO] [lib.training.visualization:256] Saved CV fold comparison to /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/pretrained_inception/plots/cv_fold_comparison.png
2025-12-13 02:08:50 [INFO] [lib.training.pipeline:2327] Generated plots for pretrained_inception in /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5/pretrained_inception/plots
2025-12-13 02:08:50 [INFO] [lib.training.pipeline:2364] ================================================================================
2025-12-13 02:08:50 [INFO] [lib.training.pipeline:2365] Stage 5: Model Training Pipeline Completed
2025-12-13 02:08:50 [INFO] [lib.training.pipeline:2366] ================================================================================
2025-12-13 02:08:50 [INFO] [__main__:401] ================================================================================
2025-12-13 02:08:50 [INFO] [__main__:402] STAGE 5 COMPLETED SUCCESSFULLY
2025-12-13 02:08:50 [INFO] [__main__:403] ================================================================================
2025-12-13 02:08:50 [INFO] [__main__:404] Execution time: 235.16 seconds (3.92 minutes)
2025-12-13 02:08:50 [INFO] [__main__:406] Output directory: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:08:50 [INFO] [__main__:407] Models trained: ['pretrained_inception']
2025-12-13 02:08:50 [INFO] [__main__:408] K-fold splits: 5
2025-12-13 02:08:50 [INFO] [__main__:414] ================================================================================
2025-12-13 02:08:50 [INFO] [__main__:415] Final memory statistics:
2025-12-13 02:08:50 [INFO] [__main__:416] ================================================================================
2025-12-13 02:08:50 [INFO] [lib.utils.memory:91] Memory stats (Stage 5: after training): {'cpu_memory_mb': 1608.2890625, 'cpu_memory_gb': 1.5705947875976562, 'cpu_vms_mb': 47930.33984375, 'gpu_allocated_gb': 0.0, 'gpu_reserved_gb': 0.385875968, 'gpu_total_gb': 16.928342016, 'gpu_free_gb': 16.542466048}
2025-12-13 02:08:50 [INFO] [__main__:419] ================================================================================
2025-12-13 02:08:50 [INFO] [__main__:420] Training complete!
2025-12-13 02:08:50 [INFO] [__main__:421] Results saved to: /gpfs/accounts/si670f25_class_root/si670f25_class/santoshd/fvc/data/stage5
2025-12-13 02:08:50 [INFO] [__main__:422] ================================================================================
